/* FontAwesome Pro - Complete Setup */
@font-face {
  font-family: "Font Awesome 6 Pro";
  font-style: normal;
  font-weight: 900;
  font-display: swap;
  src: url("./fonts/fontawesome-pro/fa-solid-900.ttf") format("truetype");
}

@font-face {
  font-family: "Font Awesome 6 Brands";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("./fonts/fontawesome-pro/fa-brands-400.woff2") format("woff2"),
       url("./fonts/fontawesome-pro/fa-brands-400.ttf") format("truetype");
}

/* Fallback for FontAwesome 5 compatibility */
@font-face {
  font-family: "Font Awesome 5 Pro";
  font-style: normal;
  font-weight: 900;
  font-display: swap;
  src: url("./fonts/fontawesome-pro/fa-solid-900.ttf") format("truetype");
}

@font-face {
  font-family: "Font Awesome 5 Brands";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("./fonts/fontawesome-pro/fa-brands-400.woff2") format("woff2"),
       url("./fonts/fontawesome-pro/fa-brands-400.ttf") format("truetype");
}

/* FontAwesome Pro CSS Classes - Enhanced Unicode Support */
.fa-solid, .fas, .fa-regular, .far, .fa-light, .fal, .fa-thin, .fat {
  font-family: "Font Awesome 6 Pro", "Font Awesome 5 Pro", "FontAwesome" !important;
  font-weight: 900 !important;
  font-style: normal !important;
  font-variant: normal !important;
  text-rendering: auto !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
}

.fa-brands, .fab {
  font-family: "Font Awesome 6 Brands", "Font Awesome 5 Brands", "FontAwesome" !important;
  font-weight: 400 !important;
  font-style: normal !important;
  font-variant: normal !important;
  text-rendering: auto !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
}

/* Brand Icons CSS Classes - Full Unicode Glyphs with Content */
/* Social Media */
.fa-brands.fa-github::before { content: "\f09b"; }
.fa-brands.fa-twitter::before { content: "\f099"; }
.fa-brands.fa-facebook::before { content: "\f09a"; }
.fa-brands.fa-instagram::before { content: "\f16d"; }
.fa-brands.fa-linkedin::before { content: "\f08c"; }
.fa-brands.fa-youtube::before { content: "\f167"; }
.fa-brands.fa-reddit::before { content: "\f1a1"; }
.fa-brands.fa-discord::before { content: "\f392"; }
.fa-brands.fa-slack::before { content: "\f198"; }
.fa-brands.fa-telegram::before { content: "\f2c6"; }
.fa-brands.fa-whatsapp::before { content: "\f232"; }
.fa-brands.fa-tiktok::before { content: "\e07b"; }
.fa-brands.fa-snapchat::before { content: "\f2ab"; }
.fa-brands.fa-pinterest::before { content: "\f0d2"; }

/* Technology */
.fa-brands.fa-chrome::before { content: "\f268"; }
.fa-brands.fa-firefox::before { content: "\f269"; }
.fa-brands.fa-safari::before { content: "\f267"; }
.fa-brands.fa-edge::before { content: "\f282"; }
.fa-brands.fa-opera::before { content: "\f26a"; }

/* Cloud & Services */
.fa-brands.fa-amazon::before { content: "\f270"; }
.fa-brands.fa-aws::before { content: "\f375"; }
.fa-brands.fa-google::before { content: "\f1a0"; }
.fa-brands.fa-microsoft::before { content: "\f3ca"; }
.fa-brands.fa-apple::before { content: "\f179"; }
.fa-brands.fa-dropbox::before { content: "\f16b"; }
.fa-brands.fa-google-drive::before { content: "\f3aa"; }

/* Payment */
.fa-brands.fa-stripe::before { content: "\f1f5"; }
.fa-brands.fa-paypal::before { content: "\f1ed"; }
.fa-brands.fa-bitcoin::before { content: "\f379"; }
.fa-brands.fa-cc-visa::before { content: "\f1f0"; }
.fa-brands.fa-cc-mastercard::before { content: "\f1f1"; }
.fa-brands.fa-cc-amex::before { content: "\f1f3"; }

/* Design */
.fa-brands.fa-dribbble::before { content: "\f17d"; }
.fa-brands.fa-behance::before { content: "\f1b4"; }
.fa-brands.fa-figma::before { content: "\f799"; }
.fa-brands.fa-adobe::before { content: "\f778"; }
.fa-brands.fa-sketch::before { content: "\f6c7"; }
.fa-brands.fa-webflow::before { content: "\e65c"; }

/* CMS & Platforms */
.fa-brands.fa-wordpress::before { content: "\f19a"; }
.fa-brands.fa-medium::before { content: "\f23a"; }
.fa-brands.fa-blogger::before { content: "\f37c"; }
.fa-brands.fa-wordpress-simple::before { content: "\f411"; }
.fa-brands.fa-shopify::before { content: "\f957"; }
.fa-brands.fa-magento::before { content: "\f3c4"; }
.fa-brands.fa-wix::before { content: "\f5cf"; }
.fa-brands.fa-squarespace::before { content: "\f5be"; }

/* Productivity */
.fa-brands.fa-trello::before { content: "\f181"; }
.fa-brands.fa-asana::before { content: "\f41e"; }
.fa-brands.fa-notion::before { content: "\e8c3"; }
.fa-brands.fa-jira::before { content: "\f7b1"; }
.fa-brands.fa-confluence::before { content: "\e83d"; }
.fa-brands.fa-zoom::before { content: "\f587"; }
.fa-brands.fa-skype::before { content: "\f17e"; }

/* Video & Streaming */
.fa-brands.fa-vimeo::before { content: "\f40a"; }
.fa-brands.fa-twitch::before { content: "\f1e8"; }
.fa-brands.fa-netflix::before { content: "\f3fb"; }
.fa-brands.fa-spotify::before { content: "\f1bc"; }
.fa-brands.fa-soundcloud::before { content: "\f1be"; }

/* Development */
.fa-brands.fa-npm::before { content: "\f3d4"; }
.fa-brands.fa-node-js::before { content: "\f3d3"; }
.fa-brands.fa-react::before { content: "\f41b"; }
.fa-brands.fa-vue::before { content: "\f41f"; }
.fa-brands.fa-angular::before { content: "\f420"; }
.fa-brands.fa-html5::before { content: "\f13b"; }
.fa-brands.fa-css3::before { content: "\f13c"; }
.fa-brands.fa-js::before { content: "\f3b8"; }
.fa-brands.fa-python::before { content: "\f3e2"; }
.fa-brands.fa-java::before { content: "\f4e7"; }
.fa-brands.fa-git::before { content: "\f1d3"; }
.fa-brands.fa-git-alt::before { content: "\f841"; }
.fa-brands.fa-gitlab::before { content: "\f296"; }
.fa-brands.fa-bitbucket::before { content: "\f171"; }
.fa-brands.fa-stack-overflow::before { content: "\f16c"; }
.fa-brands.fa-codepen::before { content: "\f1cb"; }
.fa-brands.fa-docker::before { content: "\f395"; }

/* Mobile & OS */
.fa-brands.fa-android::before { content: "\f17b"; }
.fa-brands.fa-windows::before { content: "\f17a"; }
.fa-brands.fa-linux::before { content: "\f17c"; }

/* Additional Brands */
.fa-brands.fa-airbnb::before { content: "\f834"; }
.fa-brands.fa-uber::before { content: "\f402"; }
.fa-brands.fa-salesforce::before { content: "\f83b"; }
.fa-brands.fa-oracle::before { content: "\f797"; }


/* Common Financial Icons CSS Classes */
.fa-dollar-sign::before { content: "\f155"; }
.fa-credit-card::before { content: "\f283"; }
.fa-coins::before { content: "\f51e"; }
.fa-piggy-bank::before { content: "\f4d3"; }
.fa-wallet::before { content: "\f555"; }
.fa-chart-pie::before { content: "\f200"; }
.fa-chart-bar::before { content: "\f080"; }
.fa-chart-line::before { content: "\f201"; }
.fa-chart-area::before { content: "\f1fe"; }
.fa-calculator::before { content: "\f1ec"; }
.fa-receipt::before { content: "\f543"; }
.fa-file-invoice-dollar::before { content: "\f571"; }
.fa-file-invoice::before { content: "\f570"; }
.fa-file-invoice-usd::before { content: "\f572"; }
.fa-hand-holding-usd::before { content: "\f4c0"; }
.fa-money-bill::before { content: "\f0d6"; }
.fa-money-bill-wave::before { content: "\f53a"; }
.fa-money-check::before { content: "\f53c"; }
.fa-percent::before { content: "\f295"; }
.fa-trending-up::before { content: "\f526"; }
.fa-trending-down::before { content: "\f525"; }
.fa-building::before { content: "\f1ad"; }
.fa-briefcase::before { content: "\f0b1"; }
.fa-shopping-cart::before { content: "\f07a"; }
.fa-home::before { content: "\f015"; }
.fa-car::before { content: "\f1b9"; }
.fa-plane::before { content: "\f072"; }
.fa-train::before { content: "\f238"; }
.fa-bus::before { content: "\f207"; }
.fa-laptop::before { content: "\f109"; }
.fa-mobile::before { content: "\f10b"; }
.fa-phone::before { content: "\f095"; }
.fa-envelope::before { content: "\f0e0"; }
.fa-calendar::before { content: "\f073"; }
.fa-clock::before { content: "\f017"; }
.fa-user::before { content: "\f007"; }
.fa-users::before { content: "\f0c0"; }
.fa-heart::before { content: "\f004"; }
.fa-star::before { content: "\f005"; }
.fa-gift::before { content: "\f06b"; }
.fa-coffee::before { content: "\f0f4"; }
.fa-utensils::before { content: "\f2e7"; }
.fa-bed::before { content: "\f236"; }
.fa-gamepad::before { content: "\f11b"; }
.fa-trophy::before { content: "\f091"; }
.fa-award::before { content: "\f559"; }
.fa-medal::before { content: "\f5a2"; }
.fa-certificate::before { content: "\f0a3"; }
.fa-graduation-cap::before { content: "\f19d"; }
.fa-file::before { content: "\f15b"; }
.fa-folder::before { content: "\f07b"; }
.fa-archive::before { content: "\f187"; }
.fa-inbox::before { content: "\f01c"; }
.fa-search::before { content: "\f002"; }
.fa-filter::before { content: "\f0b0"; }
.fa-download::before { content: "\f019"; }
.fa-upload::before { content: "\f093"; }
.fa-share::before { content: "\f064"; }
.fa-copy::before { content: "\f0c5"; }
.fa-edit::before { content: "\f044"; }
.fa-trash::before { content: "\f1f8"; }
.fa-plus::before { content: "\f067"; }
.fa-minus::before { content: "\f068"; }
.fa-check::before { content: "\f00c"; }
.fa-times::before { content: "\f00d"; }
.fa-arrow-up::before { content: "\f062"; }
.fa-arrow-down::before { content: "\f063"; }
.fa-arrow-left::before { content: "\f060"; }
.fa-arrow-right::before { content: "\f061"; }
.fa-eye::before { content: "\f06e"; }
.fa-eye-slash::before { content: "\f070"; }
.fa-lock::before { content: "\f023"; }
.fa-unlock::before { content: "\f09c"; }
.fa-key::before { content: "\f084"; }
.fa-cog::before { content: "\f013"; }
.fa-tools::before { content: "\f7d9"; }
.fa-settings::before { content: "\f013"; }
.fa-bell::before { content: "\f0f3"; }
.fa-comment::before { content: "\f075"; }
.fa-bookmark::before { content: "\f02e"; }
.fa-flag::before { content: "\f024"; }
.fa-shield::before { content: "\f3ed"; }
.fa-exclamation-circle::before { content: "\f06a"; }
.fa-question-circle::before { content: "\f059"; }
.fa-info-circle::before { content: "\f05a"; }
.fa-check-circle::before { content: "\f058"; }

/* Enhanced Unicode character support */
.fa-solid::before,
.fas::before,
.fa-brands::before,
.fab::before {
  font-family: inherit !important;
  font-weight: inherit !important;
  font-style: inherit !important;
}

/* Generic brand icon content - For any brand icon that doesn't have a specific ::before rule */
.fa-brands[class^="fa-"]::before {
  font-family: "Font Awesome 6 Brands" !important;
}

/* Ensure proper Unicode rendering */
[class*="fa-"] {
  display: inline-block !important;
  line-height: 1 !important;
  text-align: center !important;
}

/* Font loading optimization */

:root{ --bg:#0a0a0b; --fg:#e4e4e7; --muted:#a1a1aa; --card:rgba(24,24,27,.75); --stroke:#27272a; --glass:#1f1f23; --accent:#6366f1; --accent-hover:#4f46e5; --accent-bg:rgba(99,102,241,0.1); }
[data-theme="light"]{ --bg:#f8fafc; --fg:#0f172a; --muted:#475569; --card:#ffffff; --stroke:#e2e8f0; --glass:#f8fafc; --accent:#6366f1; --accent-hover:#4f46e5; --accent-bg:rgba(99,102,241,0.1); }

body {
  position: relative;
  /* Allow horizontal scrolling for tables */
}

/* Hide main content during onboarding */
body.onboarding-active #mainContent {
  display: none;
}

body.onboarding-active .mobile-bottom-nav {
  display: none;
}

/* Light mode shadow overrides - much lighter and more subtle */
[data-theme="light"] .card {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .kpi {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03) !important;
}

[data-theme="light"] .kpi:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .row:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .nav-btn:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .icon-btn:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .btn:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
  background: rgba(0, 0, 0, 0.02) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
}

/* Light mode dropdown and modal shadows */
[data-theme="light"] .custom-dropdown,
[data-theme="light"] .dropdown-content,
[data-theme="light"] .select-dropdown,
[data-theme="light"] .method-dropdown,
[data-theme="light"] .status-dropdown,
[data-theme="light"] .billing-dropdown {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .modal,
[data-theme="light"] .settings-modal,
[data-theme="light"] .auth-modal {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08) !important;
}

[data-theme="light"] .custom-date-picker {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(0, 0, 0, 0.02) !important;
}

/* Light mode input and form element shadows */
[data-theme="light"] .input,
[data-theme="light"] .select,
[data-theme="light"] .input-enhanced {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .input:focus,
[data-theme="light"] .select:focus,
[data-theme="light"] .input-enhanced:focus {
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.08) !important;
}

/* Light mode icon tile shadows */
[data-theme="light"] .icon-tile:hover {
  box-shadow: 0 4px 16px rgba(99, 102, 241, 0.08) !important;
}

[data-theme="light"] .icon-tile.selected {
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.12) !important;
}

/* Light mode range slider shadows */
[data-theme="light"] input[type="range"]::-webkit-slider-thumb,
[data-theme="light"] input[type="range"]::-moz-range-thumb {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
}

/* Light mode toggle switch shadows */
[data-theme="light"] .toggle-switch {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
}

/* Light mode header styling */
[data-theme="light"] header {
  background: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Light mode header shadows */
[data-theme="light"] header.scrolled {
  background: var(--bg) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

/* Light mode mobile bottom bar shadow */
[data-theme="light"] .mobile-bottom-bar {
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.04) !important;
}

/* Enhanced light mode button hover effects */
[data-theme="light"] .btn-primary:hover {
  background: rgba(0, 0, 0, 0.05) !important;
  border-color: rgba(0, 0, 0, 0.15) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08) !important;
}

[data-theme="light"] .btn-ghost:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .nav-btn:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

[data-theme="light"] .icon-btn:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-1px) scale(1.02) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
}

/* Light mode specific button variants */
[data-theme="light"] .year-tab:hover {
  background: rgba(99, 102, 241, 0.05) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

[data-theme="light"] .year-tab-manage:hover {
  background: rgba(99, 102, 241, 0.05) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

/* Income View Toggle Button */
.view-toggle-btn {
  padding: 0.35rem 0.75rem;
  font-size: 0.65rem;
  font-weight: 500;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  background: var(--card);
  color: var(--fg);
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

/* Mobile: Stack title/toggle and year controls */
@media (max-width: 768px) {
  .income-header-container {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  .income-header-controls {
    width: 100%;
    align-items: flex-end;
    justify-content: flex-end;
  }
  
  #yearTabsContainer {
    align-self: flex-end; /* Align to right */
  }
}

.view-toggle-btn:hover {
  background: var(--hover);
  border-color: var(--muted);
}

[data-theme="light"] .view-toggle-btn {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .view-toggle-btn:hover {
  background: rgba(241, 245, 249, 0.9);
}

/* Grouped Income View Styles */
.row-project-group {
  font-weight: 600;
  background: var(--glass) !important;
  border-bottom: 3px solid var(--stroke);
}

/* Add bold top border to project groups that follow another project group or sub-row */
.row-project-group:not(:first-child),
.row-sub-date + .row-project-group {
  border-top: 3px solid var(--stroke);
  margin-top: 2px;
}

/* Sub-rows must have exact same grid structure and alignment as main rows */
.row-sub-date {
  display: grid;
  grid-template-columns: 24px 32px 1.5fr .8fr .8fr .8fr 1fr 1fr 1fr 1fr 32px;
  gap: 0.7rem;
  align-items: center;
  padding: 0.5rem 0.4rem;
  border-bottom: 1px solid var(--stroke);
  transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), background-color 0.2s ease;
  background: var(--card);
  transform: translate3d(0, 0, 0);
  opacity: 1;
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  position: relative;
  min-height: auto;
}

.row-sub-date:hover {
  transform: translate3d(0, -1px, 0);
  background: var(--glass);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  opacity: 1;
}

/* Ensure all inputs in sub-rows align perfectly with main table columns */
.row-sub-date > div {
  /* Inherit all styles from main row */
}

/* Add-date button in date column */
.add-date-btn {
  min-width: 80px;
  height: 28px;
  padding: 0.25rem 0.5rem;
  font-size: 0.65rem;
  font-weight: 500;
  border: 1.5px dashed var(--stroke);
  background: var(--glass);
  color: var(--muted);
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.add-date-btn:hover {
  background: var(--hover);
  border-color: var(--accent);
  color: var(--fg);
}

[data-theme="light"] .add-date-btn {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .add-date-btn:hover {
  background: rgba(241, 245, 249, 0.9);
  border-color: var(--accent);
}

/* Add-row button styling - same for both standard and grouped view */

/* Ensure sub-rows maintain spacing */
.row-sub-date + .row-project-group {
  margin-top: 0;
}

/* Light mode sub-row backgrounds */
[data-theme="light"] .row-sub-date {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .row-sub-date:hover {
  background: rgba(241, 245, 249, 0.9);
}

[data-theme="light"] .year-add-btn:hover {
  background: rgba(99, 102, 241, 0.05) !important;
  border-color: rgba(99, 102, 241, 0.3) !important;
  color: var(--accent) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

[data-theme="light"] .year-add-between:hover {
  background: rgba(99, 102, 241, 0.05) !important;
  border-color: rgba(99, 102, 241, 0.3) !important;
  color: var(--accent) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

/* Light mode confirmation buttons */
[data-theme="light"] .year-confirm-yes:hover {
  background: rgba(220, 38, 38, 0.9) !important;
  transform: translateY(-1px) scale(1.02) !important;
  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2) !important;
}

[data-theme="light"] .year-confirm-no:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode sync button */
[data-theme="light"] .sync-button:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode icon cell buttons */
[data-theme="light"] .icon-cell button:hover {
  background: rgba(0, 0, 0, 0.05) !important;
  transform: scale(1.05) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
}

/* Light mode date picker buttons */
[data-theme="light"] .date-picker-nav:hover,
[data-theme="light"] .date-picker-btn:hover {
  background: var(--accent) !important;
  color: white !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2) !important;
}

[data-theme="light"] .date-picker-btn.primary:hover {
  background: var(--accent-hover) !important;
  border-color: var(--accent-hover) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25) !important;
}

/* Light mode dropdown triggers */
[data-theme="light"] .custom-dropdown-trigger:hover,
[data-theme="light"] .method-trigger-minimal:hover,
[data-theme="light"] .status-trigger-minimal:hover,
[data-theme="light"] .billing-trigger-minimal:hover {
  background: rgba(0, 0, 0, 0.03) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode toggle switch */
[data-theme="light"] .toggle-switch:hover {
  background: rgba(0, 0, 0, 0.05) !important;
  transform: scale(1.02) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
}

/* Light mode form elements and inputs */
[data-theme="light"] .input:hover,
[data-theme="light"] .select:hover,
[data-theme="light"] .input-enhanced:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .input:focus,
[data-theme="light"] .select:focus,
[data-theme="light"] .input-enhanced:focus {
  background: rgba(0, 0, 0, 0.02) !important;
  border-color: var(--accent) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.08) !important;
}

/* Light mode select wrappers */
[data-theme="light"] .select-wrap:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode settings inputs */
[data-theme="light"] .settings-input-wrapper:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .settings-currency-select:hover {
  border-color: rgba(0, 0, 0, 0.1) !important;
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode cost input wrappers */
[data-theme="light"] .cost-input-wrapper:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode tag elements */
[data-theme="light"] .tag:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(56, 189, 248, 0.08)) !important;
  border-color: rgba(99, 102, 241, 0.2) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

[data-theme="light"] .tag-input-wrapper:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .tag-suggestion:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

[data-theme="light"] .tag-chip:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(56, 189, 248, 0.08)) !important;
  border-color: rgba(99, 102, 241, 0.2) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

[data-theme="light"] .tag-chip-remove:hover {
  color: var(--fg) !important;
  background: rgba(0, 0, 0, 0.05) !important;
  transform: scale(1.1) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
}

/* Light mode dropdown items */
[data-theme="light"] .custom-dropdown-item:hover,
[data-theme="light"] .method-item-minimal:hover,
[data-theme="light"] .status-item-minimal:hover,
[data-theme="light"] .billing-item-minimal:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  color: var(--fg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode date picker elements */
[data-theme="light"] .date-day:hover {
  background: rgba(99, 102, 241, 0.08) !important;
  border-color: rgba(99, 102, 241, 0.2) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1) !important;
}

/* Light mode range sliders */
[data-theme="light"] input[type="range"]::-webkit-slider-thumb:hover,
[data-theme="light"] input[type="range"]::-moz-range-thumb:hover {
  background: var(--muted) !important;
  transform: scale(1.1) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
}

/* Light mode year items */
[data-theme="light"] .year-item:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}

/* Light mode year remove buttons */
[data-theme="light"] .year-btn-remove:hover {
  background: rgba(220, 38, 38, 0.9) !important;
  transform: scale(1.1) !important;
  box-shadow: 0 2px 8px rgba(220, 38, 38, 0.2) !important;
}

/* Light mode table header - much lighter shadow */
[data-theme="light"] .row-head {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02) !important;
}

/* Light mode row head hover */
[data-theme="light"] .row-head:hover {
  background: rgba(0, 0, 0, 0.02) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
}
html,body{ font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg); color:var(--fg); }
*{ scrollbar-width:thin; scrollbar-color:#52525b transparent; }
::-webkit-scrollbar{ height:8px; width:8px; }
::-webkit-scrollbar-thumb{ background:#52525b; border-radius:999px; }

.card{ border-radius:1rem; background:var(--card); border:none; box-shadow:0 10px 30px rgba(0,0,0,.20); backdrop-filter:blur(6px); }

.btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; border-radius:.75rem; padding:.5rem .75rem; font-size:.875rem; font-weight:500; border:1px solid var(--stroke); cursor:pointer; }

/* ADD ROW buttons - force left alignment */
.btn[data-add-row] {
  justify-content: flex-start !important;
  text-align: left !important;
}
.btn-primary{ background:#e4e4e7; color:#09090b; }
.btn-ghost{ background:transparent; color:var(--fg); }
.btn:hover{ 
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(255, 255, 255, 0.03);
  transform: none;
  transition: all 0.15s ease;
}
.icon-btn{ display:inline-grid; place-items:center; }

/* Ultra Modern Minimal Buttons */
.nav-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  border: 1px solid var(--stroke);
  background: transparent;
  color: var(--muted);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 40px;
  position: relative;
}

.nav-btn:hover {
  background: rgba(255, 255, 255, 0.03);
  color: var(--fg);
  border-color: rgba(255, 255, 255, 0.3);
  transform: none;
  transition: all 0.15s ease;
}

.nav-btn.active {
  background: var(--fg);
  color: var(--bg);
  border-color: var(--fg);
  font-weight: 600;
}

.nav-btn svg {
  width: 1rem;
  height: 1rem;
}

/* Smooth scrolling for the entire page */
html {
  scroll-behavior: smooth;
}

/* Prevent image inversion in light/dark mode */
img, svg, .icon, .avatar, .profile-pic {
  filter: none !important;
  -webkit-filter: none !important;
}

/* Ensure profile picture in dropdown doesn't get inverted in light mode */
#userPhoto {
  filter: none !important;
  -webkit-filter: none !important;
}

[data-theme="light"] #userPhoto {
  filter: none !important;
  -webkit-filter: none !important;
}

[data-theme="dark"] #userPhoto {
  filter: none !important;
  -webkit-filter: none !important;
}

/* Ensure images maintain original colors */
[data-theme="light"] img,
[data-theme="light"] svg,
[data-theme="dark"] img,
[data-theme="dark"] svg {
  filter: none !important;
  -webkit-filter: none !important;
}

/* SUPER-PERFECT Sticky Header Styles */
header {
  position: sticky !important;
  top: 0 !important;
  z-index: 1000;
  background: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  border-bottom: 1px solid transparent;
  transition: padding 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), margin 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  padding: 1rem 0;
  margin: -1rem 0 1rem 0;
  width: 100%;
  /* Enhanced mobile performance */
  will-change: transform, background-color;
  transform: translateZ(0);
  /* Smooth shadow transitions */
  box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}

/* Ensure proper scrolling context */
html, body {
  height: 100%;
  /* Allow horizontal scrolling for tables */
}

/* SUPER-PERFECT Header scroll state - compact and with border */
header.scrolled {
  padding: 0.75rem 0;
  margin: -0.75rem 0 0.75rem 0;
  border-bottom-color: var(--stroke);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
  /* Instant background appearance */
  background: var(--bg) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  /* Smooth transform for mobile */
  transform: translateZ(0) scale(1);
}

/* Smooth transitions for header elements */
header .flex {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Logo positioning and scaling on scroll */
header img {
  transform: translateY(15%);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

header.scrolled img {
  transform: scale(0.9) translateY(10%);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Navigation buttons scaling on scroll */
header.scrolled .nav-btn {
  padding: 0.375rem 0.75rem;
  font-size: 0.8rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Icon buttons scaling on scroll */
header.scrolled .icon-btn {
  width: 2rem;
  height: 2rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}


/* Mobile responsiveness for sticky header */
@media (max-width: 768px) {
  header {
    padding: 0.75rem 0;
    margin: -0.75rem 0 0.75rem 0;
  }
  
  header.scrolled {
    padding: 0;
    margin: 0;
    background: var(--bg) !important;
    border-bottom: 1px solid var(--stroke);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateZ(0);
  }
  
  /* Hide logo with dynamic motion when sticky on mobile - remove from flow */
  header.scrolled .logo-container {
    position: absolute;
    top: -9999px;
    left: -9999px;
    opacity: 0;
    transform: scale(0.8) translateY(-10px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events: none;
    visibility: hidden;
    width: 0;
    height: 0;
    overflow: hidden;
  }
  
  /* Super compact navigation buttons - icons only */
  header.scrolled .nav-btn {
    padding: 0.125rem 0.25rem;
    font-size: 0;
    min-width: 2rem;
    height: 2rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Super compact icon buttons */
  header.scrolled .icon-btn {
    width: 2rem;
    height: 2rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  header.scrolled .icon-btn svg {
    color: var(--fg);
  }
  
  /* Navigation button icons */
  header.scrolled .nav-btn svg {
    width: 0.875rem;
    height: 0.875rem;
    color: var(--fg);
  }
  
  /* Minimal gap between elements */
  header.scrolled .flex {
    gap: 0.25rem;
    justify-content: center;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Compact currency selector */
  header.scrolled #btnCurrency {
    min-width: 2rem;
    height: 2rem;
    padding: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  header.scrolled #currencySymbol {
    font-size: 0.6rem;
    color: var(--fg);
  }
  
  /* Ensure smooth transition for logo container */
  header .logo-container {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  
  /* Ultra-compact for very small screens */
  @media (max-width: 480px) {
    header.scrolled {
      padding: 0;
      margin: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    header.scrolled .nav-btn {
      padding: 0.1rem 0.2rem;
      min-width: 1.75rem;
      height: 1.75rem;
    }
    
    header.scrolled .nav-btn svg {
      width: 0.75rem;
      height: 0.75rem;
    }
    
    header.scrolled .icon-btn {
      width: 1.75rem;
      height: 1.75rem;
    }
    
    header.scrolled #btnCurrency {
      min-width: 1.75rem;
      height: 1.75rem;
    }
    
    header.scrolled .flex {
      gap: 0.2rem;
    }
  }
  
  /* Ultra-compact for very small screens */
  @media (max-width: 360px) {
    header.scrolled {
      padding: 0;
      margin: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    header.scrolled .nav-btn {
      min-width: 1.5rem;
      height: 1.5rem;
      padding: 0.08rem 0.15rem;
    }
    
    header.scrolled .nav-btn svg {
      width: 0.7rem;
      height: 0.7rem;
    }
    
    header.scrolled .icon-btn {
      width: 1.5rem;
      height: 1.5rem;
    }
    
    header.scrolled #btnCurrency {
      min-width: 1.5rem;
      height: 1.5rem;
    }
    
    header.scrolled .flex {
      gap: 0.15rem;
    }
  }
}

/* Disable all tooltips on header elements */
header [title],
header .tooltip-trigger,
header .tooltip {
  pointer-events: none !important;
}

header [title]:hover::after,
header .tooltip-trigger:hover::after {
  display: none !important;
}

/* Ensure header elements don't show tooltips but allow button interactions */
header * {
  cursor: default !important;
}

/* Allow proper interaction for clickable elements */
header button,
header .nav-btn,
header .icon-btn,
header #btnCurrency,
header #btnLock,
header #btnTheme,
header #btnSync,
header #btnSettings {
  cursor: pointer !important;
  pointer-events: auto !important;
}

/* Remove all tooltips from sign in/sign up buttons */
#btnSignIn,
#btnLogin,
#emailSignInBtn,
#emailSignUpBtn,
#signupBtn,
#backToSignInBtn,
#backToSignInFromSignupBtn {
  pointer-events: auto !important;
  cursor: pointer !important;
}

#btnSignIn .tooltip,
#btnLogin .tooltip,
#emailSignInBtn .tooltip,
#emailSignUpBtn .tooltip,
#signupBtn .tooltip,
#backToSignInBtn .tooltip,
#backToSignInFromSignupBtn .tooltip,
#btnSignIn.tooltip-trigger .tooltip,
#btnLogin.tooltip-trigger .tooltip,
#emailSignInBtn.tooltip-trigger .tooltip,
#emailSignUpBtn.tooltip-trigger .tooltip,
#signupBtn.tooltip-trigger .tooltip,
#backToSignInBtn.tooltip-trigger .tooltip,
#backToSignInFromSignupBtn.tooltip-trigger .tooltip {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

#btnSignIn[title]:hover::after,
#btnLogin[title]:hover::after,
#emailSignInBtn[title]:hover::after,
#emailSignUpBtn[title]:hover::after,
#signupBtn[title]:hover::after,
#backToSignInBtn[title]:hover::after,
#backToSignInFromSignupBtn[title]:hover::after {
  display: none !important;
  content: none !important;
}

/* Title attributes are removed via JavaScript in initializeTooltips() function */

/* ===== NEW ROW ANIMATION ===== */
.new-row-animation {
  animation: newRowSlideIn 0.6s ease-out;
  transform-origin: top;
}

@keyframes newRowSlideIn {
  0% {
    opacity: 0;
    transform: translateY(-20px) scaleY(0.8);
    background-color: var(--accent-bg);
  }
  50% {
    opacity: 0.8;
    transform: translateY(-5px) scaleY(0.95);
    background-color: var(--accent-bg);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scaleY(1);
    background-color: transparent;
  }
}

/* Smooth transition for row removal */
.row-removing {
  animation: rowSlideOut 0.3s ease-in forwards;
}

@keyframes rowSlideOut {
  0% {
    opacity: 1;
    transform: translateY(0) scaleY(1);
  }
  100% {
    opacity: 0;
    transform: translateY(-10px) scaleY(0.9);
    max-height: 0;
    padding: 0;
    margin: 0;
  }
}

/* Smooth transitions for all interactive elements */
header * {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Enhanced hover effects for scrolled state */
header.scrolled .nav-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

header.scrolled .icon-btn:hover {
  transform: translateY(-1px) scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Page Content */
/* Page Content Container - Ultra-smooth transitions */
.page-content {
  display: block;
  position: relative;
  width: 100%;
  min-height: 100vh;
  transform: translate3d(0, 0, 0);
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-style: preserve-3d;
  transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.page-content.hidden {
  display: none;
}

/* Page Transition States - Light and smooth fade transitions */
.page-content {
  transition: opacity 0.15s ease-in-out;
}

.page-content.hidden {
  display: none;
  opacity: 0;
}

/* Remove complex slide animations - using simple fade transitions in JavaScript */

/* Year Tabs */
.year-tab {
  padding: 0.25rem 0.75rem;
  border-radius: 0.375rem;
  border: 1px solid transparent;
  background: transparent;
  color: var(--muted);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
  flex-shrink: 0;
}

.year-tab:hover {
  background: rgba(99, 102, 241, 0.08);
  color: var(--fg);
}

.year-tab.active {
  background: rgba(99, 102, 241, 0.15);
  border-color: rgba(99, 102, 241, 0.3);
  color: var(--fg);
  font-weight: 600;
}

.year-tab-manage {
  padding: 0.25rem;
  border-radius: 0.375rem;
  border: 1px solid transparent;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.year-tab-manage:hover {
  background: rgba(99, 102, 241, 0.08);
  color: var(--fg);
}

/* Year Management Panel */
.year-management-panel {
  position: fixed;
  top: auto;
  bottom: auto;
  right: auto;
  left: auto;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 99999;
  min-width: 160px;
  padding: 6px;
  margin-top: 4px;
  pointer-events: auto;
  /* Ensure it's not clipped by parent containers */
  transform: translateZ(0);
  will-change: transform, opacity;
  /* Prevent any overflow issues */
  overflow: visible;
  isolation: isolate;
}

/* Ensure table containers don't interfere with year panel */
.table-container,
.table,
#yearTabsContainer {
  overflow: visible !important;
  z-index: auto !important;
}

/* Ensure year management panel appears above everything */
.year-management-panel {
  z-index: 99999 !important;
  position: fixed !important;
  /* Create new stacking context */
  isolation: isolate !important;
  /* Ensure it's not affected by parent transforms */
  transform: translateZ(0) !important;
}

.year-management-panel.show {
  display: block;
}

.year-management-panel.hide {
  display: none;
}

.year-management-header {
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--fg);
  margin-bottom: 4px;
  text-align: center;
}

.year-list {
  max-height: 140px;
  overflow-y: auto;
  margin: 4px 0;
}

.year-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 4px 6px;
  border-radius: 3px;
  margin-bottom: 1px;
  font-size: 0.65rem;
  transition: background 0.2s ease;
}

.year-item:hover {
  background: var(--glass);
}

.year-item.active {
  background: var(--primary);
  color: white;
}

.year-item-controls {
  display: flex;
  gap: 3px;
}

.year-btn {
  width: 12px;
  height: 12px;
  border: none;
  border-radius: 2px;
  font-size: 8px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.year-btn-remove {
  background: #ef4444;
  color: white;
}

.year-btn-remove:hover {
  background: #dc2626;
  transform: scale(1.1);
}

.year-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.year-separator {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px 0;
  position: relative;
}

.year-separator-line {
  flex: 1;
  height: 1px;
  background: var(--stroke);
  margin: 0 6px;
}

.year-add-between {
  width: 14px;
  height: 14px;
  border: 1px solid var(--stroke);
  border-radius: 50%;
  background: var(--card);
  color: var(--muted);
  font-size: 8px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  position: relative;
  z-index: 1;
}

.year-add-between:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

.year-add-between:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none;
}

.year-add-between:disabled:hover {
  border-color: var(--stroke);
  color: var(--muted);
  background: var(--card);
}

.year-add-buttons {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.year-add-btn {
  width: 100%;
  padding: 4px 6px;
  border: 1px dashed var(--stroke);
  border-radius: 3px;
  background: transparent;
  color: var(--muted);
  font-size: 0.6rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 3px;
}

.year-add-btn:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: rgba(99, 102, 241, 0.05);
}

.year-add-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Custom Confirmation Dialog */
.year-confirm-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.year-confirm-dialog {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  padding: 16px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  text-align: center;
  min-width: 200px;
  animation: confirmSlideIn 0.2s ease-out;
}

@keyframes confirmSlideIn {
  from {
    opacity: 0;
    transform: translateY(-10px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.year-confirm-message {
  font-size: 0.8rem;
  color: var(--fg);
  margin-bottom: 12px;
}

.year-confirm-buttons {
  display: flex;
  gap: 8px;
  justify-content: center;
}

.year-confirm-btn {
  padding: 6px 16px;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.year-confirm-yes {
  background: #ef4444;
  color: white;
}

.year-confirm-yes:hover {
  background: #dc2626;
  transform: scale(1.05);
}

.year-confirm-no {
  background: var(--glass);
  color: var(--muted);
  border: 1px solid var(--stroke);
}

.year-confirm-no:hover {
  background: var(--card);
  color: var(--fg);
}

/* Sync Button Styles */
.sync-button {
  position: relative;
  overflow: visible;
}

.sync-status {
  position: absolute;
  top: -2px;
  right: -2px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--muted);
  transition: all 0.3s ease;
  opacity: 0;
  transform: scale(0);
}

.sync-status.syncing {
  background: #f59e0b;
  opacity: 1;
  transform: scale(1);
  animation: syncPulse 1s ease-in-out infinite;
}

.sync-status.success {
  background: #6366f1;
  opacity: 1;
  transform: scale(1);
}

.sync-status.error {
  background: #ef4444;
  opacity: 1;
  transform: scale(1);
}

.sync-status.offline {
  background: #6b7280;
  opacity: 1;
  transform: scale(1);
}

@keyframes syncPulse {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.2);
    opacity: 0.7;
  }
}

.sync-button:hover .sync-status {
  opacity: 1;
  transform: scale(1);
}

.kpi{ 
  border-radius:1rem; 
  padding:1rem; 
  border:none; 
  background:linear-gradient(to bottom, rgba(39,39,42,.06), var(--card)); 
  display:flex; 
  flex-direction:column; 
  gap:.4rem; 
  transition:transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.2s ease;
  transform: translate3d(0, 0, 0);
  opacity: 1;
  will-change: transform;
  position: relative;
  overflow: hidden;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Enhanced KPI Card Animations */
.kpi:hover{ 
  transform: translate3d(0, -2px, 0);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.kpi.loading {
  opacity: 0.7;
  transform: translate3d(0, 4px, 0);
}

.kpi.fade-in {
  animation: kpiFadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes kpiFadeIn {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
.kpi h3{ 
  font-size:.7rem; 
  font-weight:700; 
  color:var(--muted); 
  letter-spacing:.08em; 
  text-transform:uppercase; 
  margin-bottom:.2rem;
}
.kpi .value{ 
  font-size:1.4rem; 
  font-weight:800; 
  letter-spacing:-.02em; 
  line-height:1.1;
  transition: all 0.2s ease;
}
.kpi .sub{ 
  font-size:.75rem; 
  color:var(--muted); 
  font-weight:500;
  transition: all 0.2s ease;
}
.kpi-em{ background:linear-gradient(180deg, rgba(99,102,241,.10), rgba(99,102,241,.04) 35%, var(--card)); border:1px solid rgba(99,102,241,.25); }
.bar{ height:8px; border-radius:999px; background:rgba(255,255,255,.06); overflow:hidden; position: relative; }
[data-theme="light"] .bar{ background:#eceff3; }
.bar>span{ 
  display:block; 
  height:100%; 
  background:linear-gradient(90deg, rgba(99,102,241,.9), rgba(56,189,248,.9)); 
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1); 
  position: relative; 
  overflow: hidden;
}

.bar>span::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, rgba(255,255,255,0.2), transparent, rgba(255,255,255,0.2));
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

/* Progress bar loading animation */
.bar.loading {
  background: rgba(255,255,255,.06);
  overflow: hidden;
}

.bar.loading::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  animation: progressLoading 1.5s infinite;
}

[data-theme="light"] .bar.loading::before {
  background: linear-gradient(90deg, transparent, rgba(0,0,0,0.1), transparent);
}

@keyframes progressLoading {
  0% { left: -100%; }
  100% { left: 100%; }
}

/* Progress bar loading text removed */

.input,.select{ 
  width:100%; 
  border-radius:6px; 
  padding:.3rem .4rem; 
  font-size:.7rem; 
  line-height:1.1rem; 
  border:none; 
  background:transparent; 
  color:var(--fg); 
  appearance:none; 
  color-scheme:dark; 
  transition:all .2s ease; 
  backdrop-filter:blur(10px);
  cursor:text;
}

/* Ensure income table inputs use the same styling as default inputs */
.row-income input {
  width: 100% !important;
  border: none !important;
  background: transparent !important;
  color: var(--fg) !important;
  font-size: inherit !important;
  line-height: inherit !important;
  padding: 0.25rem 0.5rem !important;
  border-radius: 0 !important;
  outline: none !important;
  min-width: 0 !important;
  text-align: left !important;
  box-sizing: border-box !important;
}

.input-enhanced {
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 0.5rem 0 !important;
  font-size: 0.8rem !important;
  font-weight: 500 !important;
  transition: all 0.2s ease !important;
  outline: none !important;
  color: var(--fg) !important;
  width: 100% !important;
  min-width: 0 !important;
}

.input-enhanced:focus {
  background: transparent !important;
  box-shadow: none !important;
}

.input-enhanced::placeholder {
  color: var(--muted) !important;
  font-weight: 400 !important;
}

.input-enhanced:hover {
  background: rgba(255, 255, 255, 0.02) !important;
}

/* Settings inputs - modern rounded style without borders */
#inputFx, #inputAutosave, #inputIncludeAnnual, #inputDeleteConfirm {
  background: var(--card) !important;
  border: none !important;
  border-radius: 6px !important;
  padding: 0.35rem 0.5rem !important;
  font-size: 0.75rem !important;
  line-height: 1.2rem !important;
  font-weight: 500 !important;
  color: var(--fg) !important;
  transition: all 0.2s ease !important;
  backdrop-filter: blur(10px) !important;
  outline: none !important;
  width: 100% !important;
}

#inputFx:focus, #inputAutosave:focus, #inputIncludeAnnual:focus, #inputDeleteConfirm:focus {
  background: var(--glass) !important;
  transform: scale(1.01) !important;
  outline: none !important;
}

#inputFx:hover, #inputAutosave:hover, #inputIncludeAnnual:hover, #inputDeleteConfirm:hover {
  background: var(--glass) !important;
  transform: translateY(-1px) !important;
}

#inputFx::placeholder, #inputDeleteConfirm::placeholder {
  color: var(--muted) !important;
  font-weight: 400 !important;
}

/* Settings input wrapper for symbol positioning */
.settings-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  background: var(--card);
  border-radius: 6px;
  padding: 0.35rem 0.5rem;
  transition: all 0.2s ease;
  backdrop-filter: blur(10px);
}

.settings-input-wrapper:hover {
  background: var(--glass);
  transform: translateY(-1px);
}

.settings-input-wrapper:focus-within {
  background: var(--glass);
  transform: scale(1.01);
}

.settings-symbol {
  color: var(--muted);
  font-size: 0.75rem;
  font-weight: 500;
  margin-right: 0.5rem;
  pointer-events: none;
}

.settings-input-wrapper input {
  background: transparent !important;
  border: none !important;
  outline: none !important;
  font-size: 0.75rem !important;
  line-height: 1.2rem !important;
  font-weight: 500 !important;
  color: var(--fg) !important;
  width: 100% !important;
  padding: 0 !important;
}

.settings-input-wrapper input::placeholder {
  color: var(--muted) !important;
  font-weight: 400 !important;
}

/* Compact currency selector in settings */
.settings-currency-select {
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.5rem center;
  background-repeat: no-repeat;
  background-size: 1rem;
  padding-right: 2rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.settings-currency-select:hover {
  border-color: var(--muted);
}

.settings-currency-select:focus {
  outline: none;
  border-color: #6366f1;
  box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
}

/* Ensure select dropdown works properly */
.settings-currency-select {
  position: relative;
  z-index: 10;
  pointer-events: auto;
}

/* Ensure the select container doesn't interfere */
.settings-modal .relative {
  position: relative;
  z-index: 10;
}
/* number input: remove spinners, friendlier mobile keypad */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button{ -webkit-appearance:none; appearance:none; margin:0; }
input[type=number]{ -moz-appearance:textfield; appearance:textfield; }
/* Date inputs - minimal styling only */
input[type=date]{ color-scheme:dark; }
[data-theme="light"] .input,[data-theme="light"] .select{ color-scheme:light; }
.input:focus,.select:focus{ 
  background:var(--card); 
  outline:none; 
  transform:scale(1.01);
  border-color:var(--muted);
}
.input:hover,.select:hover{ 
  background:var(--card);
  transform:translateY(-1px);
}
.input::placeholder{ color:var(--muted); }

/* Modern Status color styling */
.select.status-active{ 
  color:#6366f1; 
  font-weight:500; 
  background:rgba(99, 102, 241, 0.08);
  border:none;
}
.select.status-cancelled{ 
  color:#f87171; 
  font-weight:500; 
  background:rgba(248, 113, 113, 0.08);
  border:none;
}
.select.status-active option[value="Active"]{ 
  color:#6366f1; 
  background:var(--card);
}
.select.status-active option[value="Cancelled"]{ 
  color:#f87171; 
  background:var(--card);
}
.select.status-cancelled option[value="Active"]{ 
  color:#6366f1; 
  background:var(--card);
}
.select.status-cancelled option[value="Cancelled"]{ 
  color:#f87171; 
  background:var(--card);
}

/* Hover effects for status selects */
.select.status-active:hover{ 
  background:rgba(16, 185, 129, 0.12);
  border:none;
}
.select.status-cancelled:hover{ 
  background:rgba(248, 113, 113, 0.12);
  border:none;
}

/* Cost input with dollar sign */
.cost-input-wrapper{ 
  position:relative; 
  display:flex; 
  align-items:center; 
  gap: 0px;
  background: transparent;
  border: none;
  border-radius: 6px;
  padding: 0.25rem 0.35rem;
  min-height: auto;
  width: 100%;
  backdrop-filter: blur(10px);
  transition: all 0.2s ease;
}

.cost-input-wrapper:hover {
  background: var(--card);
  transform: translateY(-1px);
}

.cost-input-wrapper:focus-within {
  background: var(--card);
  outline: none;
  transform: scale(1.01);
}
.cost-input{
  font-size: 0.75rem !important;
  padding: 0 !important;
  margin: 0 !important;
  margin-left: 0px !important;
  padding-left: 0px !important;
  border: none !important;
  background: transparent !important;
  flex: 1;
  outline: none;
  color: var(--fg) !important;
  line-height: 1.2rem !important;
}
.cost-input:focus {
  outline: none !important;
}
.cost-dollar-display{
  font-size: 0.75rem;
  color: var(--fg);
  font-weight: 600;
  min-width: 16px;
  text-align: left;
  margin-right: 0px;
  padding-right: 0px;
}

/* Loading Skeleton */
.loading-skeleton {
  display: block;
}
.loading-skeleton.hidden {
  display: none;
}
.skeleton-rows {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.skeleton-row {
  display: grid;
  grid-template-columns: 24px 40px 1fr 100px 80px 80px 100px 100px 100px 100px 40px;
  gap: 8px;
  height: 48px;
  align-items: center;
  padding: 8px 12px;
  margin: 4px 0;
}
.skeleton-row-biz {
  grid-template-columns: 24px 40px 1fr 100px 80px 80px 100px 100px 100px 100px 100px 40px;
}
.skeleton-row-income {
  grid-template-columns: 24px 40px 1.5fr 120px 100px 80px 100px 100px 120px 100px 1fr 40px;
}
.skeleton-cell {
  height: 20px;
  background: linear-gradient(90deg, var(--glass) 25%, var(--stroke) 50%, var(--glass) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 4px;
}

.skeleton-drag { width: 20px; }
.skeleton-icon { width: 32px; height: 32px; border-radius: 50%; }
.skeleton-name { width: 100%; }
.skeleton-cost { width: 80px; }
.skeleton-status { width: 60px; }
.skeleton-billing { width: 60px; }
.skeleton-monthly { width: 80px; }
.skeleton-yearly { width: 80px; }
.skeleton-monthly-egp { width: 80px; }
.skeleton-yearly-egp { width: 80px; }
.skeleton-next { width: 80px; }
.skeleton-delete { width: 32px; height: 32px; border-radius: 50%; }

/* Income table specific skeleton cells */
.skeleton-tags { width: 80px; }
.skeleton-date { width: 90px; }
.skeleton-progress { width: 60px; }
.skeleton-all-payment { width: 90px; }
.skeleton-i-got { width: 90px; }
.skeleton-got-egp { width: 100px; }
.skeleton-method { width: 80px; }
.skeleton-note { width: 120px; }
.skeleton-paid-usd { width: 90px; }
.skeleton-paid-egp { width: 100px; }

/* Income table specific styles */
.paid-egp-cell {
  font-weight: 600;
  color: var(--fg);
}

.tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 1px 4px;
  border-radius: 6px;
  font-size: 0.45rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.02em;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(56, 189, 248, 0.1));
  border: 1px solid rgba(99, 102, 241, 0.2);
  color: var(--fg);
  margin: 0;
  transition: all 0.2s ease;
  line-height: 1;
  white-space: nowrap;
  flex-shrink: 0;
  max-width: 60px;
  overflow: hidden;
  text-overflow: ellipsis;
  height: 16px;
}

.tag:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.25), rgba(56, 189, 248, 0.15));
  border-color: rgba(99, 102, 241, 0.3);
  transform: translateY(-1px);
}

/* Tags in expanded mode (3+ tags) */
.tag-input-wrapper.expanded .tag {
  margin: 1px 0;
}

/* Modern Tag Selection System */
.tag-input-wrapper {
  position: relative;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  min-height: 20px;
  height: auto;
  max-height: none;
  max-width: 200px;
  width: 200px;
  padding: 2px 4px;
  background: transparent;
  border: none;
  border-radius: 3px;
  transition: all 0.2s ease;
  gap: 3px;
  overflow: visible;
  z-index: 10;
}

/* When wrapper has 1-2 tags, keep single line and centered */
.tag-input-wrapper:not(.expanded) {
  flex-wrap: nowrap;
  max-height: 22px;
  align-items: center;
  justify-content: center;
}

/* When wrapper has 3+ tags, allow multi-line and left align */
.tag-input-wrapper.expanded {
  flex-wrap: wrap;
  align-items: flex-start;
  justify-content: flex-start;
  max-height: none;
  padding: 3px 4px;
}

.tag-input-wrapper:focus-within {
  background: var(--glass);
  transform: scale(1.01);
}

.tag-input-wrapper:hover {
  background: var(--card);
  transform: translateY(-1px);
}

.tag-input-wrapper::-webkit-scrollbar {
  height: 0px;
  background: transparent;
}

.tag-input-wrapper {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.tag-input {
  background: transparent;
  border: none;
  outline: none;
  font-size: 0.45rem;
  color: var(--fg);
  flex: 1 1 auto;
  min-width: 20px;
  max-width: none;
  padding: 0 3px;
  height: 16px;
  text-align: left;
  order: 999;
}

/* Tag input in non-expanded mode (1-2 tags) - center align */
.tag-input-wrapper:not(.expanded) .tag-input {
  text-align: center;
  min-width: 16px;
}

/* Tag input in expanded mode (3+ tags) - left align and full width */
.tag-input-wrapper.expanded .tag-input {
  text-align: left;
  min-width: 60px;
  flex-basis: 100%;
  order: 999;
}

/* When tag input is hidden (locked state) - left align tags */
.tag-input-wrapper:has(.tag-input[style*="display: none"]) {
  justify-content: flex-start;
  align-items: flex-start;
}

/* Alternative approach for locked state - when input is hidden */
.tag-input-wrapper.locked {
  justify-content: flex-start;
  align-items: flex-start;
}

.tag-input::placeholder {
  color: var(--muted);
}

.tag-add-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  flex-shrink: 0;
  cursor: pointer;
  color: var(--muted);
  transition: all 0.2s ease;
  order: 999;
  margin: 0 1px;
  opacity: 0.7;
}

.tag-add-icon:hover {
  color: var(--fg);
  opacity: 1;
  transform: scale(1.15);
}

.tag-add-icon svg {
  width: 100%;
  height: 100%;
  display: block;
}

.tag-input-wrapper:not(.expanded) .tag-add-icon {
  margin: 0;
}

.tag-input:focus ~ .tag-add-icon,
.tag-input-wrapper:has(.tag-input:focus) .tag-add-icon,
.tag-input-wrapper:has(.tag-input:not(:placeholder-shown)) .tag-add-icon,
.tag-input-wrapper.locked .tag-add-icon {
  display: none !important;
}

.tag-dropdown {
  position: absolute;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 99999;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.2s ease;
  max-height: 200px;
  overflow-y: auto;
  min-width: 180px;
  width: 100%;
  pointer-events: none;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
}

/* Dropdown positioning for expanded mode */
.tag-input-wrapper.expanded .tag-dropdown {
  top: calc(100% + 2px);
}

.tag-dropdown.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
  pointer-events: auto;
}

/* Mobile-specific tag dropdown improvements */
@media (max-width: 768px) {
  .tag-dropdown {
    z-index: 999999 !important;
    max-height: 180px;
    min-width: 160px;
    width: auto;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    border-radius: 6px;
  }
  
  .tag-suggestion {
    padding: 12px 14px;
    font-size: 0.75rem;
    min-height: 44px; /* Better touch target on mobile */
    -webkit-tap-highlight-color: rgba(99, 102, 241, 0.2);
  }
  
  .tag-input-wrapper {
    overflow: visible !important;
    z-index: 100 !important;
  }
  
  /* Ensure dropdown stays within viewport on mobile */
  .tag-dropdown {
    max-width: calc(100vw - 20px);
  }
}

.tag-suggestion {
  padding: 8px 12px;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.tag-suggestion:last-child {
  border-bottom: none;
}

.tag-suggestion:hover {
  background: var(--glass);
  color: var(--fg);
}

.tag-suggestion.selected {
  background: rgba(99, 102, 241, 0.1);
  color: var(--fg);
  font-weight: 600;
}

.tag-suggestion-count {
  font-size: 0.6rem;
  color: var(--muted);
  background: var(--glass);
  padding: 2px 6px;
  border-radius: 10px;
}

.tag-chip {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  padding: 1px 6px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(56, 189, 248, 0.1));
  border: 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 10px;
  font-size: 0.6rem;
  font-weight: 600;
  color: var(--fg);
  margin: 1px 2px 1px 0;
  transition: all 0.2s ease;
  flex-shrink: 0;
  white-space: nowrap;
}

.tag-chip:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.25), rgba(56, 189, 248, 0.15));
  border-color: rgba(99, 102, 241, 0.3);
  transform: translateY(-1px);
}

.tag-chip-remove {
  background: none;
  border: none;
  color: var(--muted);
  cursor: pointer;
  padding: 0;
  margin-left: 4px;
  font-size: 0.7rem;
  line-height: 1;
  transition: color 0.2s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 12px;
  height: 12px;
  min-width: 12px;
  min-height: 12px;
}

.tag-chip-remove:hover {
  color: var(--fg);
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
}

.progress-cell span {
  font-weight: 600;
  font-size: 0.8rem;
}

.method-cell span {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
@keyframes skeleton-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Card Text Skeleton Loading */
.card-skeleton {
  display: block;
}

.card-skeleton.hidden {
  display: none;
}

.skeleton-text {
  height: 1rem;
  background: linear-gradient(90deg, var(--glass) 25%, var(--stroke) 50%, var(--glass) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 4px;
  margin: 0.25rem 0;
}

.skeleton-text-sm {
  height: 0.75rem;
  background: linear-gradient(90deg, var(--glass) 25%, var(--stroke) 50%, var(--glass) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 3px;
  margin: 0.2rem 0;
}

.skeleton-text-lg {
  height: 1.5rem;
  background: linear-gradient(90deg, var(--glass) 25%, var(--stroke) 50%, var(--glass) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 6px;
  margin: 0.3rem 0;
}

.skeleton-text-xl {
  height: 2rem;
  background: linear-gradient(90deg, var(--glass) 25%, var(--stroke) 50%, var(--glass) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 8px;
  margin: 0.4rem 0;
}

/* Skeleton text width variations */
.skeleton-w-full { width: 100%; }
.skeleton-w-3-4 { width: 75%; }
.skeleton-w-1-2 { width: 50%; }
.skeleton-w-1-3 { width: 33.333333%; }
.skeleton-w-1-4 { width: 25%; }
.skeleton-w-20 { width: 5rem; }
.skeleton-w-24 { width: 6rem; }
.skeleton-w-32 { width: 8rem; }
.skeleton-w-40 { width: 10rem; }

.select-wrap{ 
  position:relative; 
  width: 100%;
  background: transparent;
  border: none;
  border-radius: 6px;
  padding: 0.25rem 0.35rem;
  backdrop-filter: blur(10px);
  transition: all 0.2s ease;
}
.select-wrap:hover {
  background: var(--card);
  transform: translateY(-1px);
}
.select-wrap:focus-within {
  background: var(--card);
  outline: none;
  transform: scale(1.01);
}
.select-wrap::after{ 
  content:""; 
  position:absolute; 
  right: 0.5rem; 
  top:50%; 
  transform:translateY(-50%); 
  width:0; 
  height:0; 
  border-left:4px solid transparent; 
  border-right:4px solid transparent; 
  border-top:4px solid var(--muted); 
  pointer-events:none; 
  transition:transform .2s ease;
}
.select-wrap:hover::after{ transform:translateY(-50%) scale(1.1); }
.select{ 
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  font-size: 0.75rem !important;
  font-weight: 500 !important;
  color: var(--fg) !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  width: 100% !important;
  line-height: 1.2rem !important;
}
.select:focus {
  background: transparent !important;
  box-shadow: none !important;
  outline: none !important;
}
.select:hover {
  background: transparent !important;
}
.select option {
  background: var(--card) !important;
  color: var(--fg) !important;
  padding: 0.5rem !important;
}

/* Custom Dropdown Menu */
.custom-dropdown {
  position: relative;
  display: inline-block;
  width: 100%;
}

.custom-dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 0.5rem;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.2s ease;
  margin-top: 0.25rem;
}

.custom-dropdown-menu.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.custom-dropdown-item {
  padding: 0.75rem 1rem;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
}

.custom-dropdown-item:last-child {
  border-bottom: none;
}

.custom-dropdown-item:hover {
  background: var(--glass);
  color: var(--fg);
}

.custom-dropdown-item.selected {
  background: rgba(255, 255, 255, 0.05);
  color: var(--fg);
  font-weight: 600;
}

.custom-dropdown-trigger {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0.3rem 0.4rem;
  background: transparent;
  border: none;
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.7rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  backdrop-filter: blur(10px);
}

.custom-dropdown-trigger:hover {
  background: var(--card);
  transform: translateY(-1px);
}

.custom-dropdown-arrow {
  width: 0;
  height: 0;
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-top: 4px solid var(--muted);
  transition: transform 0.2s ease;
}

.custom-dropdown.open .custom-dropdown-arrow {
  transform: rotate(180deg);
}
input[type=date]::-webkit-calendar-picker-indicator{ 
  filter:invert(.7); 
  margin-right:0;
  cursor: pointer;
  width: 12px;
  height: 12px;
  position: absolute;
  right: 0.4rem;
  top: 50%;
  transform: translateY(-50%);
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
}
input[type=date]:hover::-webkit-calendar-picker-indicator{ 
  filter:invert(.9); 
  transform: translateY(-50%) scale(1.1);
}

[data-theme="light"] input[type=date]::-webkit-calendar-picker-indicator{ 
  filter:invert(.3); 
  margin-right:0;
}

[data-theme="light"] input[type=date]:hover::-webkit-calendar-picker-indicator{ 
  filter:invert(.6); 
  transform: translateY(-50%) scale(1.1);
}
input[type=date]{
  padding-right:2.2rem;
  min-width: 100px;
  max-width: 120px;
  font-size: 0.7rem;
  height: 1.8rem;
}

/* ============================================
   MODERN MINIMAL DATE INPUT STYLES
   ============================================ */

/* ============================================
   MODERN DATE DISPLAY - Shows "2 Dec" format
   ============================================ */
.next-date-display {
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  padding: 0.4rem 0.7rem;
  border-radius: 6px;
  transition: all 0.2s ease;
  display: inline-block;
  white-space: nowrap;
  border: 1px solid transparent;
  background: transparent;
}

.next-date-display:hover {
  background: var(--hover);
  border-color: var(--stroke);
  transform: translateY(-1px);
}

/* Hidden date input - only used for functionality */
input[type="date"].date-input-minimal {
  position: absolute !important;
  opacity: 0 !important;
  pointer-events: none !important;
  width: 1px !important;
  height: 1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
}

/* Date column alignment for income table */
.table-container .row-income > div:nth-child(5) {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
}

/* Note column alignment for income table */
.table-container .row-income > div:nth-child(10) {
  display: flex;
  justify-content: flex-start;
  align-items: center;
}

/* Editable PAID EGP Field */
.paid-egp-cell.editable-value {
  cursor: pointer;
  transition: all 0.2s ease;
  border-radius: 4px;
  padding: 0.25rem 0.5rem;
  margin: 0.1rem;
}

.paid-egp-cell.editable-value:hover {
  background-color: var(--hover);
  color: var(--accent);
}

.paid-egp-cell.editing {
  background-color: var(--hover);
  border: 1px solid var(--accent);
}

.editable-input {
  background: transparent;
  border: none;
  color: var(--fg);
  outline: none;
  font-family: inherit;
  font-size: inherit;
  width: 100%;
}

 /* Custom Date Picker Dropdown */
/* ============================================
   MODERN MINIMAL DATE PICKER MODAL
   ============================================ */
.custom-date-picker-modal {
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  background: transparent;
  display: none;
  z-index: 999999 !important;
  pointer-events: none;
  max-height: 80vh;
  overflow-y: auto;
  will-change: transform;
}

.custom-date-picker-modal.show {
  display: block !important;
  pointer-events: auto;
  z-index: 999999 !important;
}

.custom-date-picker-modal.show::before {
  display: none; /* Remove black backdrop overlay */
}

.custom-date-picker-modal,
.custom-date-picker-modal * {
  z-index: 999999 !important;
}

.custom-date-picker {
  background: var(--card) !important;
  backdrop-filter: blur(20px);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  width: 280px;
  position: relative;
  z-index: 999999 !important;
  animation: datePickerSlide 0.15s ease-out;
  overflow: hidden; /* Prevent any content from creating dark edges */
}

@keyframes datePickerSlide {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Light mode adjustments */
[data-theme="light"] .custom-date-picker-modal::before {
  display: none; /* Remove black backdrop overlay */
}

[data-theme="light"] .custom-date-picker {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05);
}

/* Minimal Date Picker Header */
.date-picker-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--stroke);
}

.date-picker-nav {
  background: transparent;
  border: none;
  color: var(--fg);
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 1.2rem;
  font-weight: 400;
  opacity: 0.7;
}

.date-picker-nav:hover {
  background: var(--hover);
  opacity: 1;
  transform: scale(1.1);
}
 
/* Minimal Month/Year Selectors */
.date-picker-month-year {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.date-picker-month-year select {
  background: transparent !important;
  border: none !important;
  color: var(--fg) !important;
  padding: 0.25rem 0.5rem;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

.date-picker-month-year select:hover {
  background: var(--hover) !important;
}

.date-picker-month-year select:focus {
  outline: none;
  background: var(--hover) !important;
}

.date-picker-month-year select option {
  background: var(--card) !important;
  color: var(--fg) !important;
  padding: 0.4rem;
}

/* Minimal Weekday Headers */
.date-picker-weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin-bottom: 0.75rem;
}

.weekday {
  text-align: center;
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--muted);
  padding: 0.5rem 0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Minimal Day Grid */
.date-picker-days {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin-bottom: 1rem;
}

.date-day {
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--fg);
  background: transparent;
  border: 1px solid transparent;
  min-height: 32px;
}

.date-day:hover {
  background: var(--hover);
}

.date-day.other-month {
  color: var(--muted);
  opacity: 0.3;
}

.date-day.today {
  background: var(--accent);
  color: white;
  font-weight: 600;
}

.date-day.selected {
  background: var(--accent);
  color: white;
  font-weight: 600;
  transform: scale(1.1);
}

/* Minimal Footer Buttons */
.date-picker-footer {
  display: flex;
  gap: 0.5rem;
  justify-content: space-between;
  align-items: center;
  padding-top: 0.75rem;
  border-top: 1px solid var(--stroke);
}

.date-picker-btn {
  padding: 0.5rem 1rem;
  border-radius: 6px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  border: none;
  background: transparent;
  color: var(--muted);
}

.date-picker-btn:hover {
  background: var(--hover);
  color: var(--fg);
}

.date-picker-btn.primary {
  background: var(--accent);
  color: white;
}

.date-picker-btn.primary:hover {
  background: var(--accent-hover);
  opacity: 0.9;
}

/* Minimal Method Dropdown for Income Rows */
.method-dropdown-minimal {
  position: relative;
  display: inline-block;
  width: 100%;
  z-index: 10;
}

.method-trigger-minimal {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  width: auto;
  padding: 0.4rem 0.5rem;
  background: transparent;
  border: none;
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 32px;
  min-width: 80px;
  outline: none;
  gap: 0.25rem;
}

.method-trigger-minimal:hover {
  background: var(--glass);
  border-color: var(--muted);
}

.method-text {
  flex: 0 1 auto;
  text-align: left;
  white-space: nowrap;
  overflow: visible;
  text-overflow: unset;
}

.method-arrow {
  width: 8px;
  height: 8px;
  color: var(--muted);
  transition: transform 0.2s ease;
  flex-shrink: 0;
  margin-left: 0.25rem;
}

.method-dropdown-minimal.open .method-arrow {
  transform: rotate(180deg);
}

.method-menu-minimal {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 10001;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.2s ease;
  max-height: 200px;
  overflow-y: auto;
  min-width: 150px;
  pointer-events: none;
  margin-top: 2px;
}

.method-menu-minimal.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
  pointer-events: auto;
}

/* Mobile-specific method dropdown improvements */
@media (max-width: 768px) {
  .method-menu-minimal {
    z-index: 10001 !important;
    max-height: 180px;
    min-width: 160px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    border-radius: 6px;
  }
  
  .method-item-minimal {
    padding: 12px 14px;
    font-size: 0.75rem;
    min-height: 44px; /* Better touch target on mobile */
    -webkit-tap-highlight-color: rgba(99, 102, 241, 0.2);
  }
  
  .method-trigger-minimal {
    -webkit-tap-highlight-color: rgba(99, 102, 241, 0.2);
    min-height: 44px; /* Better touch target */
  }
  
  /* Ensure dropdown stays within viewport on mobile */
  .method-menu-minimal {
    max-width: calc(100vw - 20px);
  }
}

.method-item-minimal {
  padding: 8px 12px;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.method-item-minimal:last-child {
  border-bottom: none;
}

.method-item-minimal:hover {
  background: var(--glass);
  color: var(--fg);
}

.method-item-minimal.selected {
  background: rgba(99, 102, 241, 0.1);
  color: var(--fg);
  font-weight: 600;
}

/* Range input styling for progress slider */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-track {
  background: var(--stroke);
  height: 6px;
  border-radius: 3px;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  background: var(--fg);
  height: 16px;
  width: 16px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid var(--bg);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input[type="range"]::-webkit-slider-thumb:hover {
  background: var(--muted);
  transform: scale(1.1);
}

input[type="range"]::-moz-range-track {
  background: var(--stroke);
  height: 6px;
  border-radius: 3px;
  border: none;
}

input[type="range"]::-moz-range-thumb {
  background: var(--fg);
  height: 16px;
  width: 16px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid var(--bg);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input[type="range"]::-moz-range-thumb:hover {
  background: var(--muted);
  transform: scale(1.1);
}

/* Minimal Status Dropdown for Expense Rows */
.status-dropdown-minimal {
  position: relative;
  display: inline-block;
  width: 100%;
}

.status-trigger-minimal {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0.25rem 0.5rem;
  background: transparent;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.7rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 28px;
}

.status-trigger-minimal.status-active {
  background: rgba(99, 102, 241, 0.1);
  border-color: rgba(99, 102, 241, 0.3);
  color: #6366f1;
}

.status-trigger-minimal.status-cancelled {
  background: rgba(248, 113, 113, 0.1);
  border-color: rgba(248, 113, 113, 0.3);
  color: #f87171;
}

.status-trigger-minimal:hover {
  background: var(--glass);
  border-color: var(--muted);
}

.status-text {
  flex: 1;
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.status-arrow {
  width: 12px;
  height: 12px;
  color: var(--muted);
  transition: transform 0.2s ease;
  flex-shrink: 0;
  margin-left: 0.25rem;
}

.status-dropdown-minimal.open .status-arrow {
  transform: rotate(180deg);
}

.status-menu-minimal {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.2s ease;
  margin-top: 2px;
}

.status-menu-minimal.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.status-item-minimal {
  padding: 0.4rem 0.5rem;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.status-item-minimal:last-child {
  border-bottom: none;
}

.status-item-minimal:hover {
  background: var(--glass);
  color: var(--fg);
}

.status-item-minimal.selected {
  background: rgba(99, 102, 241, 0.1);
  color: var(--fg);
  font-weight: 600;
}

.status-item-minimal.status-active {
  color: #6366f1;
}

.status-item-minimal.status-cancelled {
  color: #f87171;
}

/* Minimal Billing Dropdown for Expense Rows */
.billing-dropdown-minimal {
  position: relative;
  display: inline-block;
  width: 100%;
}

.billing-trigger-minimal {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0.25rem 0.5rem;
  background: transparent;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.7rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 28px;
}

.billing-trigger-minimal:hover {
  background: var(--glass);
  border-color: var(--muted);
}

.billing-text {
  flex: 1;
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.billing-arrow {
  width: 12px;
  height: 12px;
  color: var(--muted);
  transition: transform 0.2s ease;
  flex-shrink: 0;
  margin-left: 0.25rem;
}

.billing-dropdown-minimal.open .billing-arrow {
  transform: rotate(180deg);
}

.billing-menu-minimal {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.2s ease;
  margin-top: 2px;
}

.billing-menu-minimal.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.billing-item-minimal {
  padding: 0.4rem 0.5rem;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.billing-item-minimal:last-child {
  border-bottom: none;
}

.billing-item-minimal:hover {
  background: var(--glass);
  color: var(--fg);
}

.billing-item-minimal.selected {
  background: rgba(99, 102, 241, 0.1);
  color: var(--fg);
  font-weight: 600;
}

/* Super Simple Smart Toggle */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
  background: var(--stroke);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  vertical-align: middle;
}

.toggle-switch:hover {
  background: var(--muted);
}

.toggle-switch.status-active {
  background: #6366f1;
}

.toggle-switch.status-cancelled {
  background: #ef4444;
}

.toggle-switch.billing-monthly {
  background: var(--stroke);
}

.toggle-switch.billing-annually {
  background: var(--stroke);
}

.toggle-slider {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: 50%;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.toggle-switch.status-active .toggle-slider {
  transform: translateX(20px);
}

.toggle-switch.status-cancelled .toggle-slider {
  transform: translateX(0);
}

.toggle-switch.billing-monthly .toggle-slider {
  transform: translateX(0);
}

.toggle-switch.billing-annually .toggle-slider {
  transform: translateX(20px);
}

.toggle-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 0.35rem;
  font-weight: 700;
  color: #333;
  z-index: 2;
  pointer-events: none;
  text-align: center;
  line-height: 1;
}

/* super minimal modern table design */
.row{
  display:grid;
  grid-template-columns:24px 32px 1.5fr .8fr .8fr .8fr 1fr 1fr 1fr 1fr 32px;
  gap:.7rem;
  align-items:center;
  padding:.5rem .4rem;
  border-bottom:1px solid var(--stroke);
  transition:transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), background-color 0.2s ease;
  background: var(--card);
  transform: translate3d(0, 0, 0);
  opacity: 1;
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  position: relative;
}

/* Enhanced Row Animations */
.row:hover{
  transform: translate3d(0, -1px, 0);
  background: var(--glass);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* Sticky name column enhancements - clean and minimal */
.row > div:nth-child(3),
.row-biz > div:nth-child(3),
.row-income > div:nth-child(3) {
  box-shadow: none;
  border: none;
  margin: 0;
  padding-left: 0;
}

.row.fade-in {
  animation: rowFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.row.slide-in {
  animation: rowSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes rowFadeIn {
  0% {
    opacity: 0;
    transform: translateY(10px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes rowSlideIn {
  0% {
    opacity: 0;
    transform: translateX(-20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Perfect grid alignment for personal expenses */
.row > div:nth-child(1) { grid-column: 1; } /* Drag handle */
.row > div:nth-child(2) { grid-column: 2; } /* Icon */
.row > div:nth-child(3) { 
  grid-column: 3; /* Name */
  position: sticky;
  left: 56px; /* 24px drag handle + 32px icon */
  background: var(--card);
  z-index: 30 !important; /* Higher z-index to stay above all other elements */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  min-width: 80px; /* Reduced width for name inputs */
  max-width: 120px; /* Maximum width to prevent excessive expansion */
  width: fit-content; /* Make background hug the content */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: box-shadow 0.2s ease;
}
.row > div:nth-child(4) { grid-column: 4; } /* Cost USD */
.row > div:nth-child(5) { grid-column: 5; } /* Status */
.row > div:nth-child(6) { grid-column: 6; } /* Billing */
.row > div:nth-child(7) { grid-column: 7; } /* Monthly USD */
.row > div:nth-child(8) { grid-column: 8; } /* Yearly USD */
.row > div:nth-child(9) { grid-column: 9; } /* Monthly EGP */
.row > div:nth-child(10) { grid-column: 10; } /* Yearly EGP */
.row > div:nth-child(11) { grid-column: 11; } /* Delete */
.row:hover{ background:var(--glass); }
.row:last-child{ border-bottom:none; }

/* Light mode table row backgrounds */
[data-theme="light"] .row {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .row:hover {
  background: rgba(241, 245, 249, 0.9);
}
.row-biz{
  display:grid;
  grid-template-columns:24px 32px 1.4fr .8fr .8fr .8fr .8fr .9fr .9fr .9fr .9fr 32px; 
  gap:.7rem;
  align-items:center;
  padding:.5rem .4rem;
  border-bottom:1px solid var(--stroke);
  transition:background-color .2s ease;
  background: var(--card);
  position: relative;
}

/* Perfect grid alignment for business expenses */
.row-biz > div:nth-child(1) { grid-column: 1; } /* Drag handle */
.row-biz > div:nth-child(2) { grid-column: 2; } /* Icon */
.row-biz > div:nth-child(3) { 
  grid-column: 3; /* Name */
  position: sticky;
  left: 56px; /* 24px drag handle + 32px icon */
  background: var(--card);
  z-index: 30 !important; /* Higher z-index to stay above all other elements */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  min-width: 80px; /* Reduced width for name inputs */
  max-width: 120px; /* Maximum width to prevent excessive expansion */
  width: fit-content; /* Make background hug the content */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: box-shadow 0.2s ease;
}
.row-biz > div:nth-child(4) { grid-column: 4; } /* Cost USD */
.row-biz > div:nth-child(5) { grid-column: 5; } /* Status */
.row-biz > div:nth-child(6) { grid-column: 6; } /* Billing */
.row-biz > div:nth-child(7) { grid-column: 7; } /* Next */
.row-biz > div:nth-child(8) { grid-column: 8; } /* Monthly USD */
.row-biz > div:nth-child(9) { grid-column: 9; } /* Yearly USD */
.row-biz > div:nth-child(10) { grid-column: 10; } /* Monthly EGP */
.row-biz > div:nth-child(11) { grid-column: 11; } /* Yearly EGP */
.row-biz > div:nth-child(12) { grid-column: 12; } /* Delete */
.row-biz:hover{ background:var(--glass); }
.row-biz:last-child{ border-bottom:none; }

/* Light mode business table row backgrounds */
[data-theme="light"] .row-biz {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .row-biz:hover {
  background: rgba(241, 245, 249, 0.9);
}

/* SVG Icon Theme Inversion - Smart Detection */
/* Default: assume SVGs are black, show white in dark mode, black in light mode */
.custom-svg-icon {
  filter: invert(1) !important; /* Dark mode: black SVG → white */
  transition: filter 0.2s ease;
}

[data-theme="light"] .custom-svg-icon {
  filter: none !important; /* Light mode: black SVG → black (no filter) */
}

/* Smart inversion based on SVG content analysis */
.custom-svg-icon[data-svg-type="white"] {
  filter: none !important; /* Dark mode: white SVG → white (no filter) */
}

[data-theme="light"] .custom-svg-icon[data-svg-type="white"] {
  filter: invert(1) !important; /* Light mode: white SVG → black */
}

.custom-svg-icon[data-svg-type="black"] {
  filter: invert(1) !important; /* Dark mode: black SVG → white */
}

[data-theme="light"] .custom-svg-icon[data-svg-type="black"] {
  filter: none !important; /* Light mode: black SVG → black (no filter) */
}

.custom-svg-icon[data-svg-type="colored"] {
  filter: invert(1) !important; /* Dark mode: colored SVG → white */
}

[data-theme="light"] .custom-svg-icon[data-svg-type="colored"] {
  filter: invert(1) brightness(0) !important; /* Light mode: colored SVG → black */
}

/* Fallback for any img in icon-cell */
.icon-cell img {
  filter: invert(1) !important; /* Dark mode: black SVG → white */
  transition: filter 0.2s ease;
}

[data-theme="light"] .icon-cell img {
  filter: none !important; /* Light mode: black SVG → black (no filter) */
}

.row-income{ 
  display:grid; 
  grid-template-columns:20px 28px 108px 1.2fr 100px 100px 100px 120px 1fr 100px 80px 28px; 
  gap:0.4rem; 
  align-items:center; 
  padding:.5rem .4rem; 
  border-bottom:1px solid var(--stroke); 
  transition:background-color .2s ease;
  position: relative;
  z-index: 1;
  background: var(--card);
  font-size: 0.7rem;
}

/* Perfect grid alignment for income table */
.row-income > div:nth-child(1) { grid-column: 1; } /* Spacer */
.row-income > div:nth-child(2) { grid-column: 2; } /* Icon */
.row-income > div:nth-child(3) { 
  grid-column: 3; /* Project Name */
  position: sticky;
  left: 28px; /* 28px icon (spacer is empty, no width) */
  background: transparent;
  z-index: 30 !important; /* Higher z-index to stay above payment and all other elements */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  min-width: 108px; /* Minimum width to prevent shrinking */
  width: fit-content; /* Make background hug the content */
  max-width: 100%; /* Ensure it doesn't exceed grid column width */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: background 0.2s ease, box-shadow 0.2s ease;
}

/* Show background on row hover */
.row-income:hover > div:nth-child(3) {
  background: var(--card);
}

/* Light mode hover background */
[data-theme="light"] .row-income:hover > div:nth-child(3) {
  background: rgba(248, 250, 252, 0.9);
}
.row-income > div:nth-child(4) { grid-column: 4; z-index: 1 !important; position: relative; } /* Tags */
.row-income > div:nth-child(5) { grid-column: 5; z-index: 1 !important; position: relative; } /* Date */
.row-income > div:nth-child(6) { grid-column: 6; z-index: 1 !important; position: relative; } /* All Payment */
.row-income > div:nth-child(7) { grid-column: 7; z-index: 1 !important; position: relative; } /* Paid USD */
.row-income > div:nth-child(8) { grid-column: 8; z-index: 1 !important; position: relative; } /* Paid EGP */
.row-income > div:nth-child(9) { grid-column: 9; z-index: 1 !important; position: relative; } /* Method */
.row-income > div:nth-child(10) { grid-column: 10; z-index: 1 !important; position: relative; } /* Progress */
.row-income > div:nth-child(11) { 
  grid-column: 11; /* Payment */
  display: flex;
  align-items: center;
  justify-content: flex-start;
  z-index: 1 !important; /* Lower z-index to stay below sticky name */
  position: relative; /* Create stacking context */
}
.row-income > div:nth-child(12) { grid-column: 12; z-index: 1 !important; position: relative; } /* Delete */

/* Grouped View Styles */
.row-project-header {
  background: var(--glass) !important;
  border-left: 3px solid var(--accent) !important;
  border-bottom: 2px solid var(--stroke) !important;
  border-top: 2px solid var(--stroke) !important;
  margin-top: 0.75rem !important;
  padding: 0.65rem 0.4rem !important;
  font-weight: 600;
  position: relative;
}

.row-project-header:first-child {
  margin-top: 0 !important;
}

.row-deposit-nested {
  background: var(--card) !important;
  border-left: 3px solid transparent !important;
  position: relative;
  opacity: 0.95;
  transition: all 0.2s ease;
}

/* Add padding only to project name column to maintain grid alignment for other columns */
.row-deposit-nested > div:nth-child(3) {
  padding-left: 1rem !important;
}

.row-deposit-nested:hover {
  background: var(--hover) !important;
  opacity: 1;
  border-left-color: var(--accent) !important;
}

.row-deposit-nested::before {
  content: '';
  position: absolute;
  left: 0.5rem;
  top: 50%;
  width: 8px;
  height: 1px;
  background: var(--stroke);
  opacity: 0.5;
}

.row-deposit-nested .icon-cell {
  opacity: 0.7 !important;
}

.row-deposit-nested .icon-cell button {
  opacity: 0.8;
}

/* Add Deposit Row */
.row-add-deposit {
  background: transparent !important;
  border: none !important;
  padding: 0.15rem 0.4rem !important;
  margin-bottom: 0.25rem;
  min-height: 28px !important;
  height: auto !important;
  display: grid !important;
  visibility: visible !important;
  opacity: 1 !important;
}

.row-add-deposit > div:first-child {
  grid-column: 1 / -1;
  padding-left: 1rem;
  display: flex !important;
  align-items: center;
  pointer-events: auto;
  min-height: 24px;
}

.row-add-deposit button {
  pointer-events: auto !important;
  z-index: 100 !important;
  position: relative !important;
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* Compact Add Row Button for Groups */
.add-row-group-btn {
  /* Inherits from .btn class, overridden inline for compact size */
}

/* Income View Toggle Button */
.income-view-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  color: var(--fg);
  cursor: pointer;
  transition: all 0.2s ease;
  opacity: 0.8;
}

.income-view-toggle:hover {
  background: var(--hover);
  border-color: var(--accent);
  opacity: 1;
  transform: translateY(-1px);
}

.income-view-toggle.active {
  background: var(--accent-bg);
  border-color: var(--accent);
  color: var(--accent);
  opacity: 1;
}

.income-view-toggle svg {
  width: 16px;
  height: 16px;
}

/* CRITICAL: Preserve empty divs to maintain grid structure */
.row > div:empty,
.row-biz > div:empty,
.row-income > div:empty,
.row-head > div:empty {
  min-height: 1px;
  min-width: 1px;
  display: block;
}

/* Ensure empty divs don't break grid layout */
.row > div:empty:before,
.row-biz > div:empty:before,
.row-income > div:empty:before,
.row-head > div:empty:before {
  content: '';
  display: block;
  min-height: 1px;
}

/* CRITICAL: Force grid structure integrity */
.row,
.row-biz,
.row-income,
.row-head {
  display: grid !important;
}

/* Sticky table header for ALL tables */
.table-container .row-head {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--card) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  margin-bottom: 0;
}

[data-theme="light"] .table-container .row-head {
  background: rgba(248, 250, 252, 0.95) !important;
  backdrop-filter: blur(10px);
}

/* Minimal Progress Toggle - Clean and Interactive Design */
.progress-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  min-height: 24px;
}

.progress-toggle button {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  padding: 0.25rem 0.5rem;
  font-size: 0.65rem;
  font-weight: 600;
  color: var(--fg);
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  min-width: 60px;
  min-height: 24px;
  height: 24px;
  line-height: 1.2;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.progress-toggle button:hover {
  background: var(--glass);
  border-color: var(--accent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
}

.progress-toggle button:active {
  transform: translateY(0);
  box-shadow: 0 2px 6px rgba(99, 102, 241, 0.3);
}

/* Minimal Progress States - Clean Visual Design */
.progress-toggle button.progress-0 { 
  background: var(--card);
  color: var(--muted);
  border-color: var(--stroke);
  position: relative;
}

.progress-toggle button.progress-0::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, var(--danger) 0%, var(--danger) 0%, transparent 0%);
  border-radius: 6px;
  z-index: -1;
}

.progress-toggle button.progress-25 { 
  background: var(--card);
  color: var(--fg);
  border-color: var(--stroke);
  position: relative;
}

.progress-toggle button.progress-25::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, var(--warning) 0%, var(--warning) 25%, transparent 25%);
  border-radius: 6px;
  z-index: -1;
}

.progress-toggle button.progress-50 { 
  background: var(--card);
  color: var(--fg);
  border-color: var(--accent);
  position: relative;
}

.progress-toggle button.progress-50::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent) 50%, transparent 50%);
  border-radius: 6px;
  z-index: -1;
}

.progress-toggle button.progress-75 { 
  background: var(--card);
  color: white;
  border-color: var(--accent);
  position: relative;
}

.progress-toggle button.progress-75::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent) 75%, transparent 75%);
  border-radius: 6px;
  z-index: -1;
}

.progress-toggle button.progress-100 { 
  background: var(--accent);
  color: white !important;
  border-color: var(--accent);
  box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3);
  position: relative;
  z-index: 1;
}

.progress-toggle button.progress-100::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--accent);
  border-radius: 6px;
  z-index: -1;
}

.progress-toggle button.progress-100 * {
  position: relative;
  z-index: 2;
  color: white !important;
}

/* Enhanced hover effects for progress states */
.progress-toggle button.progress-0:hover {
  color: var(--danger);
  border-color: var(--danger);
}

.progress-toggle button.progress-25:hover {
  color: var(--warning);
  border-color: var(--warning);
}

.progress-toggle button.progress-50:hover,
.progress-toggle button.progress-75:hover,
.progress-toggle button.progress-100:hover {
  color: white;
  border-color: var(--accent);
}

/* Smooth progress bar animations */
.progress-toggle button::before {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Progress state transitions */
.progress-toggle button {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Interactive click animation */
.progress-toggle button:active {
  transform: scale(0.95) !important;
  transition: transform 0.1s ease;
}

/* Focus states for accessibility */
.progress-toggle button:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Progress indicator tooltip enhancement */
.progress-toggle button[title]:hover::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: var(--card);
  color: var(--fg);
  padding: 0.5rem 0.75rem;
  border-radius: 6px;
  font-size: 0.7rem;
  white-space: nowrap;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  border: 1px solid var(--stroke);
  z-index: 1000;
  pointer-events: none;
}

/* Light mode progress button improvements with primary colors for better contrast */
[data-theme="light"] .progress-toggle button {
  background: var(--card);
  border: 1.5px solid var(--stroke);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .progress-toggle button:hover {
  background: var(--glass);
  border-color: var(--accent);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
}

[data-theme="light"] .progress-toggle button.progress-0 {
  background: var(--card);
  color: var(--fg);
  border-color: var(--stroke);
}

[data-theme="light"] .progress-toggle button.progress-0::before {
  background: linear-gradient(90deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.15) 0%, transparent 0%);
}

[data-theme="light"] .progress-toggle button.progress-0:hover {
  color: #dc2626;
  border-color: #dc2626;
  background: rgba(239, 68, 68, 0.1);
}

[data-theme="light"] .progress-toggle button.progress-25 {
  background: var(--card);
  color: var(--fg);
  border-color: var(--stroke);
}

[data-theme="light"] .progress-toggle button.progress-25::before {
  background: linear-gradient(90deg, rgba(251, 191, 36, 0.3) 0%, rgba(251, 191, 36, 0.3) 25%, transparent 25%);
}

[data-theme="light"] .progress-toggle button.progress-25:hover {
  color: #d97706;
  border-color: #f59e0b;
  background: rgba(251, 191, 36, 0.15);
}

[data-theme="light"] .progress-toggle button.progress-50 {
  background: var(--card);
  color: var(--fg);
  border-color: var(--accent);
}

[data-theme="light"] .progress-toggle button.progress-50::before {
  background: linear-gradient(90deg, rgba(99, 102, 241, 0.25) 0%, rgba(99, 102, 241, 0.25) 50%, transparent 50%);
}

[data-theme="light"] .progress-toggle button.progress-50:hover {
  color: var(--accent);
  border-color: var(--accent);
  background: rgba(99, 102, 241, 0.1);
}

[data-theme="light"] .progress-toggle button.progress-75 {
  background: var(--card);
  color: var(--fg);
  border-color: var(--accent);
}

[data-theme="light"] .progress-toggle button.progress-75::before {
  background: linear-gradient(90deg, rgba(99, 102, 241, 0.4) 0%, rgba(99, 102, 241, 0.4) 75%, transparent 75%);
}

[data-theme="light"] .progress-toggle button.progress-75:hover {
  color: var(--accent);
  border-color: var(--accent);
  background: rgba(99, 102, 241, 0.15);
}

[data-theme="light"] .progress-toggle button.progress-100 {
  background: var(--accent);
  color: white !important;
  border-color: var(--accent);
  box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3), 0 2px 8px rgba(99, 102, 241, 0.25);
  z-index: 1;
}

[data-theme="light"] .progress-toggle button.progress-100::before {
  background: var(--accent);
}

[data-theme="light"] .progress-toggle button.progress-100:hover {
  background: var(--accent-hover);
  border-color: var(--accent-hover);
  box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.4), 0 4px 12px rgba(99, 102, 241, 0.3);
  color: white !important;
}

[data-theme="light"] .progress-toggle button.progress-100 * {
  position: relative;
  z-index: 2;
  color: white !important;
}

/* Note input styles */
.note-input {
  width: 100%;
  padding: 0.4rem 0.6rem;
  font-size: 0.7rem;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  background: var(--card);
  color: var(--fg);
  outline: none;
  transition: all 0.2s ease;
  resize: none;
  min-height: 32px;
  max-height: 80px;
}

/* Remove resize arrow from all textareas */
textarea {
  resize: none;
}

/* Hide resize arrow/corner indicator completely for note inputs */
.row-income textarea {
  resize: none !important;
  overflow: hidden;
  scrollbar-width: none; /* Hide scrollbar in Firefox */
  -ms-overflow-style: none; /* Hide scrollbar in IE/Edge */
}

/* Hide resize handle specifically - for browsers that still show it */
.row-income textarea::-webkit-resizer {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

/* Hide scrollbar in Chrome/Safari */
.row-income textarea::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.note-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent-bg);
}

.note-input::placeholder {
  color: var(--muted);
  font-size: 0.65rem;
}

/* Payment button styles (replaces note input) */
.payment-button {
  width: fit-content;
  min-width: fit-content;
  padding: 0.25rem 0.5rem;
  font-size: 0.65rem;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  background: var(--card);
  color: var(--fg);
  outline: none;
  transition: all 0.2s ease;
  min-height: 24px;
  height: 24px;
  line-height: 1.2;
  text-align: left;
  cursor: pointer;
  white-space: nowrap;
  position: relative;
  z-index: 1 !important; /* Lower z-index to stay below sticky name column */
  isolation: isolate; /* Create new stacking context */
}

.payment-button:hover:not(:disabled) {
  border-color: var(--accent);
  background: var(--glass);
}

.payment-button:focus:not(:disabled) {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent-bg);
}

.payment-button:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

/* Ensure all grid items maintain their position */
.row > div,
.row-biz > div,
.row-income > div,
.row-head > div {
  display: flex;
  align-items: center;
  min-height: 1px;
}
.row-income:hover{ background:var(--glass); }
.row-income:last-child{ border-bottom:none; }

/* Light mode income table row backgrounds */
[data-theme="light"] .row-income {
  background: rgba(248, 250, 252, 0.8);
}

[data-theme="light"] .row-income:hover {
  background: rgba(241, 245, 249, 0.9);
}

/* Grey effect for inactive rows in expense tables */
.row.inactive,
.row-biz.inactive {
  opacity: 0.5;
  color: var(--muted);
}

.row.inactive *,
.row-biz.inactive * {
  color: var(--muted) !important;
}

.row.inactive:hover,
.row-biz.inactive:hover {
  opacity: 0.6;
}

/* Delete button styling for income table - matches expenses table */
.row-income .delete-btn {
  width: 32px;
  height: 32px;
  border: none;
  border-radius: 0.5rem;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  margin-left: auto;
  margin-right: 8px;
}

.row-income .delete-btn:hover {
  background: rgba(239, 68, 68, 0.1);
  color: #ef4444;
  transform: scale(1.05);
}

.row-income .delete-btn:active {
  transform: scale(0.95);
}

/* Increase z-index when dropdown is open */
.row-income:has(.tag-dropdown.show),
.row-income:has(.method-menu-minimal.show) {
  z-index: 100;
}

.row:has(.tag-dropdown.show),
.row-biz:has(.tag-dropdown.show) {
  z-index: 100;
}

/* Responsive Table Container */
.table-container {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border-radius: 8px !important;
  border: none;
  background: var(--card);
  /* Ensure horizontal scrolling works properly */
  width: 100%;
  position: relative;
}

.table-container::-webkit-scrollbar {
  height: 8px;
}

.table-container::-webkit-scrollbar-track {
  background: var(--glass);
  border-radius: 4px;
}

.table-container::-webkit-scrollbar-thumb {
  background: var(--muted);
  border-radius: 4px;
  transition: background 0.2s ease;
}

.table-container::-webkit-scrollbar-thumb:hover {
  background: var(--fg);
}

/* Modern Icon Picker Styles */
.icon-grid-container {
  scrollbar-width: thin;
  scrollbar-color: var(--muted) transparent;
}

.icon-grid-container::-webkit-scrollbar {
  width: 6px;
}

.icon-grid-container::-webkit-scrollbar-track {
  background: transparent;
}

.icon-grid-container::-webkit-scrollbar-thumb {
  background: var(--muted);
  border-radius: 3px;
}

.icon-grid-container::-webkit-scrollbar-thumb:hover {
  background: var(--fg);
}

.icon-tile-modern {
  width: 48px;
  height: 48px;
  border: 1px solid var(--stroke);
  border-radius: 8px;
  background: var(--card);
  color: var(--fg);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.icon-tile-modern:hover {
  border-color: var(--accent);
  background: var(--accent-bg);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.icon-tile-modern:active {
  transform: translateY(0);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.icon-tile-modern i {
  font-size: 16px;
  color: inherit;
}

.custom-icon-container-modern {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.custom-icon-container-modern img {
  width: 20px;
  height: 20px;
  object-fit: contain;
  filter: invert(1);
}

.custom-icon-delete-modern {
  position: absolute;
  top: -4px;
  right: -4px;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--danger);
  color: white;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.2s ease;
  z-index: 10;
}

.custom-icon-container-modern:hover .custom-icon-delete-modern {
  opacity: 1;
  transform: scale(1);
}

.custom-icon-delete-modern:hover {
  background: var(--danger-hover);
  transform: scale(1.1);
}

.custom-icon-delete-modern svg {
  width: 8px;
  height: 8px;
}

/* Enhanced tab styles */
.tab-btn {
  padding: 0.75rem 1.5rem;
  border: none;
  background: transparent;
  color: var(--muted);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease;
  border-radius: 0.5rem 0.5rem 0 0;
  position: relative;
}

.tab-btn:hover {
  color: var(--fg);
  background: var(--glass);
}

.tab-btn.active {
  color: var(--fg);
  border-bottom-color: var(--accent);
  background: var(--glass);
}

.tab-btn.active::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 50%;
  transform: translateX(-50%);
  width: 20px;
  height: 2px;
  background: var(--accent);
  border-radius: 1px;
}

/* Icon picker modal enhancements */
#iconPicker {
  backdrop-filter: blur(8px);
}

#iconPicker .card {
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  border: 1px solid var(--stroke);
  background: var(--card) !important;
}

#iconPicker .card header {
  background: transparent !important;
  border-bottom: 1px solid var(--stroke);
  padding-bottom: 1rem;
  margin-bottom: 1rem;
}

#iconSearch {
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 0.75rem;
  padding: 0.75rem 1rem 0.75rem 2.5rem;
  font-size: 0.875rem;
  transition: all 0.2s ease;
  width: 100%;
}

#iconSearch:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-bg);
  outline: none;
}

#iconSearch::placeholder {
  color: var(--muted);
  opacity: 0.7;
}

/* Loading state for icon picker */
.icon-picker-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  color: var(--muted);
}

.icon-picker-loading::after {
  content: '';
  width: 20px;
  height: 20px;
  border: 2px solid var(--stroke);
  border-top: 2px solid var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-left: 0.5rem;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Hide scrollbar for icon picker */
#iconPickerGrid::-webkit-scrollbar {
  width: 0px;
  background: transparent;
}

#iconPickerGrid {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

/* Ensure minimum width for table */
.table-container .row-head,
.table-container .row,
.table-container .row-biz,
.table-container .row-income {
  min-width: 800px;
}

/* Ensure table rows respect container rounded corners */
.table-container .row-head:first-child {
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

.table-container .row:last-child,
.table-container .row-biz:last-child,
.table-container .row-income:last-child {
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}

/* Mobile optimizations */
@media (max-width: 768px) {
  
  /* Enhanced table container for mobile scrolling */
  .table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    scroll-behavior: smooth;
    /* Ensure proper touch scrolling */
    touch-action: pan-x;
    /* Add visual scroll indicators */
    scrollbar-width: thin;
    scrollbar-color: var(--muted) var(--glass);
    /* Ensure container takes full width and allows horizontal scroll */
    width: 100% !important;
    max-width: 100% !important;
    position: relative !important;
    /* Add subtle shadow to indicate scrollable content */
    box-shadow: inset -10px 0 10px -10px rgba(0,0,0,0.1);
  }
  
  /* Scroll indicator removed - no gradient overlay */
  
  .table-container .row-head,
  .table-container .row,
  .table-container .row-biz,
  .table-container .row-income {
    min-width: 1000px;
    font-size: 0.7rem;
  }
  
  /* Ensure all income inputs are visible on mobile */
  .table-container .row-income input {
    font-size: 0.75rem !important;
    min-height: 32px !important;
    padding: 0.5rem 0.75rem !important;
    line-height: 1.3 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  /* Ensure all income table cells show text properly */
  .table-container .row-income > * {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    min-width: 0 !important;
  }
  
  /* Fix specific columns for better mobile display */
  .table-container .row-income input[type="date"] {
    font-size: 0.7rem !important;
    min-height: 32px !important;
    padding: 0.4rem 0.6rem !important;
    line-height: 1.2 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
  }
  
  /* Fix All Payment and Paid USD columns */
  .table-container .row-income .cost-input-wrapper,
  .table-container .row-income .financial-input-wrapper {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  .table-container .row-income .cost-input,
  .table-container .row-income .financial-value {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  /* Fix cost and financial input elements specifically */
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
    font-size: 0.7rem !important;
    padding: 0.4rem 0.6rem !important;
  }
  
  .table-container .row-income .cost-dollar-display,
  .table-container .row-income .financial-symbol {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    flex-shrink: 0 !important;
    margin-right: 0px !important;
    padding-right: 0px !important;
  }
  
  .table-container .row-head {
    padding: 0.4rem 0.3rem;
    gap: 0.3rem;
  }
  
  .table-container .row-head.row-biz {
    grid-template-columns: 20px 28px 1.2fr 0.7fr 0.7fr 0.7fr 0.7fr 0.8fr 0.8fr 0.8fr 0.8fr 28px;
  }
  
  .table-container .row-head.row-income {
    grid-template-columns: 20px 30px 200px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    text-align: center;
    align-items: center;
  }
  
  /* Align specific header columns with their content */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: center; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  .table-container .row-head.row-income > div:nth-child(10) { text-align: center; } /* Progress */
  .table-container .row-head.row-income > div:nth-child(11) { text-align: left; } /* Payment */
  
  /* Better mobile layout for income table */
  .table-container .row-income {
    grid-template-columns: 20px 30px 120px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    gap: 0.3rem;
    padding: 0.4rem 0.5rem 0.4rem 0.5rem;
    min-height: 40px;
    white-space: nowrap;
  }
  
  /* Fixed widths for name and payment inputs on 500px screens */
  .table-container .row-income > div:nth-child(3) input,
  .table-container .row-income > div:nth-child(11) input,
  .table-container .row-income > div:nth-child(11) textarea {
    min-width: 100% !important;
    width: 100% !important;
  }
  
  /* Ensure minimum widths for name and payment on 500px screens */
  .table-container .row-income > div:nth-child(3) {
    min-width: 120px !important;
  }
  .table-container .row-income > div:nth-child(11) {
    min-width: 80px !important;
  }
  
  /* Ensure sticky name stays above tags - z-index on small screens */
  .table-container .row-income > div:nth-child(3) {
    z-index: 10 !important;
  }
  .table-container .row-income > div:nth-child(4) {
    z-index: 1 !important;
  }
  
  /* Ensure proper alignment on mobile for tags and date */
  .table-container .row-income > div:nth-child(4),
  .table-container .row-income > div:nth-child(5) {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
  }
  
  /* Mobile date input styling - positioned directly under DATE title */
  .table-container .row-income .date-input-minimal {
    padding: 0.4rem 0.6rem;
    font-size: 0.7rem;
    margin-left: 0;
    padding-left: 0;
    text-indent: 0;
  }
  
  /* Mobile date container alignment */
  .table-container .row-income > div:nth-child(5) {
    padding-left: 0;
    margin-left: 0;
    align-items: flex-start;
  }
  
  /* Perfect grid alignment for mobile - all tables */
  .table-container .row > div:nth-child(1) { grid-column: 1; }
  .table-container .row > div:nth-child(2) { grid-column: 2; }
  .table-container .row > div:nth-child(3) { grid-column: 3; }
  .table-container .row > div:nth-child(4) { grid-column: 4; }
  .table-container .row > div:nth-child(5) { grid-column: 5; }
  .table-container .row > div:nth-child(6) { grid-column: 6; }
  .table-container .row > div:nth-child(7) { grid-column: 7; }
  .table-container .row > div:nth-child(8) { grid-column: 8; }
  .table-container .row > div:nth-child(9) { grid-column: 9; }
  .table-container .row > div:nth-child(10) { grid-column: 10; }
  .table-container .row > div:nth-child(11) { grid-column: 11; }
  
  .table-container .row-biz > div:nth-child(1) { grid-column: 1; }
  .table-container .row-biz > div:nth-child(2) { grid-column: 2; }
  .table-container .row-biz > div:nth-child(3) { grid-column: 3; }
  .table-container .row-biz > div:nth-child(4) { grid-column: 4; }
  .table-container .row-biz > div:nth-child(5) { grid-column: 5; }
  .table-container .row-biz > div:nth-child(6) { grid-column: 6; }
  .table-container .row-biz > div:nth-child(7) { grid-column: 7; }
  .table-container .row-biz > div:nth-child(8) { grid-column: 8; }
  .table-container .row-biz > div:nth-child(9) { grid-column: 9; }
  .table-container .row-biz > div:nth-child(10) { grid-column: 10; }
  .table-container .row-biz > div:nth-child(11) { grid-column: 11; }
  .table-container .row-biz > div:nth-child(12) { grid-column: 12; }
  
  .table-container .row-income > div:nth-child(1) { grid-column: 1; }
  .table-container .row-income > div:nth-child(2) { grid-column: 2; }
  .table-container .row-income > div:nth-child(3) { grid-column: 3; }
  .table-container .row-income > div:nth-child(4) { grid-column: 4; }
  .table-container .row-income > div:nth-child(5) { grid-column: 5; }
  .table-container .row-income > div:nth-child(6) { grid-column: 6; }
  .table-container .row-income > div:nth-child(7) { grid-column: 7; }
  .table-container .row-income > div:nth-child(8) { grid-column: 8; }
  .table-container .row-income > div:nth-child(9) { grid-column: 9; }
  .table-container .row-income > div:nth-child(10) { grid-column: 10; }
  .table-container .row-income > div:nth-child(11) { grid-column: 11; }
  .table-container .row-income > div:nth-child(12) { grid-column: 12; }
  
  /* Adjust delete button for mobile */
  .table-container .row-income .delete-btn {
    width: 28px;
    height: 28px;
    margin-right: 6px;
  }
}

@media (max-width: 480px) {
  .table-container .row-head {
    padding: 0.3rem 0.2rem;
    gap: 0.25rem;
    font-size: 0.55rem;
  }
  
  .table-container .row-head.row-biz {
    grid-template-columns: 16px 24px 1fr 0.6fr 0.6fr 0.6fr 0.6fr 0.7fr 0.7fr 0.7fr 0.7fr 24px;
  }
  
  .table-container .row-head.row-income {
    grid-template-columns: 18px 28px 180px 130px 110px 110px 110px 130px 160px 100px 80px 28px;
    text-align: center;
    align-items: center;
  }
  
  /* Align specific header columns with their content - 480px */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: center; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  .table-container .row-head.row-income > div:nth-child(10) { text-align: center; } /* Progress */
  .table-container .row-head.row-income > div:nth-child(11) { text-align: left; } /* Payment */
  
  /* Ensure proper alignment on 480px screens for tags and date */
  .table-container .row-income > div:nth-child(4) {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
  }
  
  .table-container .row-income > div:nth-child(5) {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
  }
  
  /* 480px date input styling - positioned directly under DATE title */
  .table-container .row-income .date-input-minimal {
    padding: 0.4rem 0.6rem;
    font-size: 0.65rem;
    margin-left: 0;
    padding-left: 0;
    text-indent: 0;
  }
  
  .table-container .row-income > div:nth-child(5) {
    padding-left: 0;
    margin-left: 0;
    align-items: flex-start;
  }
  
  .table-container .row,
  .table-container .row-biz,
  .table-container .row-income {
    padding: 0.4rem 0.3rem;
  }
  
  /* Extra small screens - more compact income table */
  .table-container .row-income {
    grid-template-columns: 20px 30px 120px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    gap: 0.25rem;
    padding: 0.35rem 0.25rem 0.35rem 0.25rem;
    min-height: 36px;
    font-size: 0.65rem;
    white-space: nowrap;
  }
  
  /* Mobile progress button adjustments */
  .progress-toggle button {
    min-width: 45px;
    padding: 0.3rem 0.6rem;
    font-size: 0.65rem;
    border-radius: 4px;
  }
  
  .progress-toggle button:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);
  }
  
  .progress-toggle button:active {
    transform: translateY(0);
    box-shadow: 0 1px 4px rgba(99, 102, 241, 0.2);
  }
  
  /* Fixed widths for name and note inputs on 480px screens */
  .table-container .row-income > div:nth-child(3) input,
  .table-container .row-income > div:nth-child(10) input,
  .table-container .row-income > div:nth-child(10) textarea {
    min-width: 100% !important;
    width: 100% !important;
  }
  
  /* Ensure minimum widths for name and note on 480px screens */
  .table-container .row-income > div:nth-child(3) {
    min-width: 108px !important;
  }
  .table-container .row-income > div:nth-child(10) {
    min-width: 70px !important;
  }
  
  /* Ensure sticky name stays above tags - z-index on small screens */
  .table-container .row-income > div:nth-child(3) {
    z-index: 10 !important;
  }
  .table-container .row-income > div:nth-child(4) {
    z-index: 1 !important;
  }
  
  /* Adjust delete button for extra small screens */
  .table-container .row-income .delete-btn {
    width: 24px;
    height: 24px;
    margin-right: 4px;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 14px;
    height: 14px;
  }
}

/* Extra small screens - 320px and below */
@media (max-width: 320px) {
  .table-container .row-income {
    grid-template-columns: 16px 24px 96px 120px 100px 100px 100px 120px 140px 80px 60px 24px;
    gap: 0.3rem;
    padding: 0.3rem 0.2rem 0.3rem 0.2rem;
    min-height: 32px;
    font-size: 0.6rem;
    white-space: nowrap;
  }
  
  /* Ensure minimum widths for name and note on 320px screens */
  .table-container .row-income > div:nth-child(3) {
    min-width: 96px !important;
  }
  .table-container .row-income > div:nth-child(10) {
    min-width: 80px !important;
  }
  
  /* Fix all income inputs on very small screens */
  .table-container .row-income input {
    font-size: 0.7rem !important;
    min-height: 28px !important;
    padding: 0.4rem 0.6rem !important;
    line-height: 1.2 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
  }
  
  /* Fixed widths for name and note inputs on 320px screens */
  .table-container .row-income > div:nth-child(3) input,
  .table-container .row-income > div:nth-child(10) input,
  .table-container .row-income > div:nth-child(10) textarea {
    min-width: 100% !important;
    width: 100% !important;
  }
  
  /* Ensure sticky name stays above tags - z-index on 320px screens */
  .table-container .row-income > div:nth-child(3) {
    z-index: 10 !important;
  }
  .table-container .row-income > div:nth-child(4) {
    z-index: 1 !important;
  }
  
  /* Fix specific columns for very small screens */
  .table-container .row-income input[type="date"] {
    font-size: 0.65rem !important;
    min-height: 28px !important;
    padding: 0.3rem 0.5rem !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
  }
  
  .table-container .row-income .cost-input-wrapper,
  .table-container .row-income .financial-input-wrapper {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
    font-size: 0.65rem !important;
    padding: 0.3rem 0.5rem !important;
  }
  
  .table-container .row-income .cost-dollar-display,
  .table-container .row-income .financial-symbol {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    flex-shrink: 0 !important;
  }
  
  .table-container .row-income .delete-btn {
    width: 20px;
    height: 20px;
    margin-right: 3px;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 12px;
    height: 12px;
  }
  
  .table-container .row-head.row-income {
    grid-template-columns: 20px 30px 120px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    font-size: 0.5rem;
    text-align: center;
    align-items: center;
  }
  
  /* Align specific header columns with their content - 320px */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: center; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  
  /* Ensure proper alignment on 320px screens for tags and date */
  .table-container .row-income > div:nth-child(4) {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
  }
  
  .table-container .row-income > div:nth-child(5) {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
  }
  
  /* 320px date input styling - positioned directly under DATE title */
  .table-container .row-income .date-input-minimal {
    padding: 0.35rem 0.5rem;
    font-size: 0.6rem;
    margin-left: 0;
    padding-left: 0;
    text-indent: 0;
  }
  
  .table-container .row-income > div:nth-child(5) {
    padding-left: 0;
    margin-left: 0;
    align-items: flex-start;
  }
}

/* Smart responsive design for very small screens */
@media (max-width: 360px) {
  .table-container .row-income {
    grid-template-columns: 14px 22px 90px 110px 90px 90px 90px 110px 130px 80px 60px 22px;
    gap: 0.25rem;
    padding: 0.25rem 0.15rem 0.25rem 0.15rem;
    min-height: 30px;
    font-size: 0.55rem;
    white-space: nowrap;
  }
  
  /* Ensure minimum widths for name and note on 360px screens */
  .table-container .row-income > div:nth-child(3) {
    min-width: 90px !important;
  }
  .table-container .row-income > div:nth-child(10) {
    min-width: 80px !important;
  }
  
  /* Fix all income inputs on 360px screens */
  .table-container .row-income input {
    font-size: 0.65rem !important;
    min-height: 26px !important;
    padding: 0.3rem 0.5rem !important;
    line-height: 1.2 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
  }
  
  /* Fixed widths for name and note inputs on 360px screens */
  .table-container .row-income > div:nth-child(3) input,
  .table-container .row-income > div:nth-child(10) input,
  .table-container .row-income > div:nth-child(10) textarea {
    min-width: 100% !important;
    width: 100% !important;
  }
  
  /* Ensure sticky name stays above tags - z-index on 360px screens */
  .table-container .row-income > div:nth-child(3) {
    z-index: 10 !important;
  }
  .table-container .row-income > div:nth-child(4) {
    z-index: 1 !important;
  }
  
  /* Fix specific columns for 360px screens */
  .table-container .row-income input[type="date"] {
    font-size: 0.6rem !important;
    min-height: 26px !important;
    padding: 0.25rem 0.4rem !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
  }
  
  .table-container .row-income .cost-input-wrapper,
  .table-container .row-income .financial-input-wrapper {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
    font-size: 0.6rem !important;
    padding: 0.25rem 0.4rem !important;
  }
  
  .table-container .row-income .cost-dollar-display,
  .table-container .row-income .financial-symbol {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    flex-shrink: 0 !important;
  }
  
  .table-container .row-income .delete-btn {
    width: 18px;
    height: 18px;
    margin-right: 2px;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 10px;
    height: 10px;
  }
  
  .table-container .row-head.row-income {
    grid-template-columns: 20px 30px 120px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    font-size: 0.45rem;
    text-align: center;
    align-items: center;
  }
  
  /* Align specific header columns with their content - 360px */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: center; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  
  /* Ensure proper alignment on 360px screens for tags and date */
  .table-container .row-income > div:nth-child(4) {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
  }
  
  .table-container .row-income > div:nth-child(5) {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
  }
  
  /* 360px date input styling - positioned directly under DATE title */
  .table-container .row-income .date-input-minimal {
    padding: 0.35rem 0.5rem;
    font-size: 0.6rem;
    margin-left: 0;
    padding-left: 0;
    text-indent: 0;
  }
  
  .table-container .row-income > div:nth-child(5) {
    padding-left: 0;
    margin-left: 0;
    align-items: flex-start;
  }
}

/* Ultra-compact design for very small devices */
@media (max-width: 280px) {
  .table-container .row-income {
    grid-template-columns: 12px 20px 140px 100px 80px 80px 80px 100px 120px 80px 20px;
    gap: 0.2rem;
    padding: 0.2rem 0.1rem 0.2rem 0.1rem;
    min-height: 28px;
    font-size: 0.5rem;
    white-space: nowrap;
  }
  
  .table-container .row-income .delete-btn {
    width: 16px;
    height: 16px;
    margin-right: 1px;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 8px;
    height: 8px;
  }
  
  .table-container .row-head.row-income {
    grid-template-columns: 20px 30px 120px 150px 120px 120px 120px 140px 180px 100px 80px 30px;
    font-size: 0.4rem;
    text-align: center;
    align-items: center;
  }
  
  /* Align specific header columns with their content - 280px */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: left; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  
  /* Ensure proper alignment on 280px screens for tags and date */
  .table-container .row-income > div:nth-child(4),
  .table-container .row-income > div:nth-child(5) {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
  }
  
  /* 280px date input styling - positioned directly under DATE title */
  .table-container .row-income .date-input-minimal {
    padding: 0.3rem 0.4rem;
    font-size: 0.55rem;
    margin-left: 0;
    padding-left: 0;
    text-indent: 0;
  }
  
  .table-container .row-income > div:nth-child(5) {
    padding-left: 0;
    margin-left: 0;
    align-items: flex-start;
  }
}
.row-head{ 
  font-size:.6rem; 
  letter-spacing:.08em; 
  text-transform:uppercase; 
  font-weight:600; 
  color:var(--muted); 
  display:grid; 
  grid-template-columns:24px 32px 1.5fr .8fr .8fr .8fr 1fr 1fr 1fr 1fr 32px; 
  gap:.7rem; 
  align-items:center; 
  background:var(--glass); 
  position:relative; 
  backdrop-filter:blur(25px); 
  z-index:10; 
  padding:.5rem .4rem; 
  border-bottom:2px solid var(--stroke);
  transition:all .2s ease;
  margin:0;
  box-shadow:0 4px 16px rgba(0,0,0,0.2);
}

/* Perfect grid alignment for personal expenses header */
.row-head > div:nth-child(1) { grid-column: 1; } /* Empty */
.row-head > div:nth-child(2) { grid-column: 2; } /* Empty */
.row-head > div:nth-child(3) { 
  grid-column: 3; /* Name */
  position: sticky;
  left: 56px; /* 24px drag handle + 32px icon */
  background: var(--glass);
  z-index: 31 !important; /* Higher than row names to stay on top */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  min-width: 80px; /* Reduced width for name inputs */
  max-width: 120px; /* Maximum width to prevent excessive expansion */
  width: fit-content; /* Make background hug the content */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: box-shadow 0.2s ease;
}
.row-head > div:nth-child(4) { grid-column: 4; } /* Cost USD */
.row-head > div:nth-child(5) { grid-column: 5; } /* Status */
.row-head > div:nth-child(6) { grid-column: 6; } /* Billing */
.row-head > div:nth-child(7) { grid-column: 7; } /* Monthly USD */
.row-head > div:nth-child(8) { grid-column: 8; } /* Yearly USD */
.row-head > div:nth-child(9) { grid-column: 9; } /* Monthly EGP */
.row-head > div:nth-child(10) { grid-column: 10; } /* Yearly EGP */
.row-head > div:nth-child(11) { grid-column: 11; } /* Empty */
[data-theme="light"] .row-head {
  background:rgba(241, 245, 249, 0.9);
}
.row-head:hover{ 
  background:rgba(24,24,27,0.98); 
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
}
[data-theme="light"] .row-head:hover {
  background:rgba(241, 245, 249, 0.9);
}

.row-head.row-biz{ 
  grid-template-columns:24px 32px 1.4fr .8fr .8fr .8fr .8fr .9fr .9fr .9fr .9fr 32px; 
}

/* Perfect grid alignment for business expenses header */
.row-head.row-biz > div:nth-child(1) { grid-column: 1; } /* Empty */
.row-head.row-biz > div:nth-child(2) { grid-column: 2; } /* Empty */
.row-head.row-biz > div:nth-child(3) { 
  grid-column: 3; /* Name */
  position: sticky;
  left: 56px; /* 24px drag handle + 32px icon */
  background: var(--glass);
  z-index: 31 !important; /* Higher than row names to stay on top */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  min-width: 80px; /* Reduced width for name inputs */
  max-width: 120px; /* Maximum width to prevent excessive expansion */
  width: fit-content; /* Make background hug the content */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: box-shadow 0.2s ease;
}
.row-head.row-biz > div:nth-child(4) { grid-column: 4; } /* Cost USD */
.row-head.row-biz > div:nth-child(5) { grid-column: 5; } /* Status */
.row-head.row-biz > div:nth-child(6) { grid-column: 6; } /* Billing */
.row-head.row-biz > div:nth-child(7) { grid-column: 7; } /* Next */
.row-head.row-biz > div:nth-child(8) { grid-column: 8; } /* Monthly USD */
.row-head.row-biz > div:nth-child(9) { grid-column: 9; } /* Yearly USD */
.row-head.row-biz > div:nth-child(10) { grid-column: 10; } /* Monthly EGP */
.row-head.row-biz > div:nth-child(11) { grid-column: 11; } /* Yearly EGP */
.row-head.row-biz > div:nth-child(12) { grid-column: 12; } /* Empty */

.row-head.row-income{ 
  grid-template-columns:20px 28px 108px 1.2fr 100px 100px 100px 120px 1fr 100px 120px 28px; 
}

/* Perfect grid alignment for income header */
.row-head.row-income > div:nth-child(1) { grid-column: 1; } /* Empty */
.row-head.row-income > div:nth-child(2) { grid-column: 2; } /* Empty */
.row-head.row-income > div:nth-child(3) { 
  grid-column: 3; /* Project Name */
  position: sticky;
  left: 28px; /* 28px icon (spacer is empty, no width) */
  background: var(--glass); /* Header keeps background for visibility */
  z-index: 31 !important; /* Higher than row names to stay on top */
  padding: 0;
  margin: 0;
  text-align: left;
  justify-content: flex-start;
  width: fit-content; /* Make background hug the content */
  max-width: 100%; /* Ensure it doesn't exceed grid column width */
  box-shadow: none; /* No shadow initially - will appear on scroll */
  transition: box-shadow 0.2s ease;
}
.row-head.row-income > div:nth-child(4) { grid-column: 4; } /* Tags */
.row-head.row-income > div:nth-child(5) { grid-column: 5; } /* Date */
.row-head.row-income > div:nth-child(6) { grid-column: 6; } /* All Payment */
.row-head.row-income > div:nth-child(7) { grid-column: 7; } /* Paid USD */
.row-head.row-income > div:nth-child(8) { grid-column: 8; } /* Paid EGP */
.row-head.row-income > div:nth-child(9) { grid-column: 9; } /* Method */
.row-head.row-income > div:nth-child(10) { grid-column: 10; } /* Progress */
.row-head.row-income > div:nth-child(11) { grid-column: 11; } /* Payment */
.row-head.row-income > div:nth-child(12) { grid-column: 12; } /* Empty */

/* Sticky section headers */
 .sticky-header {
   position: relative;
   z-index: 10;
   background: var(--bg);
   padding: 1rem 0 0.5rem 0;
   margin-bottom: 1rem;
   border-bottom: 1px solid var(--stroke);
   backdrop-filter: blur(10px);
 }

 /* Sticky table headers - floating header that appears on scroll */
 .table-header-sticky {
   position: fixed;
   top: 0;
   left: 0;
   right: 0;
   z-index: 1000;
   background: var(--card) !important;
   backdrop-filter: blur(20px);
   border-bottom: 1px solid var(--stroke);
   font-size: 0.65rem;
   font-weight: 600;
   text-transform: uppercase;
   letter-spacing: 0.025em;
   padding: 0.4rem 0.5rem;
   margin: 0;
   transition: all 0.3s ease;
   box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
   display: grid;
   align-items: center;
   gap: 0.5rem;
   min-height: 32px;
   color: var(--muted);
   opacity: 0;
   visibility: hidden;
   transform: translateY(-10px);
 }

 .table-header-sticky.show {
   opacity: 1;
   visibility: visible;
   transform: translateY(0);
 }

 /* Personal expenses sticky header */
 .table-header-sticky.personal-header {
   grid-template-columns: 24px 32px 1.5fr .8fr .8fr .8fr 1fr 1fr 1fr 1fr 32px;
 }

 /* Business expenses sticky header */
 .table-header-sticky.biz-header {
   grid-template-columns: 24px 32px 1.4fr .8fr .8fr .8fr .8fr .9fr .9fr .9fr .9fr 32px;
 }

 /* Income sticky header */
 .table-header-sticky.income-header {
   grid-template-columns: 20px 28px 108px 1.2fr 100px 100px 100px 120px 1fr 100px 120px 28px;
 }
.row-sum{ 
  font-weight:600; 
  background:var(--card); 
  font-size:.75rem; 
  border-top:1px solid var(--stroke); 
  color:var(--fg);
  border-bottom:none;
}

/* Light mode sum row backgrounds */
[data-theme="light"] .row-sum {
  background: rgba(248, 250, 252, 0.8);
}

/* Mobile sticky name positioning */
@media (max-width: 768px) {
  .row > div:nth-child(3),
  .row-biz > div:nth-child(3) {
    left: 48px; /* Slightly reduced for mobile */
    background: var(--card);
    text-align: left;
    justify-content: flex-start;
    padding: 0;
    margin: 0;
    min-width: 80px; /* Reduced width for name inputs */
    max-width: 120px; /* Maximum width to prevent excessive expansion */
    z-index: 30 !important; /* Ensure it stays above everything on mobile */
    width: fit-content; /* Make background hug the content */
    box-shadow: none; /* No shadow initially - will appear on scroll */
    transition: box-shadow 0.2s ease;
  }
  
  .row-income > div:nth-child(3) {
    left: 40px; /* Adjusted for income table mobile layout */
    background: transparent;
    text-align: left;
    justify-content: flex-start;
    padding: 0;
    margin: 0;
    z-index: 30 !important; /* Ensure it stays above everything on mobile */
    width: fit-content; /* Make background hug the content */
    max-width: 100%; /* Ensure it doesn't exceed grid column width */
    box-shadow: none; /* No shadow initially - will appear on scroll */
    transition: background 0.2s ease, box-shadow 0.2s ease;
  }
  
  /* Show background on row hover for mobile */
  .row-income:hover > div:nth-child(3) {
    background: var(--card);
  }
  
  .row-head > div:nth-child(3),
  .row-head.row-biz > div:nth-child(3) {
    left: 48px; /* Header sticky positioning for mobile */
    background: var(--glass);
    text-align: left;
    justify-content: flex-start;
    padding: 0;
    margin: 0;
    min-width: 80px; /* Reduced width for name inputs */
    max-width: 120px; /* Maximum width to prevent excessive expansion */
    z-index: 31 !important; /* Even higher for header to stay above row names */
    width: fit-content; /* Make background hug the content */
    box-shadow: none; /* No shadow initially - will appear on scroll */
    transition: box-shadow 0.2s ease;
  }
  
  .row-head.row-income > div:nth-child(3) {
    left: 40px; /* Income header sticky positioning for mobile */
    background: var(--glass);
    text-align: left;
    justify-content: flex-start;
    padding: 0;
    margin: 0;
    z-index: 31 !important; /* Even higher for header to stay above row names */
    width: fit-content; /* Make background hug the content */
    max-width: 100%; /* Ensure it doesn't exceed grid column width */
    box-shadow: none; /* No shadow initially - will appear on scroll */
    transition: box-shadow 0.2s ease;
  }
}

/* Show shadow on sticky name columns ONLY when table is scrolled horizontally */
/* Modern, subtle shadow - appears only when scrolling */
.table-container.scrolled .row > div:nth-child(3),
.table-container.scrolled .row-biz > div:nth-child(3),
.table-container.scrolled .row-income > div:nth-child(3),
.table-container.scrolled .row-head > div:nth-child(3),
.table-container.scrolled .row-head.row-biz > div:nth-child(3),
.table-container.scrolled .row-head.row-income > div:nth-child(3) {
  box-shadow: 1px 0 3px rgba(0, 0, 0, 0.08);
}

/* Light mode - even more subtle shadow */
[data-theme="light"] .table-container.scrolled .row > div:nth-child(3),
[data-theme="light"] .table-container.scrolled .row-biz > div:nth-child(3),
[data-theme="light"] .table-container.scrolled .row-income > div:nth-child(3),
[data-theme="light"] .table-container.scrolled .row-head > div:nth-child(3),
[data-theme="light"] .table-container.scrolled .row-head.row-biz > div:nth-child(3),
[data-theme="light"] .table-container.scrolled .row-head.row-income > div:nth-child(3) {
  box-shadow: 1px 0 2px rgba(0, 0, 0, 0.03);
}

/* Minimal drag and drop styles */
.draggable-header{ 
  cursor:grab; 
  user-select:none; 
  transition:all .2s ease; 
  border-radius:4px;
}
.draggable-header:hover{ 
  background:var(--glass); 
  transform:translateY(-1px);
}
.draggable-header:active{ cursor:grabbing; }
.draggable-header.dragging{ opacity:0.4; transform:rotate(1deg); }
.drop-zone{ position:relative; }
.drop-zone.drag-over::before{ 
  content:''; 
  position:absolute; 
  top:0; 
  left:-2px; 
  right:-2px; 
  bottom:0; 
  background:rgba(255, 255, 255, 0.05); 
  border-radius:4px; 
  z-index:1; 
}
.financial-column{ position:relative; }

/* Add space between currency symbols and numbers */
.financial-input-wrapper .financial-symbol {
  margin-right: 0.25rem;
}

/* Income table cell alignment - ensure proper alignment for tags and date */
.table-container .row-income > div:nth-child(4) { 
  display: flex; 
  justify-content: flex-start; 
  align-items: center; 
  text-align: left;
} /* Tags column */

.table-container .row-income > div:nth-child(5) { 
  display: flex; 
  justify-content: flex-start; 
  align-items: center; 
  text-align: left;
  position: relative;
} /* Date column */

/* Ensure date input is perfectly aligned without icon */
.table-container .row-income .date-input-minimal {
  text-align: left;
  margin: 0;
  padding: 0.5rem 0.75rem; /* Normal padding without icon space */
  width: 100%;
  box-sizing: border-box;
}

/* Date input container positioning */
.table-container .row-income > div:nth-child(5) {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

/* Perfect date alignment - position date input directly under DATE title */
.table-container .row-income > div:nth-child(5) .date-input-minimal {
  text-align: left;
  margin: 0;
  padding: 0.5rem 0.75rem;
  width: 100%;
  box-sizing: border-box;
  border: none;
  background: transparent;
  color: var(--fg);
  font-size: 0.7rem;
  position: relative;
  left: 0;
  transform: none;
}

/* Force date input to align exactly with DATE header text */
.table-container .row-income > div:nth-child(5) {
  position: relative;
  display: flex;
  align-items: flex-start;
  justify-content: flex-start;
  padding-left: 0;
  margin-left: 0;
}

/* Ensure date input starts exactly where DATE header starts */
/* Date input styling is handled by the minimal date display above */

/* Ensure tag wrapper is properly aligned */
.table-container .row-income .tag-input-wrapper {
  justify-content: flex-start;
  align-items: center;
  width: 100%;
}

/* Tag input styling */
.table-container .row-income .tag-input {
  text-align: left;
  width: 100%;
}

/* Row drag and drop styles */
.row-draggable{ 
  user-select:none; 
  transition:all .2s ease; 
  position:relative;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.row-draggable:hover{ 
  background:var(--glass); 
  transform:translateY(-1px);
}
.row-draggable.dragging{ 
  opacity:0.4; 
  transform:rotate(1deg) scale(1.02);
  z-index:1000;
  box-shadow:0 8px 25px rgba(0,0,0,.3);
}
.row-drop-zone{ 
  position:relative; 
  transition:all .2s ease;
}
.row-drop-zone.drag-over::before{ 
  content:''; 
  position:absolute; 
  top:-2px; 
  left:0; 
  right:0; 
  height:4px; 
  background:linear-gradient(90deg, #3b82f6, #8b5cf6); 
  border-radius:2px; 
  z-index:10;
  animation:pulse 1s infinite;
}
.row-drop-zone.drag-over::after{ 
  content:''; 
  position:absolute; 
  top:-2px; 
  left:0; 
  right:0; 
  height:4px; 
  background:rgba(59, 130, 246, 0.3); 
  border-radius:2px; 
  z-index:9;
}
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}
.drag-handle{ 
  display:flex; 
  align-items:center; 
  justify-content:center; 
  width:20px; 
  height:20px; 
  color:var(--muted); 
  cursor:grab;
  transition:all .2s ease;
  border-radius:4px;
}
.drag-handle:hover{ 
  color:var(--fg); 
  background:var(--glass);
  transform:scale(1.1);
}
.drag-handle:active{ 
  cursor:grabbing; 
  transform:scale(0.95);
}

/* Hide drag handle for income table but preserve space */
.drag-handle-hidden {
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Empty spacer div for income table (replaces drag handle) */
.row-income .spacer {
  width: 20px;
  min-width: 20px;
  max-width: 20px;
}

/* Improved Untitled UI Date Picker Styles */
.untitled-date-picker {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  overflow: hidden;
  contain: layout;
}

.untitled-date-input {
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  background: transparent !important;
  color: var(--fg) !important;
  font-size: 0.7rem !important;
  padding: 0.4rem 1.8rem 0.4rem 0.6rem !important;
  text-align: left !important;
  cursor: pointer !important;
  border-radius: 6px !important;
  transition: all 0.2s ease !important;
  position: relative !important;
  z-index: 1 !important;
  font-family: inherit !important;
  font-weight: 400 !important;
  pointer-events: auto !important;
  user-select: none !important;
}

.untitled-date-input:hover {
  background: var(--glass) !important;
}

.untitled-date-input:focus {
  outline: none !important;
  background: var(--glass) !important;
  box-shadow: 0 0 0 2px var(--primary) !important;
}

.calendar-icon {
  position: absolute !important;
  right: 0.5rem !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  color: var(--muted) !important;
  transition: color 0.2s ease !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  pointer-events: none !important;
  z-index: 2 !important;
}

.untitled-date-input:hover + .calendar-icon,
.untitled-date-input:focus + .calendar-icon {
  color: var(--primary) !important;
}

/* Hide the default date picker icon but keep functionality */
.untitled-date-input::-webkit-calendar-picker-indicator {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  width: 0 !important;
  height: 0 !important;
  position: absolute !important;
  right: -9999px !important;
}

/* Ensure date input is fully functional */
.untitled-date-input {
  pointer-events: auto !important;
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
}

/* Force date input to be clickable */
.untitled-date-input:not([disabled]) {
  cursor: pointer !important;
  pointer-events: auto !important;
}

/* Ensure date picker doesn't interfere with rows below */
.untitled-date-picker {
  overflow: hidden;
  contain: layout;
  isolation: isolate;
}

/* Prevent date picker from affecting layout */
.untitled-date-picker input[type="date"] {
  position: relative !important;
  z-index: 1 !important;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .untitled-date-input {
    font-size: 0.65rem !important;
    padding: 0.3rem 1.5rem 0.3rem 0.4rem !important;
  }
  
  .calendar-icon {
    right: 0.3rem !important;
  }
  
  .calendar-icon svg {
    width: 10px !important;
    height: 10px !important;
  }
}

/* Prevent text selection during drag */
.row-draggable.dragging * {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.table-scroll{ overflow-x:auto; }
.table{ 
  min-width:auto; 
  width:100%; 
  background:var(--card); 
  border-radius:12px; 
  overflow:hidden;
  backdrop-filter:blur(10px);
  border:none;
}

/* Hide horizontal scroll on desktop */
@media (min-width: 1024px) {
  .table-scroll{ overflow-x:visible; }
}

/* Responsive table adjustments */
@media (max-width: 768px) {
  .row{ gap:.2rem; padding:.3rem; }
  .row-biz{ gap:.2rem; padding:.3rem; }
  .row-income{ 
    gap:.5rem; 
    padding:.4rem .4rem; 
    grid-template-columns: 20px 30px 200px 150px 120px 120px 120px 140px 180px 60px 80px 30px;
    white-space: nowrap;
  }
  
  .nav-btn {
    padding: 0.5rem 0.8rem;
    font-size: 0.75rem;
    gap: 0.4rem;
    min-height: 36px;
    border-radius: 0.5rem;
  }
  
  .nav-btn svg {
    width: 0.8rem;
    height: 0.8rem;
  }
}

@media (max-width: 480px) {
  .row-income{ 
    gap:.25rem; 
    padding:.35rem .25rem; 
    grid-template-columns: 18px 28px 180px 130px 110px 110px 110px 130px 160px 70px 50px 28px;
    font-size: 0.65rem;
    white-space: nowrap;
  }
  
  /* Fix project name inputs on mobile */
  .row-income input[type="text"] {
    font-size: 0.75rem !important;
    min-height: 32px !important;
    padding: 0.5rem 0.75rem !important;
    line-height: 1.3 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
  }
  
  .row-income input[type="text"]:focus {
    background: transparent !important;
    outline: none !important;
  }
  
  .nav-btn {
    padding: 0.4rem 0.6rem;
    font-size: 0.7rem;
    gap: 0.3rem;
    min-height: 32px;
    border-radius: 0.4rem;
  }
}

.icon-cell button{ width:32px; height:32px; border:none; border-radius:8px; background:transparent; color:var(--fg); cursor:pointer; display:flex; align-items:center; justify-content:center; }
.icon-cell button:hover{ background:var(--glass); }
.icon-cell i{ color:inherit; font-size:.9rem; }
.icon-cell img{ 
  width:16px; 
  height:16px; 
  object-fit:contain; 
}
.delete-confirm{ background:#ef4444; color:white; font-size:.6rem; padding:.2rem .4rem; border-radius:.3rem; border:none; margin-right:.5rem; }
.delete-confirm:hover{ background:#dc2626; }

/* Modern minimal delete button */
.delete-btn{ 
  width:32px; 
  height:32px; 
  border:none; 
  border-radius:.5rem; 
  background:transparent; 
  color:var(--muted); 
  cursor:pointer; 
  display:flex; 
  align-items:center; 
  justify-content:center;
  transition:all .2s ease;
  margin-left:auto;
  margin-right:8px;
}
.delete-btn:hover{ 
  background:rgba(239, 68, 68, 0.1); 
  color:#ef4444;
  transform:scale(1.05);
}
.delete-btn:active{ 
  transform:scale(0.95);
}


/* Icon picker redesigned UI */
.icon-tile{ 
  display:flex; 
  align-items:center; 
  justify-content:center; 
  width:44px; 
  height:44px; 
  border:1px solid var(--stroke); 
  border-radius:.75rem; 
  background:var(--card); 
  transition:all .2s ease; 
  cursor:pointer;
  color:var(--fg);
}
.icon-tile:hover{ 
  transform:translateY(-2px); 
  box-shadow:0 8px 25px rgba(99,102,241,.15);
  background:var(--glass);
  border-color:var(--muted);
}
.icon-tile i{ 
  color:inherit; 
  font-size:16px;
}
.icon-tile img{
  width:20px;
  height:20px;
  object-fit:contain;
  filter: invert(1);
}
[data-theme="light"] .icon-tile img{
  filter: invert(0);
}

/* Custom icon container with delete button */
.custom-icon-container {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.custom-icon-delete {
  position: absolute;
  top: -4px;
  right: -4px;
  width: 14px;
  height: 14px;
  border: none;
  border-radius: 50%;
  background: #ef4444;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.2s ease;
  z-index: 10;
}

.icon-tile:hover .custom-icon-delete {
  opacity: 1;
}

.custom-icon-delete:hover {
  background: #dc2626;
}

.custom-icon-delete svg {
  width: 8px;
  height: 8px;
}

/* Financial Health Score Color Coding */
.value[data-health="excellent"] {
  color: #6366f1 !important; /* Purple */
}

.value[data-health="good"] {
  color: #3b82f6 !important; /* Blue */
}

.value[data-health="fair"] {
  color: #f59e0b !important; /* Yellow */
}

.value[data-health="poor"] {
  color: #f97316 !important; /* Orange */
}

.value[data-health="critical"] {
  color: #ef4444 !important; /* Red */
}
.icon-tile.selected{ 
  border-color:#6366f1; 
  background:rgba(99,102,241,.1);
  box-shadow:0 4px 15px rgba(99,102,241,.2);
}
.tab-btn{ 
  padding:.6rem 1.2rem; 
  border:none; 
  background:transparent; 
  color:var(--muted); 
  font-size:.85rem; 
  font-weight:600; 
  border-bottom:2px solid transparent; 
  transition:all .2s ease; 
  border-radius:.5rem .5rem 0 0;
  position:relative;
}
.tab-btn:hover{ 
  color:var(--fg); 
  background:var(--glass);
}
.tab-btn.active{ 
  color:var(--fg); 
  border-bottom-color:#6366f1; 
  background:var(--glass);
}
.tab-btn.active::after{
  content:'';
  position:absolute;
  bottom:-2px;
  left:50%;
  transform:translateX(-50%);
  width:20px;
  height:2px;
  background:#6366f1;
  border-radius:1px;
}
#glyphInput{
  font-family:monospace;
  text-transform:lowercase;
}

  /* Modern Notification Center - Typing Animation */
  .notification-center {
    position: absolute;
    z-index: 9999;
    transition: all 0.3s ease;
    pointer-events: none;
    opacity: 0;
    margin-top: 0;
    width: auto;
    height: auto;
    white-space: nowrap;
    /* Position will be calculated dynamically by JavaScript */
  }
  
  /* No background - just text */
  .notification-text {
    font-size: 0.75rem;
    font-weight: 500;
    line-height: 1.2;
    text-align: center;
    white-space: nowrap;
    letter-spacing: 0.02em;
    margin: 0;
    padding: 0;
    word-wrap: break-word;
    max-width: none;
    /* Smooth typing effect */
    overflow: hidden;
  }

/* Simple notification types - just text colors */
.notification-center.success .notification-text {
  color: #6366f1;
}

.notification-center.error .notification-text {
  color: #ef4444;
}

.notification-center.warning .notification-text {
  color: #f59e0b;
}

.notification-center.info .notification-text {
  color: #3b82f6;
}

.notification-center.save .notification-text {
  color: #8b5cf6;
}

.notification-center.show {
  opacity: 1;
  transform: translateX(-50%) translateY(-50%) translateX(0);
}

.notification-center.hide {
  opacity: 0;
  transform: translateX(-50%) translateY(-50%) translateX(20px);
}

/* Ensure notification doesn't overlap with buttons */
header {
  position: relative;
}

/* Desktop positioning - will be overridden by JavaScript for perfect placement */
@media (min-width: 769px) {
  .notification-center {
    top: 50%;
    transform: translate(-50%, -50%) translateX(20px);
  }
  
  .notification-center.show {
    transform: translate(-50%, -50%) translateX(0);
  }
  
  .notification-center.hide {
    transform: translate(-50%, -50%) translateX(20px);
  }
}

/* Responsive positioning for small screens */
@media (max-width: 768px) {
  .notification-center {
    /* Position will be calculated dynamically by JavaScript */
    position: absolute;
    z-index: 9999;
    width: auto;
    max-width: calc(100vw - 2rem);
    text-align: center;
  }
  
  .notification-center.show {
    /* Transform handled by JavaScript for perfect positioning */
  }
  
  .notification-center.hide {
    /* Transform handled by JavaScript */
  }
  
  .notification-text {
    font-size: 0.7rem;
    white-space: normal;
    word-wrap: break-word;
    max-width: 280px;
  }
}

/* Header logo styling */
header img {
  height: 2.5rem;
  width: auto;
  transition: all 0.2s ease;
  filter: invert(0); /* default: preserve original */
}

header img:hover {
  transform: scale(1.05);
}

/* Light mode - invert white SVG to dark for visibility */
[data-theme="light"] header img:not(#userPhoto) { filter: invert(1) !important; }
/* Ensure dark mode keeps original white */
[data-theme="dark"] header img:not(#userPhoto) { filter: invert(0) !important; }

/* Mobile logo improvements - SVG logo primary everywhere */
@media (max-width: 768px) {
  header img {
    height: 2.3rem; /* 15% bigger than 2rem (2 * 1.15 = 2.3) */
    max-width: 100%;
    object-fit: contain;
    display: block;
  }
}

@media (max-width: 480px) {
  header img {
    height: 1.75rem;
    display: block;
    width: auto;
  }
  
  /* Extra small mobile currency dropdown */
  #currencyDropdown {
    width: 180px !important;
    max-width: 85vw !important;
    right: 50% !important;
    transform: translateX(50%) !important;
  }
  
  #btnCurrency {
    min-width: 45px !important;
    padding: 0 4px !important;
  }
  
  #currencySymbol {
    font-size: 0.65rem !important;
  }
  
  .currency-option {
    padding: 0.6rem 0.4rem !important;
    font-size: 0.75rem !important;
  }
  
  .currency-option span:first-child {
    font-size: 0.7rem !important;
  }
  
  .currency-option span:last-child {
    font-size: 0.65rem !important;
  }
}

/* Mobile Bottom Navigation - Super Compact */
.mobile-bottom-nav {
  display: none;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--bg);
  border-top: 1px solid var(--stroke);
  padding: 8px 16px 12px;
  z-index: 9999; /* Higher z-index to ensure it stays on top */
  backdrop-filter: blur(10px);
  /* Ensure it stays within viewport */
  max-width: 100vw;
  box-sizing: border-box;
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
  justify-content: space-around;
  align-items: center;
  gap: 8px;
  /* Ensure it's always visible and properly positioned */
  width: 100%;
  height: auto;
  min-height: 60px;
  /* Force hardware acceleration for smooth performance */
  transform: translateZ(0);
  will-change: transform;
    /* Enhanced safe area handling for system navigation bars */
    bottom: max(env(safe-area-inset-bottom, 0), 40px);
    padding-bottom: max(50px, calc(env(safe-area-inset-bottom, 0) + 40px));
}

.mobile-nav-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.25rem;
  padding: 0.5rem 0.25rem;
  border: none;
  background: transparent;
  color: var(--muted);
  font-size: 0.65rem;
  font-weight: 500;
  border-radius: 0.5rem;
  transition: all 0.2s ease;
  flex: 1;
  min-height: 56px;
  cursor: pointer;
  /* Ensure buttons are touch-friendly and properly sized */
  min-width: 60px;
  max-width: 120px;
  touch-action: manipulation;
}

.mobile-nav-btn:hover {
  color: var(--fg);
  background: rgba(var(--primary-rgb), 0.05);
}

.mobile-nav-btn.active {
  color: var(--primary);
  background: rgba(var(--primary-rgb), 0.1);
}

.mobile-nav-btn .nav-icon {
  width: 1.25rem;
  height: 1.25rem;
}

.mobile-nav-btn .nav-label {
  font-size: 0.6rem;
  line-height: 1;
  font-weight: 500;
}


/* Show mobile nav only on mobile */
@media (max-width: 768px) {
  .mobile-bottom-nav {
    display: flex !important;
    /* Enhanced safe area handling for all mobile devices */
    bottom: max(env(safe-area-inset-bottom, 0), 40px) !important;
    /* Generous padding to prevent system navbar overlap (iOS/Android) */
    padding-bottom: max(50px, calc(env(safe-area-inset-bottom, 0) + 40px)) !important;
    /* Force visibility and proper positioning */
    position: fixed !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    z-index: 9999 !important; /* Higher z-index to ensure it stays on top */
    /* Ensure it's always visible and sticky */
    transform: translateZ(0) !important;
    will-change: transform !important;
    /* Additional Android WebView compatibility */
    -webkit-transform: translateZ(0) !important;
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
  }
  
  /* Add bottom padding to main content to account for mobile nav */
  #mainContent {
    padding-bottom: calc(7rem + max(env(safe-area-inset-bottom, 0), 40px)) !important; /* Account for safe area and system navbar */
    /* Ensure content doesn't get hidden behind the sticky toolbar */
    margin-bottom: 0;
    /* Additional Android WebView compatibility */
    min-height: calc(100vh - max(env(safe-area-inset-bottom, 0), 40px));
  }
  
  /* Allow horizontal scroll for tables on mobile */
  body {
    max-width: 100vw;
  }
  
  /* Ensure mobile nav buttons fit properly */
  .mobile-nav-btn {
    flex: 1;
    min-width: 0; /* Allow flex items to shrink */
    max-width: calc(33.333% - 8px); /* 3 buttons with gaps */
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    /* Ensure proper touch targets */
    min-height: 48px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  
  /* Add extra spacing after total rows on mobile */
  .row-sum {
    margin-bottom: 2rem !important; /* Extra space after total rows */
  }
  
  /* Add extra spacing to the last table container on each page */
  .table-container:last-child {
    margin-bottom: 3rem !important; /* Extra space after last table */
  }
  
  /* Enhanced mobile table scrolling */
  .table-container {
    /* Ensure smooth horizontal scrolling on mobile */
    scroll-snap-type: x mandatory;
    scroll-padding: 0;
    /* Add momentum scrolling for iOS */
    -webkit-overflow-scrolling: touch;
    /* Ensure proper touch targets */
    touch-action: pan-x pan-y;
  }
  
  /* Add scroll snap points for better mobile experience */
  .table-container .row-head,
  .table-container .row,
  .table-container .row-biz,
  .table-container .row-income {
    scroll-snap-align: start;
  }
  
  /* Ensure page content has proper bottom spacing */
  .page-content {
    padding-bottom: 1rem;
  }
  
  /* Specific spacing for analytics page sections */
  .analytics-section:last-child {
    margin-bottom: 3rem !important; /* Extra space after last analytics section */
  }
  
  /* Improve mobile table accessibility */
  .table-container {
    /* Add visual scroll indicators */
    border: 1px solid var(--stroke);
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
  }
  
  /* Ensure table rows are properly spaced on mobile */
  .table-container .row,
  .table-container .row-biz,
  .table-container .row-income {
    /* Add better spacing between rows */
    margin-bottom: 1px;
    /* Ensure proper touch targets */
    min-height: 44px;
  }
  
  /* Improve mobile table header visibility */
  .table-container .row-head {
    position: sticky;
    top: 0;
    z-index: 10;
    background: transparent;
    border-bottom: 2px solid var(--stroke);
  }
}

/* Hide mobile nav on larger screens */
@media (min-width: 769px) {
  .mobile-bottom-nav {
    display: none !important;
  }
  
  #mainContent {
    padding-bottom: 1.5rem;
  }
}

/* Additional mobile navigation fixes for better visibility */
@media (max-width: 768px) {
  /* Ensure mobile nav is always visible */
  .mobile-bottom-nav {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    /* Enhanced safe area handling for all mobile devices */
    position: fixed !important;
    bottom: max(env(safe-area-inset-bottom, 0), 40px) !important;
    /* Generous padding to prevent system navbar overlap */
    padding-bottom: max(50px, calc(env(safe-area-inset-bottom, 0) + 40px)) !important;
    /* Ensure it's above system UI */
    z-index: 99999 !important;
    /* Prevent system navbar overlap */
    margin-bottom: 0 !important;
    /* Force hardware acceleration for Android */
    -webkit-transform: translate3d(0, 0, 0) !important;
    transform: translate3d(0, 0, 0) !important;
    /* Smooth transition when hiding/showing */
    transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s ease !important;
  }
  
  /* Hide navbar when keyboard is open */
  .mobile-bottom-nav.keyboard-open {
    transform: translateY(100%) !important;
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
  
  /* Android WebView specific styles */
  .mobile-bottom-nav.android-webview {
    bottom: 40px !important;
    padding-bottom: max(50px, calc(env(safe-area-inset-bottom, 0) + 40px)) !important;
    z-index: 99999 !important;
    position: fixed !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    /* Ensure it stays above Android system UI */
    -webkit-transform: translate3d(0, 0, 0) !important;
    transform: translate3d(0, 0, 0) !important;
    /* Force hardware acceleration */
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
    /* Prevent Android navbar overlap */
    margin-bottom: 0 !important;
    /* Ensure proper touch targets */
    min-height: 70px !important;
  }
  
  /* Improve mobile nav button spacing */
  .mobile-bottom-nav {
    gap: 4px;
    padding-left: 12px !important;
    padding-right: 12px !important;
    /* Padding bottom is handled above with enhanced safe area */
    padding-top: 8px !important;
  }
  
  /* Ensure proper button sizing on very small screens */
  @media (max-width: 480px) {
    .mobile-nav-btn {
      padding: 0.4rem 0.2rem;
      font-size: 0.6rem;
    }
    
    .mobile-nav-btn .nav-icon {
      width: 1.1rem;
      height: 1.1rem;
    }
    
    .mobile-nav-btn .nav-label {
      font-size: 0.55rem;
    }
  }
}

/* Mobile Header Icons - Make them bigger and more touch-friendly */
@media (max-width: 768px) {
  /* Hide desktop navigation buttons on mobile */
  .nav-btn {
    display: none !important;
  }
  
  /* Mobile currency dropdown improvements */
  #currencyDropdown {
    right: 50% !important;
    left: auto !important;
    width: 200px !important;
    max-width: 90vw !important;
    transform: translateX(50%) !important;
    z-index: 1000 !important;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3) !important;
  }
  
  /* Mobile currency button improvements */
  #btnCurrency {
    min-width: 50px !important;
    padding: 0 6px !important;
  }
  
  #currencySymbol {
    font-size: 0.7rem !important;
  }
  
  /* Mobile currency options */
  .currency-option {
    padding: 0.75rem 0.5rem !important;
    font-size: 0.8rem !important;
  }
  
  .currency-option span:first-child {
    font-size: 0.75rem !important;
    font-weight: 600 !important;
  }
  
  .currency-option span:last-child {
    font-size: 0.7rem !important;
  }
  
  /* Better touch targets for mobile */
  .currency-option {
    min-height: 44px !important;
    display: flex !important;
    align-items: center !important;
  }
  
  /* Show sign-in button on mobile */
  #btnSignIn {
    display: flex !important;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    background: var(--accent);
    color: white;
    border-radius: 0.5rem;
    border: none;
    gap: 0.5rem;
    align-items: center;
    justify-content: center;
    min-height: 2.5rem;
    font-weight: 500;
  }
  
  #btnSignIn:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
  }
  
  /* Center the header content vertically */
  header {
    flex-direction: column !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 1rem 0 !important;
  }
  
  /* Make logo bigger and center it */
  header img {
    display: block !important;
    height: 2.3rem !important; /* 15% bigger than 2rem */
    width: auto !important;
    margin: 0 auto !important;
  }
  
  /* Center the icon buttons below the logo */
  header .flex.items-center.gap-2.relative {
    justify-content: center !important;
    width: 100% !important;
  }
  
  /* Make header icon buttons bigger on mobile - 25% scale up */
  .icon-btn {
    width: 3.125rem !important; /* 2.5rem * 1.25 = 3.125rem */
    height: 3.125rem !important;
    min-width: 3.125rem !important;
    min-height: 3.125rem !important;
    font-size: 1.25rem !important; /* Also scale up font size */
  }
  
  /* Make icons inside buttons bigger - 25% scale up */
  .icon-btn svg {
    width: 1.5625rem !important; /* 1.25rem * 1.25 = 1.5625rem */
    height: 1.5625rem !important;
  }
  
  /* Make refresh button icon bigger - 25% scale up */
  #iconRefresh {
    width: 1.5625rem !important; /* 1.25rem * 1.25 = 1.5625rem */
    height: 1.5625rem !important;
  }
  
  /* Make lock button icon bigger - 25% scale up */
  #iconLock {
    width: 1.5625rem !important; /* 1.25rem * 1.25 = 1.5625rem */
    height: 1.5625rem !important;
  }
  
  /* Make theme button icon bigger - 25% scale up */
  #iconTheme {
    width: 1.5625rem !important; /* 1.25rem * 1.25 = 1.5625rem */
    height: 1.5625rem !important;
  }
  
  /* Make settings button icon bigger - 25% scale up */
  #btnSettings svg {
    width: 1.5625rem !important; /* 1.25rem * 1.25 = 1.5625rem */
    height: 1.5625rem !important;
  }
  
  /* Improve touch targets - 25% scale up */
  .icon-btn {
    padding: 0.625rem !important; /* 0.5rem * 1.25 = 0.625rem */
    border-radius: 0.9375rem !important; /* 0.75rem * 1.25 = 0.9375rem */
  }
  
  /* Better spacing between icons on mobile - 25% scale up */
  header .flex.items-center.gap-2 {
    gap: 0.625rem !important; /* 0.5rem * 1.25 = 0.625rem */
  }
}

/* Lock indicator styling */
.lock-indicator {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: transparent !important;
  border-radius: inherit !important;
  pointer-events: none !important;
  z-index: 1 !important;
  transition: all 0.2s ease !important;
}

/* Ensure locked elements maintain their appearance */
[disabled] {
  opacity: 1 !important;
  color: inherit !important;
  background: inherit !important;
  border: inherit !important;
}

/* Lock button styling */
#btnLock {
  transition: all 0.2s ease;
}

#btnLock:hover {
  transform: scale(1.05);
}

/* Auto-save indicator in header */
.autosave-status {
  font-size: .6rem;
  color: var(--muted);
  margin-top: .2rem;
}

.autosave-status.enabled {
  color: #6366f1;
}

.autosave-status.disabled {
  color: #f59e0b;
}

/* Expandable KPI Cards */
.kpi {
  cursor: pointer;
  position: relative;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.kpi-expanded {
  max-height: 0;
  overflow: hidden;
  background: var(--card);
  border-radius: 0 0 1rem 1rem;
  padding: 0 1rem;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid var(--stroke);
  border-top: none;
  backdrop-filter: blur(20px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.kpi.expanded {
  grid-column: 1 / -1;
  transform: translateY(0);
}

.kpi.expanded .kpi-expanded {
  max-height: none;
  padding: 0.75rem;
}

.kpi.expanded .analytics-content {
  max-height: none;
}

.analytics-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.75rem;
  padding-bottom: 0.375rem;
  border-bottom: 1px solid var(--stroke);
}

.analytics-title {
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--fg);
}

.analytics-close {
  width: 20px;
  height: 20px;
  border: none;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  font-size: 0.8rem;
}

.analytics-close:hover {
  background: var(--glass);
  color: var(--fg);
}

.analytics-content {
  max-height: 600px;
  overflow-y: auto;
  overflow-x: hidden;
}

.analytics-section {
  margin-bottom: 0.5rem;
}

.analytics-section:last-child {
  margin-bottom: 0;
}

.analytics-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.375rem;
  margin-bottom: 0.375rem;
}

.analytics-grid-3 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 0.375rem;
  margin-bottom: 0.375rem;
}

.analytics-grid-4 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.375rem;
  margin-bottom: 0.375rem;
}

/* Compact spacing and organization for analytics content */
.analytics-content {
  padding: 0.125rem;
}

.analytics-section {
  margin-bottom: 0.5rem;
  padding: 0.375rem;
  background: rgba(255, 255, 255, 0.02);
  border-radius: 0.375rem;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.section-title {
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--muted);
  margin-bottom: 0.375rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.metric-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
  gap: 0.375rem;
}

.metric-item {
  text-align: center;
  padding: 0.125rem;
}

.metric-value {
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--fg);
  line-height: 1.1;
}

.metric-label {
  font-size: 0.6rem;
  color: var(--muted);
  margin-top: 0.1rem;
}

/* Compact breakdown lists styling */
.breakdown-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.breakdown-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.125rem 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  font-size: 0.65rem;
}

.breakdown-item:last-child {
  border-bottom: none;
}

.breakdown-name {
  color: var(--fg);
  font-weight: 500;
}

.breakdown-amount {
  color: var(--fg);
  font-weight: 600;
  margin-right: 0.375rem;
}

.breakdown-percentage {
  color: var(--muted);
  font-size: 0.6rem;
}

/* Insight cards styling */
.insight-card {
  background: rgba(255, 255, 255, 0.03);
  border-radius: 0.375rem;
  padding: 0.5rem;
  border: 1px solid rgba(255, 255, 255, 0.08);
}

.insight-text {
  font-size: 0.7rem;
  line-height: 1.4;
  color: var(--fg);
}

.insight-line {
  margin-bottom: 0.25rem;
}

.insight-line:last-child {
  margin-bottom: 0;
}

.insight-line.tooltip-trigger {
  cursor: help;
  transition: opacity 0.2s ease;
}

.insight-line.tooltip-trigger:hover {
  opacity: 0.85;
}

/* Currency with USD display styles */
.currency-with-usd {
  display: inline-block;
  vertical-align: top;
  position: relative;
}

.usd-original {
  font-size: 0.5rem;
  color: rgba(255, 255, 255, 0.5);
  line-height: 1;
  margin-bottom: 0.1rem;
  font-weight: 400;
  position: absolute;
  top: -0.4rem;
  left: 0;
  white-space: nowrap;
}

.converted-amount {
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
  display: inline-block;
}

/* Editable Values */
.editable-value {
  cursor: pointer;
  padding: 0.35rem 0.5rem;
  border-radius: 6px;
  transition: all 0.2s ease;
  border: none;
  background: transparent;
  backdrop-filter: blur(10px);
  font-size: 0.75rem;
  line-height: 1.2rem;
  font-weight: 500;
  color: var(--fg);
}

.editable-value:hover {
  background: var(--glass);
  transform: translateY(-1px);
}

.editable-value.editing {
  background: var(--glass);
  transform: scale(1.01);
  cursor: text;
}

.editable-input {
  background: transparent;
  border: none;
  border-radius: 6px;
  outline: none;
  color: var(--fg);
  font-size: 0.75rem;
  font-weight: 500;
  width: 100%;
  text-align: center;
  padding: 0.35rem 0.5rem;
  transition: all 0.2s ease;
  min-height: auto;
  box-sizing: border-box;
  line-height: 1.2rem;
  backdrop-filter: blur(10px);
}

.editable-input:focus {
  background: var(--glass);
  transform: scale(1.01);
  outline: none;
}

.editable-value.editing {
  background: transparent;
  border: none;
  padding: 0;
}

.editable-value.editing .editable-input {
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
  box-shadow: none;
  outline: none;
}

/* Financial input wrapper for always-visible symbols */
.financial-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  background: transparent;
  border-radius: 6px;
  padding: 0.25rem 0.35rem;
  transition: all 0.2s ease;
  backdrop-filter: blur(10px);
  cursor: pointer;
}

.financial-input-wrapper:hover {
  background: var(--card);
  transform: translateY(-1px);
}

.financial-input-wrapper.editing {
  background: var(--card);
  transform: scale(1.01);
  cursor: text;
}

.financial-symbol {
  color: var(--muted);
  font-size: 0.75rem;
  font-weight: 500;
  margin-right: 0px;
  padding-right: 0px;
  pointer-events: none;
  flex-shrink: 0;
}

/* Ensure minimal spacing between currency symbols and values */
.cost-input-wrapper,
.financial-input-wrapper {
  gap: 0px !important;
}

.cost-input-wrapper .cost-input,
.financial-input-wrapper .financial-value {
  margin-left: 0px !important;
  padding-left: 0px !important;
}

.financial-value {
  color: var(--fg);
  font-size: 0.75rem;
  font-weight: 500;
  line-height: 1.2rem;
  flex: 1;
  text-align: left;
}

.financial-input-wrapper input {
  background: transparent !important;
  border: none !important;
  outline: none !important;
  font-size: 0.75rem !important;
  line-height: 1.2rem !important;
  font-weight: 500 !important;
  color: var(--fg) !important;
  width: 100% !important;
  padding: 0 !important;
  text-align: left !important;
}

/* Smaller text for Paid EGP column */
.paid-egp-cell {
  font-size: 0.65rem !important;
  line-height: 1.1rem !important;
  font-weight: 500 !important;
}

/* Hide Paid EGP background when locked */
.paid-egp-cell.editable-value.locked {
  background: transparent !important;
  border: none !important;
  padding: 0.25rem 0.5rem !important;
  margin: 0.1rem !important;
}

/* Hide date calendar icon when locked */
/* Date input styling is handled by the minimal date display */

.section-title {
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.375rem;
}

.metric-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.5rem;
}

.metric-item {
  background: var(--glass);
  border-radius: 0.375rem;
  padding: 0.375rem;
  text-align: center;
  border: 1px solid var(--stroke);
}

.metric-value {
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--fg);
  margin-bottom: 0.1rem;
}

.metric-label {
  font-size: 0.55rem;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.trend-indicator {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.7rem;
  font-weight: 500;
  padding: 0.25rem 0.5rem;
  border-radius: 0.375rem;
  margin-top: 0.25rem;
}

.trend-up {
  color: #6366f1;
  background: rgba(99, 102, 241, 0.1);
}

.trend-down {
  color: #ef4444;
  background: rgba(239, 68, 68, 0.1);
}

.trend-neutral {
  color: var(--muted);
  background: var(--glass);
}

.breakdown-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.breakdown-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.25rem 0;
  border-bottom: 1px solid var(--stroke);
}

.breakdown-item:last-child {
  border-bottom: none;
}

.breakdown-name {
  font-size: 0.65rem;
  color: var(--fg);
  font-weight: 500;
}

.breakdown-amount {
  font-size: 0.65rem;
  color: var(--muted);
  font-weight: 600;
}

.breakdown-percentage {
  font-size: 0.55rem;
  color: var(--muted);
  margin-left: 0.375rem;
}

.insight-card {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(56, 189, 248, 0.05));
  border: 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 0.375rem;
  padding: 0.375rem;
  margin-top: 0.25rem;
}

.insight-text {
  font-size: 0.6rem;
  color: var(--fg);
  line-height: 1.2;
}

.insight-icon {
  width: 10px;
  height: 10px;
  margin-right: 0.25rem;
  color: #6366f1;
}

.insight-line {
  margin-bottom: 0.5rem;
  line-height: 1.4;
  font-size: 0.85rem;
}

.insight-line:last-child {
  margin-bottom: 0;
}


@media (max-width:640px){
  /* Expenses and Income KPI cards - single column on mobile */
  #kpis, #incomeKpis{ 
    grid-template-columns:1fr !important; 
    gap:12px; 
  }
  
  /* KPI card content adjustments for mobile */
  .kpi .value{ 
    font-size:1.35rem; 
  }
  
  /* Better spacing for mobile KPI cards */
  .kpi{ 
    padding:0.875rem; 
    min-height: auto;
  }
  
  /* Adjust grid layouts within KPI cards for mobile */
  .kpi .grid.grid-cols-2{ 
    gap:0.75rem; 
  }
  
  .kpi .grid.grid-cols-2.gap-6{ 
    gap:0.75rem; 
  }
  
  /* Better text sizing for mobile */
  .kpi h3{ 
    font-size:0.65rem; 
  }
  
  .kpi .sub{ 
    font-size:0.7rem; 
  }
  
  /* Mobile-specific adjustments for KPI content */
  .kpi .text-\[11px\]{ 
    font-size:0.65rem; 
  }
  
  /* Button adjustments */
  .btn{ 
    padding:.45rem .7rem; 
  }
  
  /* Compact analytics content mobile responsiveness */
  .analytics-content {
    max-height: 500px;
    padding: 0.1rem;
  }
  
  .analytics-section {
    margin-bottom: 0.375rem;
    padding: 0.25rem;
  }
  
  .analytics-grid-4 {
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
  }
  
  .analytics-grid-3 {
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
  }
  
  .analytics-grid {
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }
  
  .metric-grid {
    grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
    gap: 0.25rem;
  }
}

/* Medium mobile breakpoint for tablets and larger phones */
@media (max-width:768px) and (min-width:641px){
  /* Two column layout for medium screens */
  #kpis, #incomeKpis{ 
    grid-template-columns:repeat(2, 1fr) !important; 
    gap:14px; 
  }
  
  /* Analytics page - 2 columns on medium screens */
  #analyticsKpis{ 
    grid-template-columns:repeat(2, 1fr) !important; 
  }
  
  /* Slightly larger text for medium screens */
  .kpi .value{ 
    font-size:1.4rem; 
  }
  
  .kpi{ 
    padding:0.9rem; 
  }
}

/* Additional mobile responsiveness for very small screens */
@media (max-width:480px){
  /* Even more compact KPI cards for very small screens */
  .kpi{ 
    padding:0.75rem; 
  }
  
  .kpi .value{ 
    font-size:1.25rem; 
  }
  
  /* Tighter spacing for very small screens */
  .kpi .grid.grid-cols-2{ 
    gap:0.5rem; 
  }
  
  .kpi .grid.grid-cols-2.gap-6{ 
    gap:0.5rem; 
  }
  
  /* Smaller text for very small screens */
  .kpi h3{ 
    font-size:0.6rem; 
  }
  
  .kpi .sub{ 
    font-size:0.65rem; 
  }
  
  .kpi .text-\[11px\]{ 
    font-size:0.6rem; 
  }
  
  /* Ensure no horizontal overflow */
  .kpi{ 
    overflow: hidden;
    word-wrap: break-word;
  }
  
  /* Better mobile layout for KPI sections */
  #kpis, #incomeKpis, #analyticsKpis{ 
    gap:10px; 
    padding:0 0.25rem;
  }
  
  /* Analytics page KPI cards - single column on very small screens */
  #analyticsKpis{ 
    grid-template-columns:1fr !important; 
  }
  
  /* Ultra-compact analytics content for very small screens */
  .analytics-content {
    max-height: 400px;
    padding: 0.05rem;
  }
  
  .analytics-section {
    margin-bottom: 0.25rem;
    padding: 0.2rem;
  }
  
  .analytics-grid-4,
  .analytics-grid-3,
  .analytics-grid {
    grid-template-columns: 1fr;
    gap: 0.375rem;
  }
  
  .metric-grid {
    grid-template-columns: 1fr 1fr;
    gap: 0.2rem;
  }
  
  .section-title {
    font-size: 0.65rem;
    margin-bottom: 0.25rem;
  }
  
  .metric-value {
    font-size: 0.8rem;
  }
  
  .metric-label {
    font-size: 0.55rem;
  }
}

/* Authentication Modal Styles */
.auth-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.auth-modal-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
}

/* General Modal Overlay */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.auth-modal-content {
  position: relative;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 16px;
  width: 90%;
  max-width: 420px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  animation: authModalSlideIn 0.3s ease-out;
}

@keyframes authModalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.auth-modal-header {
  padding: 24px 24px 16px;
  text-align: center;
  position: relative;
}

.auth-modal-brand {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 8px;
}

.auth-modal-logo {
  width: 2rem;
  height: 2rem;
  filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);
}

/* Dark mode logo color */
[data-theme="dark"] .auth-modal-logo {
  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg) brightness(103%) contrast(103%);
}

/* Settings Modal Logo */
.settings-modal-logo {
  width: 1.5rem;
  height: 1.5rem;
  filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);
}

/* Dark mode logo color for settings */
[data-theme="dark"] .settings-modal-logo {
  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg) brightness(103%) contrast(103%);
}

/* Icon Picker Modal Logo */
.icon-picker-modal-logo {
  width: 1.75rem;
  height: 1.75rem;
  filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);
}

/* Dark mode logo color for icon picker */
[data-theme="dark"] .icon-picker-modal-logo {
  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg) brightness(103%) contrast(103%);
}

.auth-modal-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--fg);
  margin: 0;
}

.auth-modal-subtitle {
  font-size: 0.875rem;
  color: var(--muted);
  margin: 0;
}

.auth-modal-close {
  position: absolute;
  top: 16px;
  right: 16px;
  background: none;
  border: none;
  color: var(--muted);
  cursor: pointer;
  padding: 8px;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.auth-modal-close:hover {
  background: var(--glass);
  color: var(--fg);
}

.auth-modal-body {
  padding: 0 24px 24px;
}

.auth-btn {
  width: 100%;
  padding: 12px 16px;
  border: none;
  border-radius: 12px;
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 16px;
}

.auth-btn-google {
  background: white;
  color: #1f2937;
  border: 1px solid #e5e7eb;
}

.auth-btn-google:hover {
  background: #f9fafb;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.auth-btn-icon {
  width: 20px;
  height: 20px;
}

.auth-divider {
  text-align: center;
  margin: 24px 0;
  position: relative;
}

.auth-divider::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--stroke);
}

.auth-divider span {
  background: var(--card);
  color: var(--muted);
  padding: 0 16px;
  font-size: 0.875rem;
}

.auth-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.auth-form.hidden {
  opacity: 0;
  transform: translateY(-10px);
  pointer-events: none;
}

.auth-form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.auth-form-header {
  text-align: center;
  margin-bottom: 1.5rem;
}

.auth-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--fg);
  margin: 0 0 0.5rem 0;
}

.auth-subtitle {
  font-size: 0.875rem;
  color: var(--muted);
  margin: 0;
  line-height: 1.4;
}

/* Profile Picture Upload Styles - Compact */
.profile-pic-upload {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.profile-pic-preview {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid var(--stroke);
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--glass);
  flex-shrink: 0;
}

.profile-pic-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.profile-pic-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  color: var(--muted);
}

.profile-pic-placeholder svg {
  width: 20px;
  height: 20px;
}

.profile-pic-upload-btn {
  padding: 0.375rem 0.75rem;
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.profile-pic-upload-btn:hover {
  background: var(--hover);
  border-color: var(--accent);
}

.profile-pic-input {
  display: none;
}

/* Editable Date Input for Account Panel */
#accountForm .auth-input[type="date"] {
  position: relative;
  cursor: text; /* Change to text cursor for typing */
  padding-right: 40px; /* Space for calendar icon */
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  color: var(--fg);
  font-size: 0.8rem;
  font-family: inherit;
}

/* Calendar icon for date input */
#accountForm .auth-input[type="date"]::-webkit-calendar-picker-indicator {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  color: var(--fg);
  cursor: pointer;
  padding: 6px;
  border-radius: 4px;
  transition: all 0.2s ease;
  width: 20px;
  height: 20px;
  opacity: 1;
  z-index: 1;
}

#accountForm .auth-input[type="date"]::-webkit-calendar-picker-indicator:hover {
  background: var(--hover);
}

/* Focus state for date input */
#accountForm .auth-input[type="date"]:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
  outline: none;
}

/* Make date input fully editable */
#accountForm .auth-input[type="date"] {
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
}

/* Placeholder styling for date input */
#accountForm .auth-input[type="date"]::placeholder {
  color: var(--muted);
  opacity: 0.7;
}

/* Mobile date input improvements */
@media (max-width: 480px) {
  #accountForm .auth-input[type="date"] {
    font-size: 16px; /* Prevents zoom on iOS */
  }
}

/* SUPER COMPACT Account Form Styles */
#accountForm .auth-form-group {
  margin-bottom: 0.5rem;
}

#accountForm .auth-form-group:last-of-type {
  margin-bottom: 0.75rem;
}

/* SUPER COMPACT Profile Picture Group */
#accountForm .auth-form-group:has(.profile-pic-upload) {
  margin-bottom: 0.5rem;
}

#accountForm .auth-form-group:has(.profile-pic-upload) .auth-label {
  margin-bottom: 0.25rem;
}

/* SUPER COMPACT form actions */
#accountForm .auth-form-actions {
  margin-top: 0.25rem;
  gap: 0.5rem;
}

/* SUPER COMPACT auth modal body for account form */
#accountForm .auth-modal-body {
  padding: 0 16px 16px;
}

/* SUPER COMPACT labels */
#accountForm .auth-label {
  font-size: 0.75rem;
  margin-bottom: 0.25rem;
  font-weight: 600;
}

/* SUPER COMPACT inputs */
#accountForm .auth-input {
  padding: 8px 12px;
  font-size: 0.75rem;
  min-height: 36px;
}

/* SUPER COMPACT buttons */
#accountForm .auth-btn {
  padding: 8px 14px;
  font-size: 0.75rem;
  min-height: 36px;
}

/* SUPER COMPACT profile picture */
#accountForm .profile-pic-preview {
  width: 40px;
  height: 40px;
}

#accountForm .profile-pic-placeholder svg {
  width: 16px;
  height: 16px;
}

#accountForm .profile-pic-upload-btn {
  padding: 6px 10px;
  font-size: 0.7rem;
}

#accountForm .profile-pic-upload {
  gap: 0.5rem;
}

.auth-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--fg);
}

.auth-input {
  padding: 12px 16px;
  border: 1px solid var(--stroke);
  border-radius: 12px;
  background: var(--glass);
  color: var(--fg);
  font-size: 0.875rem;
  transition: all 0.2s ease;
}

.auth-input:focus {
  outline: none;
  border-color: var(--muted);
  box-shadow: 0 0 0 3px rgba(var(--muted-rgb), 0.1);
}

/* Password Input Wrapper */
.password-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
}

.password-input-wrapper .auth-input,
.password-input-wrapper .onboarding-input {
  padding-right: 45px;
  width: 100%;
}

/* Password Toggle Button */
.password-toggle-btn {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--muted);
  transition: color 0.2s ease;
  z-index: 10;
  width: 32px;
  height: 32px;
  border-radius: 6px;
}

.password-toggle-btn:hover {
  color: var(--fg);
  background: rgba(var(--muted-rgb), 0.1);
}

.password-toggle-btn:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(var(--muted-rgb), 0.2);
}

.password-toggle-icon {
  width: 18px;
  height: 18px;
  stroke-width: 2;
  display: block;
  transition: opacity 0.2s ease;
}

/* Default: show eye icon, hide eye-off icon */
.password-toggle-icon-eye {
  display: block;
}

.password-toggle-icon-eye-off {
  display: none;
}

/* When active (password is visible): hide eye icon, show eye-off icon */
.password-toggle-btn.active .password-toggle-icon-eye {
  display: none !important;
}

.password-toggle-btn.active .password-toggle-icon-eye-off {
  display: block !important;
}

.auth-select {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid var(--stroke);
  border-radius: 8px;
  background: var(--card);
  color: var(--fg);
  font-size: 0.875rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
}

.auth-select:focus {
  outline: none;
  border-color: #6366f1;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

/* Auth Password Requirements */
.auth-password-requirements {
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.requirement.valid {
  color: #10b981;
}

.requirement.valid .requirement-icon {
  color: #10b981;
}

.auth-input::placeholder {
  color: var(--muted);
}

.auth-form-actions {
  display: flex;
  gap: 12px;
  margin-top: 8px;
}

.auth-btn-primary {
  flex: 1;
  background: var(--fg);
  color: var(--bg);
}

.auth-btn-primary:hover {
  background: var(--muted);
}

.auth-btn-secondary {
  flex: 1;
  background: transparent;
  color: var(--fg);
  border: 1px solid var(--stroke);
}

.auth-btn-secondary:hover {
  background: var(--glass);
}

.auth-status {
  padding: 12px 16px;
  border-radius: 12px;
  font-size: 0.875rem;
  text-align: center;
  margin-top: 16px;
}

.auth-status.success {
  background: rgba(34, 197, 94, 0.1);
  color: #16a34a;
  border: 1px solid rgba(34, 197, 94, 0.2);
}

.auth-status.error {
  background: rgba(239, 68, 68, 0.1);
  color: #dc2626;
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.auth-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 16px;
  color: var(--muted);
  font-size: 0.875rem;
}

.auth-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--stroke);
  border-top: 2px solid var(--fg);
  border-radius: 50%;
  animation: authSpinner 1s linear infinite;
}

@keyframes authSpinner {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.auth-modal-footer {
  padding: 16px 24px 24px;
  text-align: center;
}

.auth-footer-text {
  font-size: 0.75rem;
  color: var(--muted);
  margin: 0;
  line-height: 1.4;
}

.auth-forgot-password {
  text-align: center;
  margin-top: 16px;
}

.auth-forgot-link {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 0.875rem;
  text-decoration: underline;
  cursor: pointer;
  padding: 8px;
  transition: color 0.2s ease;
}

.auth-forgot-link:hover {
  color: var(--fg);
}

/* User Dropdown Styles */
#userDropdown {
  opacity: 0;
  transform: translateY(-10px);
  transition: opacity 0.2s ease, transform 0.2s ease;
  pointer-events: none;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

#userDropdown.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

#userMenuBtn:hover {
  background: rgba(255, 255, 255, 0.05);
}

/* Account Dropdown Styles */
#accountDropdown {
  opacity: 0;
  transform: translateY(-10px);
  transition: opacity 0.2s ease, transform 0.2s ease;
  pointer-events: none;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

#accountDropdown.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

#accountMenuBtn:hover {
  background: rgba(255, 255, 255, 0.05);
}

/* Mobile Responsiveness for Auth Modal */
@media (max-width: 640px) {
  .auth-modal-content {
    width: 95%;
    margin: 20px;
  }
  
  .auth-modal-header {
    padding: 20px 20px 12px;
  }
  
  .auth-modal-body {
    padding: 0 20px 20px;
  }
  
  .auth-modal-footer {
    padding: 12px 20px 20px;
  }
}

/* Settings Modal Centering */
.settings-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: 0;
  max-height: 90vh;
  overflow-y: auto;
  z-index: 1000;
  background: var(--bg);
  border: 1px solid var(--stroke);
  border-radius: 1rem;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(20px);
}

/* ===== ONBOARDING MODAL STYLES ===== */
.onboarding-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1001;
  display: flex;
  align-items: center;
  justify-content: center;
}

.onboarding-modal-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg);
  backdrop-filter: none;
}

.onboarding-modal-content {
  position: relative;
  background: transparent;
  border: none;
  border-radius: 0;
  width: 100%;
  height: 100%;
  max-width: none;
  max-height: none;
  overflow: visible;
  box-shadow: none;
  animation: onboardingSlideIn 0.4s ease-out;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 0;
  gap: 0;
}

@keyframes onboardingSlideIn {
  from {
    opacity: 0;
    transform: translateY(-30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.onboarding-modal-header {
  padding: 0;
  position: absolute;
  top: 1rem;
  right: 1rem;
  display: none;
  justify-content: flex-end;
  align-items: center;
  z-index: 10;
}

.onboarding-progress {
  display: none;
}

.onboarding-progress-bar {
  display: none;
}

.onboarding-progress-fill {
  display: none;
}

.onboarding-step-indicator {
  display: none;
}


.onboarding-skip-btn {
  background: rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: var(--muted);
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s ease;
  backdrop-filter: blur(10px);
}

.onboarding-skip-btn:hover {
  background: rgba(0, 0, 0, 0.2);
  color: var(--fg);
  border-color: rgba(255, 255, 255, 0.3);
}

/* Skip button for first step */
.onboarding-step-skip {
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--muted);
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin-top: 1rem;
  align-self: center;
}

.onboarding-step-skip:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--fg);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-1px);
}

/* Show progress for all steps except step 0 */
.onboarding-step:not(#onboardingStep0) .onboarding-modal-header .onboarding-progress {
  display: block;
  position: fixed;
  top: 1rem;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  z-index: 10;
}

.onboarding-step:not(#onboardingStep0) .onboarding-modal-header .onboarding-progress-bar {
  display: block;
  width: 100%;
  height: 2px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 1px;
  overflow: hidden;
  margin-bottom: 4px;
}

.onboarding-step:not(#onboardingStep0) .onboarding-modal-header .onboarding-progress-fill {
  display: block;
  height: 100%;
  background: linear-gradient(90deg, #6366f1, #38bdf8);
  border-radius: 1px;
  transition: width 0.3s ease;
}

.onboarding-step:not(#onboardingStep0) .onboarding-modal-header .onboarding-step-indicator {
  display: block;
  font-size: 0.625rem;
  color: var(--muted);
  font-weight: 500;
  text-align: center;
}

/* Skip button is now only the "Skip for now" button under the choices */

/* Show back button for all steps except step 0 */
.onboarding-step:not(#onboardingStep0) .onboarding-back-btn {
  display: flex !important;
}

.onboarding-step#onboardingStep0 .onboarding-back-btn {
  display: none !important;
}

/* Show back icon in Next button for step 1 */
.onboarding-step#onboardingStep1 .onboarding-back-icon {
  display: inline-block !important;
  margin-right: 8px;
}

.onboarding-modal-body {
  padding: 0;
  width: 100%;
  max-width: 400px;
}

.onboarding-step {
  text-align: center;
  width: 100%;
}

.onboarding-step-content {
  max-width: 100%;
  width: 100%;
}

.onboarding-icon {
  display: flex;
  justify-content: center;
  margin-bottom: 1rem;
  color: #6366f1;
}

.onboarding-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--fg);
  margin: 0 0 0.5rem 0;
  line-height: 1.2;
}

.onboarding-subtitle {
  font-size: 0.875rem;
  color: var(--muted);
  margin: 0 0 1.5rem 0;
  line-height: 1.4;
}

/* Onboarding Logo */
.onboarding-logo-container {
  display: flex;
  justify-content: center;
  margin-bottom: 16px;
}

.onboarding-logo {
  height: 48px;
  width: auto;
  max-width: 200px;
  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg) brightness(103%) contrast(103%);
}

/* Dark mode logo color */
[data-theme="dark"] .onboarding-logo {
  filter: brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg) brightness(103%) contrast(103%);
}

/* Light mode logo color */
[data-theme="light"] .onboarding-logo {
  filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);
}

/* Welcome Step Styles */
.onboarding-welcome-options {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-top: 1rem;
}

.welcome-option {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem;
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.welcome-option::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.08), transparent);
  transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.welcome-option:hover {
  border-color: rgba(99, 102, 241, 0.3);
  transform: translateY(-1px);
  box-shadow: 0 4px 20px rgba(99, 102, 241, 0.08);
  background: rgba(99, 102, 241, 0.02);
}

.welcome-option:hover .welcome-option-icon {
  background: rgba(99, 102, 241, 0.15);
  border-color: rgba(99, 102, 241, 0.3);
  transform: scale(1.05);
}

.welcome-option:hover .welcome-option-arrow {
  transform: translateX(2px);
  color: #6366f1;
}

.welcome-option:hover::before {
  left: 100%;
}

.welcome-option:active {
  transform: translateY(0);
  transition: all 0.1s ease;
}

.welcome-option-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  background: rgba(99, 102, 241, 0.1);
  border: 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 10px;
  color: #6366f1;
  flex-shrink: 0;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.welcome-option-content {
  flex: 1;
  min-width: 0;
}

.welcome-option-title {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--fg);
  margin: 0 0 2px 0;
  line-height: 1.3;
}

.welcome-option-description {
  font-size: 0.75rem;
  color: var(--muted);
  margin: 0;
  line-height: 1.4;
}

.welcome-option-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: transparent;
  border: none;
  border-radius: 6px;
  color: var(--muted);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  flex-shrink: 0;
}

.welcome-option:hover .welcome-option-arrow {
  background: rgba(99, 102, 241, 0.1);
  color: #6366f1;
  transform: translateX(2px);
}

/* Mobile responsiveness for welcome options */
@media (max-width: 640px) {
  .welcome-option {
    padding: 0.75rem;
    gap: 0.5rem;
  }
  
  .welcome-option-icon {
    width: 32px;
    height: 32px;
  }
  
  .welcome-option-title {
    font-size: 0.8rem;
  }
  
  .welcome-option-description {
    font-size: 0.7rem;
  }
  
  .welcome-option-arrow {
    width: 20px;
    height: 20px;
  }
}

.onboarding-form {
  text-align: left;
  max-width: 100%;
  width: 100%;
}

.onboarding-form-group {
  margin-bottom: 1rem;
}

.onboarding-label {
  display: block;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--fg);
  margin-bottom: 0.5rem;
}

.onboarding-input,
.onboarding-select {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--stroke);
  border-radius: 6px;
  background: var(--card);
  color: var(--fg);
  font-size: 0.875rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
}

.onboarding-input:focus,
.onboarding-select:focus {
  outline: none;
  border-color: #6366f1;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.onboarding-password-hint {
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 4px;
}

/* Password Strength Indicator */
.onboarding-password-strength {
  margin-top: 8px;
}

.password-strength-bar {
  width: 100%;
  height: 4px;
  background: var(--glass);
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 4px;
}

.password-strength-fill {
  height: 100%;
  border-radius: 2px;
  transition: all 0.3s ease;
  width: 0%;
}

.password-strength-fill.weak {
  background: #ef4444;
  width: 25%;
}

.password-strength-fill.fair {
  background: #f59e0b;
  width: 50%;
}

.password-strength-fill.good {
  background: #3b82f6;
  width: 75%;
}

.password-strength-fill.strong {
  background: #10b981;
  width: 100%;
}

.password-strength-text {
  font-size: 0.75rem;
  color: var(--muted);
  text-align: center;
}

.password-strength-text.weak {
  color: #ef4444;
}

.password-strength-text.fair {
  color: #f59e0b;
}

.password-strength-text.good {
  color: #3b82f6;
}

.password-strength-text.strong {
  color: #10b981;
}

/* Password Requirements */
.onboarding-password-requirements {
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.requirement {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.7rem;
  color: var(--muted);
}

.requirement-icon {
  font-size: 0.75rem;
  transition: all 0.2s ease;
  display: inline-block;
  width: 14px;
  height: 14px;
  text-align: center;
  line-height: 14px;
}

/* Removed pseudo-elements to prevent duplicate symbols - JavaScript handles symbols */

.requirement-text {
  font-size: 0.65rem;
}

/* Password Match Indicator */
.onboarding-password-match {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.7rem;
  color: var(--muted);
  margin-top: 6px;
}

.match-icon {
  font-size: 0.875rem;
  transition: all 0.2s ease;
  display: inline-block;
  width: 16px;
  height: 16px;
  text-align: center;
  line-height: 16px;
}

.match-icon::before {
  content: "○";
  color: var(--muted);
}

.password-match .match-icon::before {
  content: "✓";
  color: #10b981;
  font-weight: bold;
}

.password-mismatch .match-icon::before {
  content: "✗";
  color: #ef4444;
}

.match-text {
  font-size: 0.7rem;
}

/* Auth Password Match Styles */
.auth-password-match {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 8px;
}

.auth-password-match .match-icon {
  font-size: 0.875rem;
  transition: all 0.2s ease;
  display: inline-block;
  width: 16px;
  height: 16px;
  text-align: center;
  line-height: 16px;
}

.auth-password-match .match-icon::before {
  content: "○";
  color: var(--muted);
}

.auth-password-match.password-match .match-icon::before {
  content: "✓";
  color: #10b981;
  font-weight: bold;
}

.auth-password-match.password-mismatch .match-icon::before {
  content: "✗";
  color: #ef4444;
}

.auth-password-match .match-text {
  font-size: 0.75rem;
}

/* Email Verification Popup */
.email-verification-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-out;
}

.email-verification-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(8px);
}

.email-verification-content {
  position: relative;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 16px;
  padding: 20px;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  animation: slideUp 0.4s ease-out;
  text-align: center;
}

.email-verification-icon {
  display: flex;
  justify-content: center;
  margin-bottom: 12px;
  color: var(--accent);
}

.email-verification-icon svg {
  width: 32px;
  height: 32px;
  animation: bounce 2s infinite;
}

.email-verification-header {
  margin-bottom: 16px;
}

.email-verification-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--fg);
  margin: 0 0 4px 0;
}

.email-verification-subtitle {
  font-size: 0.8rem;
  color: var(--muted);
  margin: 0 0 8px 0;
}

.email-verification-email {
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  padding: 8px 12px;
  margin: 0 auto 12px auto;
  max-width: 280px;
}

.email-address {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--accent);
  word-break: break-all;
}

.email-verification-steps {
  margin-bottom: 16px;
  text-align: left;
}

.verification-step {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  padding: 8px 12px;
  background: var(--glass);
  border-radius: 8px;
  border: 1px solid var(--stroke);
  transition: all 0.2s ease;
}

.verification-step:hover {
  background: var(--hover);
}

.step-number {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  background: var(--accent);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.7rem;
}

.step-content h4 {
  margin: 0;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--fg);
}

.step-content p {
  margin: 0;
  font-size: 0.7rem;
  color: var(--muted);
  line-height: 1.2;
}

.email-verification-actions {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  flex-wrap: wrap;
  justify-content: center;
}

.verification-btn {
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 0.8rem;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 100px;
}

.verification-btn-primary {
  background: var(--accent);
  color: white;
}

.verification-btn-primary:hover {
  background: var(--accent-hover);
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(var(--accent-rgb), 0.3);
}

.verification-btn-secondary {
  background: var(--glass);
  color: var(--fg);
  border: 1px solid var(--stroke);
}

.verification-btn-secondary:hover {
  background: var(--hover);
  transform: translateY(-2px);
}

.email-verification-footer {
  border-top: 1px solid var(--stroke);
  padding-top: 8px;
}

.verification-footer-text {
  font-size: 0.7rem;
  color: var(--muted);
  margin: 0;
  line-height: 1.3;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

/* Mobile Responsive */
@media (max-width: 640px) {
  .email-verification-content {
    padding: 16px;
    margin: 12px;
    max-width: none;
    width: calc(100% - 24px);
  }
  
  .email-verification-actions {
    flex-direction: column;
    gap: 6px;
  }
  
  .verification-btn {
    width: 100%;
    min-width: auto;
    padding: 6px 12px;
    font-size: 0.75rem;
  }
  
  .verification-step {
    padding: 6px 8px;
    margin-bottom: 6px;
  }
  
  .step-number {
    width: 18px;
    height: 18px;
    font-size: 0.65rem;
  }
  
  .step-content h4 {
    font-size: 0.75rem;
  }
  
  .step-content p {
    font-size: 0.65rem;
  }
}

/* Loading States */
.onboarding-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px;
  background: var(--glass);
  border-radius: 8px;
  margin-top: 16px;
  font-size: 0.875rem;
  color: var(--muted);
}

.onboarding-loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid var(--stroke);
  border-top: 2px solid #6366f1;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Progress Steps */
.onboarding-progress-steps {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 16px;
  margin-top: 20px;
  padding: 20px;
  background: var(--glass);
  border-radius: 16px;
  border: 1px solid var(--stroke);
  position: relative;
}

.progress-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  position: relative;
  min-width: 50px;
}

.progress-step::before {
  content: '';
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--glass);
  border: 3px solid var(--stroke);
  transition: all 0.4s ease;
  position: relative;
  z-index: 2;
}

.progress-step .step-number {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--muted);
  transition: all 0.3s ease;
  position: relative;
  z-index: 3;
}

.progress-step.active::before {
  background: #6366f1;
  border-color: #6366f1;
  transform: scale(1.4);
  box-shadow: 0 0 0 6px rgba(99, 102, 241, 0.15);
}

.progress-step.active .step-number {
  color: #6366f1;
  font-weight: 700;
}

.progress-step.completed::before {
  background: #10b981;
  border-color: #10b981;
  transform: scale(1.2);
  box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.15);
}

.progress-step.completed .step-number {
  color: #10b981;
  font-weight: 600;
}

/* Progress step connector lines */
.onboarding-progress-steps::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: calc(100% - 40px);
  height: 3px;
  background: var(--stroke);
  z-index: 1;
  border-radius: 2px;
}

/* Individual step connector lines */
.progress-step:not(:last-child) {
  position: relative;
}

.progress-step:not(:last-child)::after {
  content: '';
  position: absolute;
  top: 8px;
  left: 20px;
  width: 32px;
  height: 3px;
  background: var(--stroke);
  z-index: 1;
  border-radius: 2px;
}

.progress-step.completed:not(:last-child)::after {
  background: #10b981;
}

.progress-step.active:not(:last-child)::after {
  background: linear-gradient(90deg, #10b981 50%, var(--stroke) 50%);
}

.onboarding-modal-footer {
  padding: 0;
  width: 100%;
  max-width: 400px;
  margin-top: 0.5rem;
}

.onboarding-actions {
  display: flex;
  gap: 0.75rem;
  justify-content: space-between;
  width: 100%;
}

.onboarding-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 10px 12px;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  justify-content: center;
  flex: 1;
  width: 100%;
}

.onboarding-btn-primary {
  background: linear-gradient(135deg, #6366f1, #38bdf8);
  color: white;
}

.onboarding-btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
}

.onboarding-btn-secondary {
  background: var(--glass);
  color: var(--fg);
  border: 1px solid var(--stroke);
}

.onboarding-btn-secondary:hover {
  background: var(--stroke);
}

/* Light mode adjustments for onboarding */
[data-theme="light"] .onboarding-modal-content {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .onboarding-input:focus,
[data-theme="light"] .onboarding-select:focus {
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.08);
}

/* Mobile responsiveness for onboarding */
@media (max-width: 640px) {
  .onboarding-modal-content {
    padding: 1rem;
  }
  
  .onboarding-modal-header {
    top: 0.75rem;
    right: 0.75rem;
  }
  
  .onboarding-modal-body {
    max-width: 100%;
  }
  
  .onboarding-modal-footer {
    max-width: 100%;
    margin-top: 0.25rem;
  }
  
  .onboarding-title {
    font-size: 1.25rem;
  }
  
  .onboarding-subtitle {
    font-size: 0.8rem;
  }
  
  .onboarding-actions {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .onboarding-btn {
    width: 100%;
  }
  
  .onboarding-step-skip {
    font-size: 0.7rem;
    padding: 6px 12px;
    margin-top: 0.75rem;
  }
}

/* Settings Modal Header Styles */
.settings-modal-content header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 1rem;
  padding: 1.5rem 1.5rem 1rem 1.5rem;
  border-bottom: 1px solid var(--stroke);
  background: transparent; /* Remove background to prevent sticky appearance */
  border-radius: 1rem 1rem 0 0;
  margin: -1.5rem -1.5rem 1rem -1.5rem;
  position: static; /* Ensure header is not sticky */
}

.settings-modal-content header h3 {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--fg);
  margin: 0;
  line-height: 1.2;
}

.settings-modal-content header p {
  font-size: 0.875rem;
  color: var(--muted);
  margin: 0.25rem 0 0 0;
  line-height: 1.4;
}

.settings-modal-content header button {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  font-weight: 500;
  background: var(--glass);
  border: 1px solid var(--stroke);
  color: var(--fg);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
  min-height: 40px;
}


/* Settings Modal Select Dropdown Styles */
.settings-modal-content .select {
  width: 100%;
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  font-weight: 500;
  background: var(--glass);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  color: var(--fg);
  cursor: pointer;
  transition: all 0.2s ease;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23a1a1aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
  background-repeat: no-repeat;
  background-position: right 0.75rem center;
  background-size: 1rem;
  padding-right: 2.5rem;
}

.settings-modal-content .select:hover {
  border-color: var(--muted);
  background-color: var(--card);
}

.settings-modal-content .select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.settings-modal-content .select option {
  background: var(--card);
  color: var(--fg);
  padding: 0.5rem;
}

/* Settings Modal Content Spacing */
.settings-modal-content {
  padding: 1.5rem;
  background: var(--bg);
  color: var(--fg);
}

/* Ensure all text in settings modal is white */
.settings-modal-content h3,
.settings-modal-content h4,
.settings-modal-content label,
.settings-modal-content p,
.settings-modal-content span,
.settings-modal-content input,
.settings-modal-content select,
.settings-modal-content option {
  color: var(--fg) !important;
}

.settings-modal-content .space-y-4 > * + * {
  margin-top: 1.5rem;
}

/* Compact form styling */
.settings-modal-content .grid {
  gap: 1.5rem;
}

.settings-modal-content label {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--fg);
  margin-bottom: 0.5rem;
  display: block;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Section headers */
.settings-modal-content h4 {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--fg);
  margin: 0 0 1rem 0;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Compact buttons */
.settings-modal-content button:not(.btn-ghost) {
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  font-weight: 500;
  border-radius: 8px;
  transition: all 0.2s ease;
  background: var(--glass);
  border: 1px solid var(--stroke);
  color: var(--fg);
}

/* No hover effects for settings modal buttons - all removed */

/* Compact input styling */
.settings-modal-content input {
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  border-radius: 8px;
  min-height: 44px;
  background: var(--glass);
  border: 1px solid var(--stroke);
  color: var(--fg);
}

.settings-modal-content input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

/* Settings Modal Button Improvements */
.settings-modal-content #btnDeleteAll {
  width: 100%;
  padding: 0.5rem 1rem;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.settings-modal-content #btnDeleteAll:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background: #6b7280 !important;
  border-color: #6b7280 !important;
}


/* Settings Modal Mobile Responsiveness */
@media (max-width: 768px) {
  .settings-modal {
    width: 95vw !important;
    max-width: 95vw !important;
    margin: 0 !important;
    max-height: 90vh !important;
    border-radius: 16px !important;
    /* Maintain centering on mobile */
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
  }
  
  .settings-modal-content {
    padding: 0.75rem !important;
    max-height: 90vh;
    overflow-y: auto;
  }
  
  .settings-modal-content header {
    flex-direction: row !important;
    align-items: flex-start !important;
    justify-content: space-between !important;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
    position: static !important; /* Remove sticky positioning */
    padding: 0.75rem 0.75rem 0.5rem 0.75rem;
    margin: -0.75rem -0.75rem 0.75rem -0.75rem;
    background: transparent !important; /* Remove background to make it non-sticky */
    border-bottom: 1px solid var(--stroke);
  }
  
  .settings-modal-content header h3 {
    font-size: 1.125rem;
    margin: 0;
  }
  
  .settings-modal-content header p {
    font-size: 0.7rem;
    margin: 0;
  }
  
  .settings-modal-content header button {
    position: static !important;
    padding: 0.4rem;
    min-width: 40px;
    min-height: 40px;
    border-radius: 6px;
    background: var(--glass);
    border: 1px solid var(--stroke);
    flex-shrink: 0;
    font-size: 0.75rem;
  }
  
  
  /* Single column layout on mobile */
  .settings-modal-content .grid {
    grid-template-columns: 1fr !important;
    gap: 0.75rem !important;
  }
  
  /* Mobile-friendly input styling - more compact */
  .settings-modal-content .settings-input-wrapper {
    min-height: 40px;
  }
  
  .settings-modal-content .settings-input-wrapper input {
    font-size: 16px; /* Prevents zoom on iOS */
    padding: 0.6rem 0.4rem 0.6rem 1.25rem;
  }
  
  .settings-modal-content .settings-symbol {
    left: 0.4rem;
    font-size: 0.8rem;
  }
  
  /* Mobile-friendly buttons - more compact */
  .settings-modal-content button {
    min-height: 40px;
    padding: 0.6rem 0.8rem;
    font-size: 0.8rem;
  }
  
  .settings-modal-content #btnRefreshFx {
    padding: 0.4rem !important;
    min-width: 40px;
    min-height: 40px;
  }
  
  /* Data management buttons */
  .settings-modal-content .flex.gap-2 {
    flex-direction: column;
    gap: 0.4rem;
  }
  
  .settings-modal-content .flex.gap-2 button {
    width: 100%;
    justify-content: center;
  }
  
  /* Danger zone styling - more compact */
  .settings-modal-content .space-y-2 {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }
  
  .settings-modal-content .space-y-2 input {
    font-size: 16px; /* Prevents zoom on iOS */
    min-height: 40px;
  }
  
  .settings-modal-content #btnDeleteAll {
    width: 100%;
    min-height: 40px;
    padding: 0.6rem 0.8rem;
    font-size: 0.75rem;
  }
  
  /* Section spacing - more compact */
  .settings-modal-content .border-t {
    margin-top: 1rem;
    padding-top: 0.75rem;
  }
  
  .settings-modal-content h4 {
    font-size: 0.9rem;
    margin-bottom: 0.6rem;
  }
  
  /* More compact labels and text */
  .settings-modal-content label {
    font-size: 0.7rem !important;
    margin-bottom: 0.4rem !important;
  }
  
  .settings-modal-content p {
    font-size: 0.7rem !important;
    margin: 0.2rem 0 !important;
  }
  
}

/* Extra small screens */
@media (max-width: 480px) {
  .settings-modal {
    width: 100vw !important;
    max-width: 100vw !important;
    height: 100vh !important;
    max-height: 100vh !important;
    border-radius: 0 !important;
    /* Maintain centering on extra small screens */
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
  }
  
  .settings-modal-content {
    padding: 0.5rem !important;
    height: 100vh;
    border-radius: 0;
  }
  
  .settings-modal-content header {
    padding: 0.5rem 0.5rem 0.4rem 0.5rem;
    margin: -0.5rem -0.5rem 0.5rem -0.5rem;
    border-bottom: 1px solid var(--stroke);
    position: static !important; /* Ensure header is not sticky */
    background: transparent !important;
  }
  
  .settings-modal-content header h3 {
    font-size: 1rem;
  }
  
  .settings-modal-content header p {
    font-size: 0.65rem;
  }
  
  .settings-modal-content header button {
    padding: 0.3rem;
    min-width: 36px;
    min-height: 36px;
    font-size: 0.7rem;
  }
  
  /* Compact form elements */
  .settings-modal-content .grid {
    gap: 0.75rem !important;
  }
  
  .settings-modal-content label {
    font-size: 0.75rem;
    margin-bottom: 0.25rem;
  }
  
  .settings-modal-content .text-sm {
    font-size: 0.75rem;
    line-height: 1.4;
  }
  
  .settings-modal-content .text-xs {
    font-size: 0.7rem;
  }
  
  /* Smaller buttons for very small screens */
  .settings-modal-content button {
    min-height: 40px;
    padding: 0.625rem 0.875rem;
    font-size: 0.8rem;
  }
  
  .settings-modal-content #btnRefreshFx {
    padding: 0.375rem !important;
    min-width: 40px;
    min-height: 40px;
  }
  
  /* Input styling for very small screens */
  .settings-modal-content .settings-input-wrapper input {
    padding: 0.625rem 0.375rem 0.625rem 1.25rem;
    font-size: 14px;
  }
  
  .settings-modal-content .settings-symbol {
    left: 0.375rem;
    font-size: 0.8rem;
  }
  
  /* Select styling */
  .settings-modal-content select {
    min-height: 40px;
    font-size: 14px;
    padding: 0.625rem 0.75rem;
  }
  
  
  .settings-modal-content input:focus,
  .settings-modal-content select:focus {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }
  
  /* Better visual hierarchy on small screens */
  .settings-modal-content .space-y-3 > * + * {
    margin-top: 0.75rem;
  }
  
  .settings-modal-content .space-y-4 > * + * {
    margin-top: 1rem;
  }
}

/* Ultra-small screens (320px and below) */
@media (max-width: 320px) {
  .settings-modal-content {
    padding: 0.5rem !important;
  }
  
  .settings-modal-content header h3 {
    font-size: 1rem;
  }
  
  .settings-modal-content header p {
    font-size: 0.65rem;
  }
  
  .settings-modal-content header button {
    top: 0.25rem;
    right: 0.25rem;
    padding: 0.375rem;
    min-width: 36px;
    min-height: 36px;
  }
  
  .settings-modal-content button {
    min-height: 36px;
    padding: 0.5rem 0.75rem;
    font-size: 0.75rem;
  }
  
  .settings-modal-content .settings-input-wrapper input {
    padding: 0.5rem 0.25rem 0.5rem 1rem;
    font-size: 13px;
  }
  
  .settings-modal-content .settings-symbol {
    left: 0.25rem;
    font-size: 0.75rem;
  }
  
  .settings-modal-content select {
    min-height: 36px;
    font-size: 13px;
    padding: 0.5rem 0.625rem;
  }
}

/* Mobile Year Selection Improvements */
@media (max-width: 768px) {
  .year-tab {
    padding: 0.2rem 0.5rem;
    font-size: 0.7rem;
    min-width: 44px;
    text-align: center;
  }
  
  /* Year selection container */
  .year-selection-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  
  .year-selection-container::-webkit-scrollbar {
    display: none;
  }
  
  .year-tabs-container {
    display: flex;
    gap: 0.25rem;
    padding: 0.5rem 0;
    min-width: max-content;
  }
}

@media (max-width: 480px) {
  .year-tab {
    padding: 0.15rem 0.4rem;
    font-size: 0.65rem;
    min-width: 40px;
  }
  
  .year-tabs-container {
    gap: 0.2rem;
    padding: 0.4rem 0;
  }
}

/* Currency Dropdown Styles */
#currencyDropdown {
  animation: fadeIn 0.2s ease-out;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(10px);
}

.currency-option {
  border-radius: 0.5rem;
  transition: all 0.2s ease;
}

.currency-option:hover {
  background: var(--glass) !important;
  transform: translateX(2px);
}

.currency-option:active {
  transform: translateX(0);
}

.currency-option.active {
  background: rgba(99, 102, 241, 0.1) !important;
  color: #6366f1 !important;
  font-weight: 600 !important;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Income Visualization Styles */
#incomeHeatmapContainer,
#incomeTimelineContainer {
  position: relative;
  width: 100%;
  overflow: hidden;
}

#incomeHeatmap,
#incomeTimeline {
  width: 100% !important;
  height: auto !important;
  max-width: 100%;
}

#heatmapTooltip,
#timelineTooltip {
  position: absolute;
  background: var(--bg);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  padding: 8px 12px;
  font-size: 12px;
  color: var(--fg);
  pointer-events: none;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(8px);
  white-space: nowrap;
}

/* Responsive adjustments for visualizations */
@media (max-width: 768px) {
  #incomeHeatmap,
  #incomeTimeline {
    height: 200px !important;
  }
  
  #heatmapTooltip,
  #timelineTooltip {
    font-size: 11px;
    padding: 6px 10px;
  }
}

/* Canvas hover effects */
#incomeHeatmap:hover,
#incomeTimeline:hover {
  cursor: crosshair;
}

/* Chart.js customization for dark theme */
.chartjs-render-monitor {
  border-radius: 8px;
}

/* Income Flow Chart Styles */
#incomeFlowChart {
  width: 100% !important;
  height: 300px !important;
  max-height: 400px;
}

#chartLoading {
  transition: opacity 0.3s ease;
}

#chartLoading.hidden {
  opacity: 0;
  pointer-events: none;
}

/* Enhanced Tooltip System with Perfect Delays */
.tooltip-trigger {
  position: relative;
  cursor: default;
  transition: all 0.2s ease;
}

.tooltip-trigger:hover {
  transform: translateY(-1px);
}

.tooltip {
  position: fixed;
  background: rgba(10, 10, 11, 0.95);
  border: 1px solid rgba(39, 39, 42, 0.8);
  border-radius: 8px;
  padding: 10px 14px;
  font-size: 0.7rem;
  font-weight: 500;
  color: rgba(228, 228, 231, 0.95);
  white-space: normal;
  word-wrap: break-word;
  word-break: break-word;
  overflow-wrap: break-word;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  z-index: 999999;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  max-width: 220px;
  min-width: 140px;
  text-align: center;
  line-height: 1.4;
  pointer-events: none;
  transform: translate(-50%, -100%) scale(0.95);
  display: none;
  box-sizing: border-box;
}

/* Tooltip show animation */
.tooltip.show {
  opacity: 1;
  visibility: visible;
  display: block;
  transform: translate(0, -50%) scale(1);
}

/* Centered tooltip variant (appears/disappears from center) */
.tooltip.tooltip-center {
  transform: translate(-50%, -50%) scale(0.92);
}
.tooltip.tooltip-center.show {
  transform: translate(-50%, -50%) scale(1);
}

/* Tooltip arrow with modern design (default - right side, for non-insight tooltips) */
.tooltip::before {
  content: '';
  position: absolute;
  top: 50%;
  right: -6px;
  width: 0;
  height: 0;
  border-left: 6px solid rgba(39, 39, 42, 0.8);
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  transform: translateY(-50%);
}

/* Hide default arrow for above/below tooltips (insights) */
.tooltip.tooltip-above::before,
.tooltip.tooltip-below::before {
  display: block;
}

.tooltip.tooltip-left::before {
  right: auto;
  left: -6px;
  border-left: none;
  border-right: 6px solid rgba(39, 39, 42, 0.8);
}

/* Tooltip positioning variants */
.tooltip.tooltip-right {
  transform: translate(0, -50%) scale(0.95);
}

.tooltip.tooltip-left {
  transform: translate(-100%, -50%) scale(0.95);
}

.tooltip.tooltip-above {
  transform: translate(-50%, -100%) scale(0.95);
}

.tooltip.tooltip-below {
  transform: translate(-50%, 0%) scale(0.95);
}

.tooltip.tooltip-below.show {
  transform: translate(-50%, 0%) scale(1);
}

/* Arrow adjustment for above tooltips (points down to the line) */
.tooltip.tooltip-above::before {
  top: 100%;
  bottom: auto;
  left: 50%;
  right: auto;
  margin-left: -6px;
  border-top: 6px solid rgba(39, 39, 42, 0.8);
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: none;
  transform: translateY(0);
}

/* Arrow adjustment for below tooltips (points up to the line) */
.tooltip.tooltip-below::before {
  top: auto;
  bottom: 100%;
  left: 50%;
  right: auto;
  margin-left: -6px;
  border-top: none;
  border-bottom: 6px solid rgba(39, 39, 42, 0.8);
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  transform: translateY(0);
}

.tooltip.tooltip-above.show {
  transform: translate(-50%, -100%) scale(1);
}

/* Ensure tooltips are never clipped */
.kpi, .card, .page-content, .grid, .section {
  overflow: visible !important;
}

/* Force tooltips to appear above everything */
.tooltip {
  position: fixed !important;
  z-index: 999999 !important;
  pointer-events: none !important;
  left: 0 !important;
  top: 0 !important;
}

/* Chart container responsive adjustments */
@media (max-width: 768px) {
  #incomeFlowChart {
    height: 250px !important;
  }
  
  /* Smaller chart dots on mobile */
  #incomeFlowChart canvas {
    --chart-point-radius: 3px;
    --chart-point-hover-radius: 5px;
  }
}

@media (max-width: 480px) {
  #incomeFlowChart {
    height: 200px !important;
  }
  
  /* Even smaller dots on small mobile */
  #incomeFlowChart canvas {
    --chart-point-radius: 2px;
    --chart-point-hover-radius: 4px;
  }
}

/* Chart View Toggle Button */
#chartViewToggle {
  transition: all 0.2s ease;
  cursor: pointer;
}

#chartViewToggle:hover {
  background: var(--accent) !important;
  color: white !important;
  border-color: var(--accent) !important;
  transform: translateY(-1px);
}

#chartViewToggle.active {
  background: var(--accent) !important;
  color: white !important;
  border-color: var(--accent) !important;
}

/* Chart toggle tooltip */
#chartViewToggle + .tooltip {
  position: relative;
  display: inline-block;
}

/* ===== SPLASH SCREEN STYLES ===== */
.splash-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: var(--bg);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999;
  opacity: 1;
  visibility: visible;
  transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
              visibility 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* Prevent scroll while splash visible (mobile blink fix) */
body.no-scroll { overflow: hidden; height: 100vh; }

/* Hide all content until splash screen is gone */
body.splash-active {
  overflow: hidden;
  height: 100vh;
}

body.splash-active #mainContent,
body.splash-active header,
body.splash-active .mobile-bottom-nav {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

/* Show content after splash is gone */
body.splash-complete #mainContent,
body.splash-complete header,
body.splash-complete .mobile-bottom-nav {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition: opacity 0.5s ease, visibility 0.5s ease;
}

/* Extra safety on small screens to prevent blink during keyboard/resize */
@media (max-width: 768px) {
  html, body { 
    overscroll-behavior: none; 
    /* Allow horizontal scroll for tables while maintaining proper viewport handling */
    max-width: 100vw;
    width: 100%;
    /* Ensure proper mobile viewport handling */
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  /* Ensure mobile bottom nav is always visible and properly positioned */
  .mobile-bottom-nav {
    /* Force it to stay within viewport bounds */
    position: fixed !important;
    bottom: env(safe-area-inset-bottom, 0) !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
    transform: translateZ(0); /* Force hardware acceleration */
    /* Ensure it respects device safe areas */
    padding-left: env(safe-area-inset-left, 0);
    padding-right: env(safe-area-inset-right, 0);
    padding-bottom: max(12px, env(safe-area-inset-bottom, 12px));
  }
  
  .splash-screen { 
    will-change: opacity, transform;
    /* Ensure splash screen covers full viewport on mobile */
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    /* Prevent mobile browser UI from affecting layout */
    min-height: 100vh !important;
    min-height: -webkit-fill-available !important;
  }
  
  /* Ensure splash content is properly centered on mobile */
  .splash-content {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    justify-content: center;
    padding: 1rem;
  }
}

.splash-screen.hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}

.splash-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3rem;
  text-align: center;
}

.splash-logo-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.splash-logo {
  width: 180px;
  height: auto;
  filter: drop-shadow(0 0 30px rgba(99, 102, 241, 0.4));
  animation: logoFloat 3s ease-in-out infinite;
}

.splash-logo-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 240px;
  height: 240px;
  background: radial-gradient(circle, rgba(99, 102, 241, 0.2) 0%, transparent 70%);
  border-radius: 50%;
  animation: logoGlow 2s ease-in-out infinite alternate;
}

@keyframes logoGlow {
  0% {
    opacity: 0.4;
    transform: translate(-50%, -50%) scale(0.9);
  }
  100% {
    opacity: 0.8;
    transform: translate(-50%, -50%) scale(1.3);
  }
}

/* Light mode: invert splash logo to show dark on white */
[data-theme="light"] .splash-logo { filter: invert(1) drop-shadow(0 0 30px rgba(99, 102, 241, 0.3)) !important; }
[data-theme="dark"] .splash-logo { filter: invert(0) drop-shadow(0 0 30px rgba(99, 102, 241, 0.4)) !important; }


@keyframes logoFloat {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-8px);
  }
}


.splash-progress-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  min-width: 300px;
}

.splash-progress-bar {
  width: 100%;
  height: 4px;
  background: var(--stroke);
  border-radius: 2px;
  overflow: hidden;
  position: relative;
}

.splash-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, 
    rgba(99, 102, 241, 0.8) 0%, 
    rgba(56, 189, 248, 0.8) 50%, 
    rgba(99, 102, 241, 0.8) 100%);
  border-radius: 2px;
  width: 0%;
  transition: width 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position: relative;
  overflow: hidden;
}

.splash-progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(255, 255, 255, 0.4) 50%, 
    transparent 100%);
  animation: progressShimmer 2s ease-in-out infinite;
}

@keyframes progressShimmer {
  0% {
    left: -100%;
  }
  100% {
    left: 100%;
  }
}

.splash-progress-text {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--muted);
  opacity: 0.8;
  animation: textPulse 2s ease-in-out infinite;
}

@keyframes textPulse {
  0%, 100% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
}

/* Light mode splash screen adjustments */
[data-theme="light"] .splash-screen {
  background: var(--bg);
}

[data-theme="light"] .splash-logo-glow {
  background: radial-gradient(circle, rgba(99, 102, 241, 0.15) 0%, transparent 70%);
}

[data-theme="light"] .splash-progress-bar {
  background: var(--stroke);
}

[data-theme="light"] .splash-progress-fill {
  background: linear-gradient(90deg, 
    rgba(99, 102, 241, 0.6) 0%, 
    rgba(56, 189, 248, 0.6) 50%, 
    rgba(99, 102, 241, 0.6) 100%);
}

/* Tablet and large mobile adjustments */
@media (max-width: 768px) {
  .splash-logo {
    width: 170px;
  }
  
  .splash-logo-glow {
    width: 240px;
    height: 240px;
  }
  
  .splash-progress-container {
    min-width: 320px;
    max-width: 90vw;
  }
  
  .splash-content {
    gap: 2.5rem;
    /* Ensure proper spacing on mobile */
    padding: 2rem 1rem;
  }
  
  /* Mobile-specific splash screen improvements */
  .splash-screen {
    /* Prevent mobile browser address bar from affecting layout */
    height: 100vh;
    height: -webkit-fill-available;
    /* Ensure it stays on top of everything */
    z-index: 99999;
  }
  
  /* Make progress bar more touch-friendly */
  .splash-progress-bar {
    height: 6px;
  }
  
  /* Adjust loading text for mobile */
  .splash-loading-text {
    font-size: 0.9rem;
  }
}

/* Mobile responsive adjustments */
@media (max-width: 600px) {
  .splash-logo {
    width: 160px;
  }
  
  .splash-logo-glow {
    width: 220px;
    height: 220px;
  }
  
  .splash-progress-container {
    min-width: 300px;
  }
  
  .splash-content {
    gap: 2.5rem;
  }
}

@media (max-width: 480px) {
  .splash-logo {
    width: 140px;
  }
  
  .splash-logo-glow {
    width: 200px;
    height: 200px;
  }
  
  .splash-progress-container {
    min-width: 280px;
  }
  
  .splash-content {
    gap: 2rem;
  }
  
  .splash-progress-text {
    font-size: 0.8rem;
  }
}

/* Extra small screens (very small phones) */
@media (max-width: 360px) {
  .splash-logo {
    width: 120px;
  }
  
  .splash-logo-glow {
    width: 170px;
    height: 170px;
  }
  
  .splash-progress-container {
    min-width: 250px;
  }
  
  .splash-content {
    gap: 1.5rem;
  }
}

/* ===== INCOME HEATMAP STYLES ===== */

/* Heatmap Year Custom Dropdown */
.heatmap-year-dropdown {
  position: relative;
  display: inline-block;
  min-width: 80px;
  max-width: 120px;
}

.heatmap-year-button {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0.25rem 0.5rem;
  background: transparent;
  border: none;
  border-radius: 6px;
  color: var(--fg);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  gap: 0.25rem;
}

.heatmap-year-button:hover {
  background: var(--card);
  transform: translateY(-1px);
}

.heatmap-year-button.active {
  background: var(--card);
}

.heatmap-year-button:focus {
  outline: none;
  background: var(--card);
}

.heatmap-year-arrow {
  width: 12px;
  height: 12px;
  color: var(--muted);
  transition: transform 0.2s ease;
  flex-shrink: 0;
}

.heatmap-year-button.active .heatmap-year-arrow {
  transform: rotate(180deg);
  color: var(--fg);
}

.heatmap-year-menu {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-8px);
  transition: all 0.2s ease;
  max-height: 200px;
  overflow-y: auto;
  min-width: 100%;
}

.heatmap-year-menu.show {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.heatmap-year-item {
  padding: 0.6rem 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--fg);
  border-bottom: 1px solid var(--stroke);
}

.heatmap-year-item:last-child {
  border-bottom: none;
}

.heatmap-year-item:hover {
  background: var(--glass);
  color: var(--fg);
}

.heatmap-year-item.active {
  background: rgba(99, 102, 241, 0.1);
  color: var(--accent);
  font-weight: 600;
}

/* Light mode adjustments */
[data-theme="light"] .heatmap-year-menu {
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .heatmap-year-item:hover {
  background: rgba(0, 0, 0, 0.03);
}

[data-theme="light"] .heatmap-year-item.active {
  background: rgba(99, 102, 241, 0.12);
}

/* Mobile adjustments */
@media (max-width: 768px) {
  .heatmap-year-dropdown {
    min-width: 70px;
    max-width: 90px;
  }
  
  .heatmap-year-button {
    padding: 0.2rem 0.4rem;
    font-size: 0.7rem;
  }
  
  .heatmap-year-arrow {
    width: 10px;
    height: 10px;
  }
  
  .heatmap-year-item {
    padding: 0.75rem 0.65rem;
    font-size: 0.7rem;
    min-height: 40px;
    display: flex;
    align-items: center;
  }
  
  .heatmap-year-menu {
    max-height: 180px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
  }
}

/* Heatmap Container */
.heatmap-container {
  overflow: visible;
  padding: 0;
  margin: 3rem 0;
  display:flex;
  justify-content:center;
  width: 100%;
}

/* New grouped months layout */
.heatmap-months{
  display:grid;
  grid-template-columns:repeat(6, 1fr);
  gap:8px;
  justify-content:stretch;
  align-content:start;
  width:100%;
  justify-items: center;
  padding: 0;
  margin: 0;
}

.heatmap-month{ 
  display:flex; 
  flex-direction:column; 
  gap:6px; 
  background:transparent; 
  padding:10px; 
  border-radius:10px; 
  border:1px solid transparent;
  align-items: center;
  justify-content: center;
}

.heatmap-month-title{ text-align:center; font-size:.72rem; color:var(--muted); font-weight:600; }

.heatmap-month-days{ display:grid; grid-template-columns:repeat(7, 14px); grid-auto-rows:14px; gap:3px; justify-content:center; }

/* Heatmap legend removed in UI */

.heatmap-legend-item:hover {
  transform: scale(1.1);
}

/* Heatmap Day Cells */
.heatmap-day {
  width: 14px;
  height: 14px;
  border-radius: 2px;
  background: var(--glass);
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.heatmap-day.heatmap-today {
  border: 1px solid rgba(161, 161, 170, 0.4);
  box-sizing: border-box;
}

.heatmap-day:hover {
  transform: scale(1.2);
  z-index: 10;
}

/* Day number display - hidden by default with fade animation */
.heatmap-day-number {
  opacity: 0;
  font-size: 7px;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.95);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.5);
  line-height: 1;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  pointer-events: none;
  user-select: none;
  z-index: 1;
  transition: opacity 0.2s ease-in-out;
}

/* Show day numbers when hovering over a month with fade in */
.heatmap-day.show-day-number .heatmap-day-number {
  opacity: 1;
}

/* Hide day numbers on blank/invisible days */
.heatmap-day[style*="visibility: hidden"] .heatmap-day-number {
  display: none !important;
}

/* Heatmap Day Intensity Levels */
.heatmap-day[data-intensity="0"] { background: rgba(161, 161, 170, 0.18); }

/* Highlight gap days when hovering over Longest Gap text */
.heatmap-day.highlight-gap-day {
  background: rgba(239, 68, 68, 0.25) !important;
  border: 1px solid rgba(239, 68, 68, 0.4) !important;
  box-shadow: 0 0 4px rgba(239, 68, 68, 0.3) !important;
  transition: all 0.2s ease;
}

[data-theme="light"] .heatmap-day.highlight-gap-day {
  background: rgba(239, 68, 68, 0.2) !important;
  border: 1px solid rgba(239, 68, 68, 0.35) !important;
  box-shadow: 0 0 3px rgba(239, 68, 68, 0.25) !important;
}

.heatmap-day[data-intensity="1"] { background: #E0E7FF; }
.heatmap-day[data-intensity="2"] { background: #C7D2FE; }
.heatmap-day[data-intensity="3"] { background: #A5B4FC; }
.heatmap-day[data-intensity="4"] { background: #818CF8; }
.heatmap-day[data-intensity="5"] { background: #6366F1; }

/* Light mode specific tweaks to ensure contrast on white backgrounds */
[data-theme="light"] .heatmap-day[data-intensity="0"] { background: #E5E7EB; }

/* Dark mode solid palette for better contrast */
[data-theme="dark"] .heatmap-day[data-intensity="1"] { background: #312E81; }
[data-theme="dark"] .heatmap-day[data-intensity="2"] { background: #3730A3; }
[data-theme="dark"] .heatmap-day[data-intensity="3"] { background: #4338CA; }
[data-theme="dark"] .heatmap-day[data-intensity="4"] { background: #4F46E5; }
[data-theme="dark"] .heatmap-day[data-intensity="5"] { background: #6366F1; }

/* Heatmap Tooltip */
.heatmap-tooltip {
  position: absolute;
  background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.98));
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  padding: 8px 10px;
  font-size: 0.75rem;
  color: #fff;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05);
  z-index: 1000;
  pointer-events: none;
  white-space: normal;
  opacity: 0;
  transform: translateY(-5px);
  transition: all 0.2s ease;
  color: #fff;
}
/* Use accent color for project list inside tooltip */
.heatmap-tooltip .heatmap-tip-projects-compact { 
  color: rgba(139, 92, 246, 0.9) !important; 
}
/* Tight legend and stats spacing */
.heatmap-legend{ display:flex; align-items:center; justify-content:center; gap:.5rem; margin:-6px 0 8px 0; }
.heatmap-legend > span{ line-height:1; }
.heatmap-legend-items{ gap:4px !important; }

.heatmap-stats{ margin-top:8px; row-gap:6px; column-gap:24px; }

/* Make Longest Gap stat container interactive */
.heatmap-stats > div:has(#heatmapLongestGap) {
  cursor: pointer;
  transition: background 0.2s ease;
  border-radius: 4px;
  padding: 4px 8px;
  margin: -4px -8px;
}

.heatmap-stats > div:has(#heatmapLongestGap):hover {
  background: var(--glass);
}


.heatmap-tooltip.show {
  opacity: 1;
  transform: translateY(0);
}

.heatmap-tooltip::after {
  display: none;
}

/* Super compact tooltip layout */
.heatmap-tip {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 180px;
  max-width: 240px;
}

.heatmap-tip-row-compact {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  line-height: 1.3;
}

.heatmap-tip-row-secondary {
  margin-top: 2px;
  padding-top: 4px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  align-items: flex-start;
}

.heatmap-tip-date-compact {
  font-weight: 600;
  font-size: 0.75rem;
  color: #fff;
  white-space: nowrap;
}

.heatmap-tip-amount-compact {
  font-size: 0.75rem;
  font-weight: 600;
  text-align: left;
  width: 100%;
  display: flex;
  align-items: baseline;
  gap: 4px;
  flex-wrap: wrap;
}

.heatmap-amount-primary {
  font-size: 0.8rem;
  color: #fff;
  font-weight: 700;
}

.heatmap-amount-divider {
  font-size: 0.65rem;
  color: rgba(255, 255, 255, 0.4);
  font-weight: 400;
}

.heatmap-amount-secondary {
  font-size: 0.7rem;
  color: rgba(255, 255, 255, 0.65);
  font-weight: 500;
}

.heatmap-tip-label-compact {
  font-size: 0.65rem;
  color: rgba(255, 255, 255, 0.5);
  font-weight: 500;
  white-space: nowrap;
  flex-shrink: 0;
}

.heatmap-tip-projects-compact {
  font-size: 0.7rem;
  color: rgba(139, 92, 246, 0.95);
  line-height: 1.3;
  word-wrap: break-word;
  text-align: right;
  flex: 1;
}

.heatmap-tags-container-compact {
  display: inline-flex;
  flex-wrap: wrap;
  gap: 3px;
  flex: 1;
  justify-content: flex-end;
}

.heatmap-tip .tag-chip {
  font-size: 0.55rem !important;
  padding: 1px 5px !important;
  border-radius: 8px !important;
  line-height: 1.2 !important;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.25), rgba(56, 189, 248, 0.2)) !important;
  border: 1px solid rgba(99, 102, 241, 0.4) !important;
  color: rgba(255, 255, 255, 0.9) !important;
  font-weight: 500 !important;
}

/* Heatmap Month Labels */
.heatmap-month-label {
  font-size: 0.7rem;
  color: var(--muted);
  text-align: center;
  margin-bottom: 0.25rem;
  font-weight: 500;
}

/* Heatmap Weekday Labels */
.heatmap-weekday-labels {
  display: grid;
  grid-template-rows: repeat(7, 1fr);
  gap: 2px;
  margin-right: 0.5rem;
  min-width: 20px;
}

.heatmap-weekday-label {
  font-size: 0.7rem;
  color: var(--muted);
  text-align: right;
  padding-right: 0.25rem;
  height: 12px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

/* Heatmap Calendar Grid */
.heatmap-calendar-grid {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 0.5rem;
  align-items: start;
}

/* Heatmap Header Responsive Styles */
@media (max-width: 768px) {
  .heatmap-header {
    gap: 1rem !important;
  }
  
  .heatmap-controls {
    width: 100%;
    justify-content: space-between;
    flex-wrap: wrap;
  }
  
  .heatmap-total {
    order: 1;
    flex: 1 1 auto;
    min-width: fit-content;
  }
  
  .heatmap-total #heatmapYearTotalUSD {
    font-size: 0.7rem !important;
  }
  
  .heatmap-total #heatmapYearTotalCurrency {
    font-size: 0.65rem !important;
    padding: 1px 4px !important;
  }
}

@media (max-width: 640px) {
  .heatmap-header {
    gap: 0.75rem !important;
  }
  
  .heatmap-header h2 {
    font-size: 1rem !important;
  }
  
  .heatmap-controls {
    gap: 0.75rem !important;
    flex-wrap: wrap;
  }
  
  .heatmap-total {
    width: 100%;
    justify-content: space-between;
    order: 1;
  }
  
  /* Year selector and controls on same row */
  .heatmap-controls > div:not(.heatmap-total),
  .heatmap-controls > button {
    order: 2;
  }
  
  /* Ensure year controls stay together on mobile */
  .heatmap-year-controls {
    order: 2;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: nowrap;
  }
  
  #heatmapRefreshBtn {
    flex-shrink: 0;
  }
}

@media (max-width: 480px) {
  .heatmap-header {
    gap: 0.5rem !important;
  }
  
  .heatmap-header h2 {
    font-size: 0.9rem !important;
  }
  
  #heatmapGrowth {
    font-size: 0.65rem !important;
  }
  
  .heatmap-controls {
    gap: 0.5rem !important;
  }
  
  .heatmap-total {
    padding: 0.5rem 0.75rem !important;
    gap: 0.5rem !important;
  }
  
  .heatmap-total span:first-child {
    font-size: 0.65rem !important;
  }
  
  .heatmap-total #heatmapYearTotalUSD {
    font-size: 0.65rem !important;
  }
  
  .heatmap-total #heatmapYearTotalCurrency {
    font-size: 0.6rem !important;
    padding: 1px 3px !important;
  }
  
  /* Make year selector more compact */
  .heatmap-controls .select-wrap {
    min-width: 70px !important;
    max-width: 90px !important;
  }
  
  .heatmap-controls label {
    font-size: 0.65rem !important;
  }
  
  /* Hide currency indicator on very small screens if needed */
  .heatmap-controls > div:last-child {
    font-size: 0.65rem !important;
  }
  
  /* Keep year controls together on mobile */
  .heatmap-year-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: nowrap;
  }
  
  #heatmapRefreshBtn {
    flex-shrink: 0;
  }
}

/* Tablet Portrait (vertical) - 3 rows (4 columns) */
@media (max-width: 1200px) and (orientation: portrait) {
  .heatmap-months{ 
    grid-template-columns:repeat(4, 1fr);
    justify-items: center;
  }
}

/* Tablet Landscape (wide) - 2 rows (6 columns) for iPad Air/Pro */
@media (min-width: 769px) and (max-width: 1400px) and (orientation: landscape) {
  .heatmap-months{ 
    grid-template-columns:repeat(6, 1fr);
    justify-items: center;
  }
}

/* Tablet Table Layout - Income Table Responsive Design */
@media (min-width: 769px) and (max-width: 1024px) {
  /* Tablet-specific table container with horizontal scroll */
  .table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    scroll-behavior: smooth;
    touch-action: pan-x;
    scrollbar-width: thin;
    scrollbar-color: var(--muted) var(--glass);
    width: 100% !important;
    max-width: 100% !important;
    position: relative !important;
    /* Add subtle shadow to indicate scrollable content */
    box-shadow: inset -15px 0 15px -15px rgba(0,0,0,0.1);
  }
  
  /* Scroll indicator removed - no gradient overlay */
  
  /* Tablet income table rows - ensure they don't overflow */
  .table-container .row-head.row-income,
  .table-container .row-income {
    min-width: 1200px; /* Ensure table has minimum width for all columns */
    max-width: none; /* Allow horizontal expansion */
    font-size: 0.8rem;
  }
  
  /* Tablet income table grid layout */
  .table-container .row-head.row-income {
    grid-template-columns: 25px 35px 200px 150px 130px 130px 130px 150px 200px 120px 90px 35px;
    text-align: center;
    align-items: center;
    padding: 0.5rem 0.4rem;
    gap: 0.4rem;
  }
  
  .table-container .row-income {
    grid-template-columns: 25px 35px 200px 150px 130px 130px 130px 150px 200px 120px 90px 35px;
    gap: 0.4rem;
    padding: 0.5rem 0.4rem;
    min-height: 45px;
    white-space: nowrap;
  }
  
  /* Tablet income table input styling */
  .table-container .row-income input {
    font-size: 0.8rem !important;
    min-height: 36px !important;
    padding: 0.6rem 0.8rem !important;
    line-height: 1.4 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  /* Tablet income table cells */
  .table-container .row-income > * {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    min-width: 0 !important;
  }
  
  /* Tablet date input styling */
  .table-container .row-income input[type="date"] {
    font-size: 0.75rem !important;
    min-height: 36px !important;
    padding: 0.5rem 0.7rem !important;
    line-height: 1.3 !important;
    color: var(--fg) !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    width: 100% !important;
    min-width: 0 !important;
    text-align: left !important;
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
  }
  
  /* Tablet financial input wrappers */
  .table-container .row-income .cost-input-wrapper,
  .table-container .row-income .financial-input-wrapper {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  .table-container .row-income .cost-input,
  .table-container .row-income .financial-value {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
  }
  
  /* Tablet financial input elements */
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    width: 100% !important;
    font-size: 0.75rem !important;
    padding: 0.5rem 0.7rem !important;
  }
  
  .table-container .row-income .cost-dollar-display,
  .table-container .row-income .financial-symbol {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: unset !important;
    min-width: 0 !important;
    flex-shrink: 0 !important;
    margin-right: 0px !important;
    padding-right: 0px !important;
  }
  
  /* Tablet header alignment */
  .table-container .row-head.row-income > div:nth-child(3) { text-align: left; } /* Project Name */
  .table-container .row-head.row-income > div:nth-child(4) { text-align: left; } /* Tags */
  .table-container .row-head.row-income > div:nth-child(5) { text-align: center; } /* Date */
  .table-container .row-head.row-income > div:nth-child(6) { text-align: center; } /* All Payment */
  .table-container .row-head.row-income > div:nth-child(7) { text-align: center; } /* Paid USD */
  .table-container .row-head.row-income > div:nth-child(8) { text-align: center; } /* Paid EGP */
  .table-container .row-head.row-income > div:nth-child(9) { text-align: left; } /* Method */
  .table-container .row-head.row-income > div:nth-child(10) { text-align: center; } /* Progress */
  .table-container .row-head.row-income > div:nth-child(11) { text-align: left; } /* Payment */
  
  /* Tablet delete button styling */
  .table-container .row-income .delete-btn {
    width: 28px !important;
    height: 28px !important;
    padding: 0.25rem !important;
    border-radius: 4px !important;
    background: var(--danger) !important;
    color: white !important;
    border: none !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    transition: all 0.2s ease !important;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 12px !important;
    height: 12px !important;
  }
  
  .table-container .row-income .delete-btn:hover {
    background: var(--danger-hover) !important;
    transform: scale(1.05) !important;
  }
}

/* Tablet Landscape Orientation - Additional Optimizations */
@media (min-width: 769px) and (max-width: 1024px) and (orientation: landscape) {
  /* Optimize table for landscape tablet view */
  .table-container .row-head.row-income,
  .table-container .row-income {
    min-width: 1400px; /* Slightly wider for landscape */
    font-size: 0.85rem;
  }
  
  /* Adjust grid columns for landscape */
  .table-container .row-head.row-income {
    grid-template-columns: 30px 40px 220px 160px 140px 140px 140px 160px 220px 140px 100px 40px;
    padding: 0.6rem 0.5rem;
    gap: 0.5rem;
  }
  
  .table-container .row-income {
    grid-template-columns: 30px 40px 220px 160px 140px 140px 140px 160px 220px 140px 100px 40px;
    gap: 0.5rem;
    padding: 0.6rem 0.5rem;
    min-height: 50px;
  }
  
  /* Larger inputs for landscape */
  .table-container .row-income input {
    font-size: 0.85rem !important;
    min-height: 40px !important;
    padding: 0.7rem 0.9rem !important;
  }
  
  .table-container .row-income input[type="date"] {
    font-size: 0.8rem !important;
    min-height: 40px !important;
    padding: 0.6rem 0.8rem !important;
  }
  
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    font-size: 0.8rem !important;
    padding: 0.6rem 0.8rem !important;
  }
  
  /* Larger delete button for landscape */
  .table-container .row-income .delete-btn {
    width: 32px !important;
    height: 32px !important;
    padding: 0.3rem !important;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 14px !important;
    height: 14px !important;
  }
}

/* Tablet Portrait Orientation - Additional Optimizations */
@media (min-width: 769px) and (max-width: 1024px) and (orientation: portrait) {
  /* Optimize table for portrait tablet view */
  .table-container .row-head.row-income,
  .table-container .row-income {
    min-width: 1100px; /* Slightly narrower for portrait */
    font-size: 0.75rem;
  }
  
  /* Adjust grid columns for portrait */
  .table-container .row-head.row-income {
    grid-template-columns: 20px 30px 180px 140px 120px 120px 120px 140px 180px 100px 80px 30px;
    padding: 0.4rem 0.3rem;
    gap: 0.3rem;
  }
  
  .table-container .row-income {
    grid-template-columns: 20px 30px 180px 140px 120px 120px 120px 140px 180px 100px 80px 30px;
    gap: 0.3rem;
    padding: 0.4rem 0.3rem;
    min-height: 42px;
  }
  
  /* Smaller inputs for portrait */
  .table-container .row-income input {
    font-size: 0.75rem !important;
    min-height: 34px !important;
    padding: 0.5rem 0.7rem !important;
  }
  
  .table-container .row-income input[type="date"] {
    font-size: 0.7rem !important;
    min-height: 34px !important;
    padding: 0.4rem 0.6rem !important;
  }
  
  .table-container .row-income .cost-input-wrapper input,
  .table-container .row-income .financial-input-wrapper input {
    font-size: 0.7rem !important;
    padding: 0.4rem 0.6rem !important;
  }
  
  /* Smaller delete button for portrait */
  .table-container .row-income .delete-btn {
    width: 26px !important;
    height: 26px !important;
    padding: 0.2rem !important;
  }
  
  .table-container .row-income .delete-btn svg {
    width: 11px !important;
    height: 11px !important;
  }
}

/* Tablets and small devices */
@media (max-width: 768px) {
  .heatmap-months{ 
    grid-template-columns:repeat(3, 1fr);
    justify-items: center;
    gap: 6px;
  }
  
  .heatmap-day {
    width: 12px;
    height: 12px;
  }
  
  .heatmap-container {
    margin: 0;
    padding: 0.5rem 1rem;
    width: 100%;
    box-sizing: border-box;
  }
  
  .heatmap-legend-item { width: 7px !important; height: 7px !important; }
  
  .heatmap-tooltip {
    font-size: 0.7rem;
    padding: 0.375rem;
  }

  /* Mobile heatmap stats layout */
  .heatmap-stats {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
    margin-top: 12px;
  }
  
  .heatmap-stats > div {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 8px;
    background: var(--card);
    border-radius: 8px;
    border: 1px solid var(--stroke);
  }
  
  .heatmap-stats .label {
    font-size: 0.7rem;
    color: var(--muted);
    margin-bottom: 4px;
  }
  
  .heatmap-stats .value {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--fg);
  }

  /* Tiny refresh button hit area in mobile header */
  #heatmapRefreshBtn { padding: 0; }
}

@media (max-width: 480px) {
  .heatmap-months{ 
    grid-template-columns:repeat(2, 1fr);
    justify-items: center;
    gap: 6px;
  }
  
  .heatmap-day {
    width: 11px;
    height: 11px;
  }
  
  .heatmap-weekday-label {
    font-size: 0.6rem;
  }
  
  .heatmap-month-label {
    font-size: 0.6rem;
  }
  
  .heatmap-container {
    margin: 0;
    padding: 0.5rem 1rem;
    width: 100%;
    box-sizing: border-box;
  }
  
  /* Small mobile heatmap stats */
  .heatmap-stats {
    gap: 8px;
    margin-top: 8px;
  }
  
  .heatmap-stats > div {
    padding: 6px;
  }
  
  .heatmap-stats .label {
    font-size: 0.65rem;
  }
  
  .heatmap-stats .value {
    font-size: 0.8rem;
  }
}

/* ===== EMAIL VERIFICATION STEP STYLES ===== */
.onboarding-verification-info {
  max-width: 500px;
  margin: 0 auto;
}

.verification-steps {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.verification-step {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 1rem;
  border-radius: 0.75rem;
  background: var(--glass);
  border: 1px solid var(--stroke);
}

.verification-step-icon {
  flex-shrink: 0;
  width: 2.5rem;
  height: 2.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.5rem;
  background: var(--accent);
  color: var(--bg);
}

.verification-step-content h4 {
  font-size: 0.875rem;
  font-weight: 600;
  margin: 0 0 0.25rem 0;
  color: var(--fg);
}

.verification-step-content p {
  font-size: 0.75rem;
  margin: 0;
  color: var(--muted);
}

.verification-note {
  padding: 1rem;
  border-radius: 0.75rem;
  background: rgba(99, 102, 241, 0.1);
  border: 1px solid rgba(99, 102, 241, 0.2);
}

.verification-note p {
  font-size: 0.875rem;
  font-weight: 600;
  margin: 0 0 0.75rem 0;
  color: var(--fg);
}

.verification-note ul {
  margin: 0;
  padding-left: 1.25rem;
  list-style: none;
}

.verification-note li {
  font-size: 0.75rem;
  color: var(--muted);
  margin-bottom: 0.25rem;
  position: relative;
}

.verification-note li::before {
  content: "•";
  color: var(--accent);
  font-weight: bold;
  position: absolute;
  left: -1rem;
}

/* ===== LIFETIME TOTAL HIGHLIGHTING ===== */
/* Subtle highlighting for the Lifetime Total section */
#shareIncomeCompletedValCurrency {
  transition: all 0.2s ease;
  animation: subtlePulse 3s ease-in-out infinite;
}

@keyframes subtlePulse {
  0%, 100% { 
    opacity: 0.8; 
    transform: scale(1); 
  }
  50% { 
    opacity: 1; 
    transform: scale(1.02); 
  }
}

/* Enhanced hover effect for the entire Lifetime Total row */
.kpi[data-analytics="income-all"] .mt-2 .flex:hover {
  background: var(--accent-bg);
  border-radius: 6px;
  padding: 4px 8px;
  margin: -4px -8px;
  transition: all 0.2s ease;
}

/* Subtle glow effect for the currency badge */
#shareIncomeCompletedValCurrency:hover {
  box-shadow: 0 0 8px rgba(99, 102, 241, 0.3);
  transform: scale(1.05);
}

/* ===== INCOME FLOW CHART RESPONSIVE SPACING ===== */
/* Mobile-first responsive spacing for Income Flow Chart header */
@media (max-width: 640px) {
  .flex.flex-col.sm\\:flex-row.sm\\:justify-between.sm\\:items-center.gap-3 {
    gap: 1rem !important;
  }
  
  .flex.flex-col.sm\\:flex-row.sm\\:items-center.gap-3 {
    gap: 0.75rem !important;
  }
  
  /* Ensure proper spacing between total display and buttons on mobile */
  .flex.items-center.gap-3 {
    margin-top: 0.5rem;
  }
}

/* Tablet and desktop spacing */
@media (min-width: 641px) {
  .flex.flex-col.sm\\:flex-row.sm\\:justify-between.sm\\:items-center.gap-3 {
    gap: 1.5rem;
  }
}
